function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var c=0;c<e.length;c++){var i=e[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,c){return e&&_defineProperties(t.prototype,e),c&&_defineProperties(t,c),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"3uMe":function(t,e,c){"use strict";c.d(e,"a",(function(){return s})),c("AJX/");var i=c("YFeJ"),n=c("tk/3"),a=c("fXoL"),s=function(){var t=function(){function t(e){_classCallCheck(this,t),this._httpClient=e,this.httpOptions={headers:new n.e({"Content-Type":"application/json",Authorization:"null"})},this.url=i.a.url}return _createClass(t,[{key:"add",value:function(t,e){var c=JSON.stringify(e);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.post(this.url+"team/add",c,this.httpOptions)}},{key:"edit",value:function(t,e,c){var i=JSON.stringify(c);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"team/update/"+e,i,this.httpOptions)}},{key:"addUser",value:function(t,e,c){var i={user:c};return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"team/add-user/"+e,i,this.httpOptions)}},{key:"removeUser",value:function(t,e,c){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"team/remove-user/"+e,{user:c},this.httpOptions)}},{key:"delete",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.delete(this.url+"team/delete/"+e,this.httpOptions)}},{key:"getForName",value:function(t,e,c){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"team/for-name/"+e+"/"+c,this.httpOptions)}},{key:"getList",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"team/teams/"+e,this.httpOptions)}},{key:"getTeamsOfUser",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"team/for-user/"+e,this.httpOptions)}},{key:"getAgentsList",value:function(t,e,c){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"team/agents/"+e+"/"+c,this.httpOptions)}},{key:"getOne",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"team/team/"+e,this.httpOptions)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a.fc(n.c))},t.\u0275prov=a.Rb({token:t,factory:t.\u0275fac}),t}()},"99bU":function(t,e,c){"use strict";c.r(e);var i=c("ofXK"),n=c("tyNb"),a=c("3Pt+"),s=c("qFsG"),r=c("NFeN"),o=c("bTqV"),u=c("Wp6s"),l=c("f0Cb"),d=c("zkoq"),p=c("kmnG"),f=c("0IaG"),h=c("Qu3c"),b=c("PCNd"),m=c("3kSh"),g=c("3sEA"),k=c("wd/R"),v=c("gU78"),y=c("BlIn"),x=c("YFeJ"),_=c("1yaQ"),C=c("FKr1"),T=c("fXoL"),w=c("dNgK"),M=c("XiUz"),S=c("d3UM");function I(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",11),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc().set(i,"requester")})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i.name+" "+i.surname),T.Gb(1),T.Yc("",i.name," ",i.surname,"")}}function G(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",11),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc().set(i,"agent")})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i.name+" "+i.surname),T.Gb(1),T.Yc("",i.name," ",i.surname,"")}}var O,E=((O=function(){function t(e,c,i,n){_classCallCheck(this,t),this.data=e,this.dialogRef=c,this._userService=i,this.snackBar=n,this.token=i.getToken(),this.identity=i.getIdentity(),this.filter={}}return _createClass(t,[{key:"ngOnInit",value:function(){this.getRequesters(),this.getAgents()}},{key:"set",value:function(t,e){switch(e){case"requester":this.filter.requester=t._id;break;case"agent":this.filter.agent=t._id;break;case"status":this.filter.status=t}}},{key:"deleteFilter",value:function(t){switch(t){case"requester":this.filter.requester=null;break;case"agent":this.filter.agent=null;break;case"status":this.filter.status=null;break;case"sub":this.filter.sub="";break;case"numTicket":this.filter.numTicket=null}}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"getRequesters",value:function(){var t=this;this._userService.getList(this.token).subscribe((function(e){e.users&&("ROLE_REQUESTER"!=t.identity.role?(t.allRequesters=e.users,t.requesters=e.users):t.identity.sector&&(t.allRequesters=e.users.filter((function(e){return e.sector==t.identity.sector._id})),t.requesters=t.allRequesters))}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getAgents",value:function(){var t,e=this;t=this.identity.company?this.identity.company._id:"null",this._userService.getListAgents(this.token,t).subscribe((function(t){t.users&&(e.allAgents=t.users,e.agents=t.users)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"sendQuery",value:function(){""==this.filter.sub&&(this.filter.sub=null),this.dialogRef.close(this.filter)}}]),t}()).\u0275fac=function(t){return new(t||O)(T.Vb(f.a),T.Vb(f.g),T.Vb(v.a),T.Vb(w.a))},O.\u0275cmp=T.Pb({type:O,selectors:[["app-filter"]],features:[T.Fb([{provide:C.c,useClass:_.c,deps:[C.g]},{provide:C.f,useValue:_.a},v.a])],decls:42,vars:8,consts:[["matDialogTitle",""],[1,"p-0"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","50",1,"pr-1"],["appearance","fill",1,"full-width"],["matInput","","type","number","name","numTicket",3,"ngModel","ngModelChange"],["matInput","","type","text","name","sub",3,"ngModel","ngModelChange"],[3,"disabled"],[3,"click"],[3,"value","click",4,"ngFor","ngForOf"],["fxFlex","100",1,"pr-1"],[3,"value","click"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(T.bc(0,"h1",0),T.Vc(1),T.ac(),T.bc(2,"mat-card",1),T.bc(3,"mat-card-content"),T.bc(4,"form"),T.bc(5,"div",2),T.bc(6,"div",3),T.bc(7,"mat-form-field",4),T.bc(8,"mat-label"),T.Vc(9,"N\xfamero"),T.ac(),T.bc(10,"input",5),T.jc("ngModelChange",(function(t){return e.filter.numTicket=t})),T.ac(),T.ac(),T.ac(),T.bc(11,"div",3),T.bc(12,"mat-form-field",4),T.bc(13,"mat-label"),T.Vc(14,"Asunto"),T.ac(),T.bc(15,"input",6),T.jc("ngModelChange",(function(t){return e.filter.sub=t})),T.ac(),T.ac(),T.ac(),T.bc(16,"div",3),T.bc(17,"mat-form-field",4),T.bc(18,"mat-label"),T.Vc(19,"Solicitante"),T.ac(),T.bc(20,"mat-select",7),T.bc(21,"mat-option",8),T.jc("click",(function(t){return e.deleteFilter("requester")})),T.ac(),T.Tc(22,I,2,3,"mat-option",9),T.ac(),T.ac(),T.ac(),T.bc(23,"div",3),T.bc(24,"mat-form-field",4),T.bc(25,"mat-label"),T.Vc(26,"Agente"),T.ac(),T.bc(27,"mat-select"),T.bc(28,"mat-option",8),T.jc("click",(function(t){return e.deleteFilter("agent")})),T.ac(),T.Tc(29,G,2,3,"mat-option",9),T.ac(),T.ac(),T.ac(),T.bc(30,"div",10),T.bc(31,"mat-form-field",4),T.bc(32,"mat-label"),T.Vc(33,"Estado"),T.ac(),T.bc(34,"mat-select"),T.bc(35,"mat-option",8),T.jc("click",(function(t){return e.deleteFilter("status")})),T.ac(),T.bc(36,"mat-option",11),T.jc("click",(function(t){return e.set("Pendiente","status")})),T.Vc(37,"Pendiente"),T.ac(),T.bc(38,"mat-option",11),T.jc("click",(function(t){return e.set("Finalizado","status")})),T.Vc(39,"Finalizado"),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(40,"button",12),T.jc("click",(function(t){return e.sendQuery()})),T.Vc(41,"Filtrar"),T.ac(),T.ac(),T.ac()),2&t&&(T.Gb(1),T.Wc(e.data.title),T.Gb(9),T.uc("ngModel",e.filter.numTicket),T.Gb(5),T.uc("ngModel",e.filter.sub),T.Gb(5),T.uc("disabled","ROLE_REQUESTER"==e.identity.role&&!e.data.sectorTickets||!e.identity.sector),T.Gb(2),T.uc("ngForOf",e.requesters),T.Gb(7),T.uc("ngForOf",e.agents),T.Gb(7),T.uc("value","Pendiente"),T.Gb(2),T.uc("value","Finalizado"))},directives:[f.h,u.a,u.c,a.x,a.o,a.p,M.d,M.b,p.a,p.d,s.b,a.s,a.c,a.n,a.q,S.a,C.p,i.l,o.b],encapsulation:2}),O);function V(t,e){if(1&t){var c=T.cc();T.bc(0,"button",32),T.jc("click",(function(t){return T.Mc(c),T.nc().unify()})),T.Vc(1,"Unificar"),T.ac()}}function j(t,e){if(1&t&&T.Wb(0,"img",44),2&t){var c=T.nc().$implicit,i=T.nc();T.vc("src",i.url+"user/image/"+c.requester.image,T.Oc)}}function q(t,e){1&t&&T.Wb(0,"img",45)}function P(t,e){if(1&t&&T.Wb(0,"img",44),2&t){var c=T.nc(2).$implicit,i=T.nc();T.vc("src",i.url+"user/image/"+c.agent.image,T.Oc)}}function F(t,e){1&t&&T.Wb(0,"img",45)}function R(t,e){if(1&t&&(T.bc(0,"td",46),T.Tc(1,P,1,1,"img",36),T.Tc(2,F,1,0,"img",37),T.Vc(3),T.Wb(4,"span"),T.Vc(5),T.ac()),2&t){var c=T.nc().$implicit;T.Gb(1),T.uc("ngIf","null"!=c.agent.image),T.Gb(1),T.uc("ngIf","null"==c.agent.image),T.Gb(1),T.Xc(" ",c.agent.name," "),T.Gb(2),T.Xc(" ",c.agent.surname," ")}}function W(t,e){1&t&&T.Wb(0,"td",46)}function L(t,e){if(1&t){var c=T.cc();T.bc(0,"tbody"),T.bc(1,"tr",33),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc().selectTicket(t,i)})),T.bc(2,"td",34),T.Vc(3),T.ac(),T.bc(4,"td",35),T.Tc(5,j,1,1,"img",36),T.Tc(6,q,1,0,"img",37),T.Vc(7),T.Wb(8,"span"),T.Vc(9),T.ac(),T.bc(10,"td",38),T.bc(11,"p",39),T.Vc(12),T.ac(),T.ac(),T.Tc(13,R,6,4,"td",40),T.Tc(14,W,1,0,"td",40),T.bc(15,"td",41),T.Vc(16),T.ac(),T.bc(17,"td",42),T.Vc(18),T.ac(),T.bc(19,"td",43),T.Vc(20),T.ac(),T.ac(),T.ac()}if(2&t){var i=e.$implicit,n=T.nc();T.Ib("Cerrado"==i.status?"closed":""),T.Gb(1),T.Ib(n.isInGroup(i)&&"ROLE_REQUESTER"!=n.identity.role?"selected":"select"),T.Gb(2),T.Wc(i.numTicket),T.Gb(2),T.uc("ngIf",i.requester&&"null"!=i.requester.image),T.Gb(1),T.uc("ngIf",!i.requester||"null"==i.requester.image),T.Gb(1),T.Xc(" ",i.requester.name," "),T.Gb(2),T.Xc(" ",i.requester.surname," "),T.Gb(2),T.vc("title",i.sub),T.Gb(1),T.Wc(i.sub),T.Gb(1),T.uc("ngIf",i.agent),T.Gb(1),T.uc("ngIf",!i.agent),T.Gb(2),T.Wc(i.status),T.Gb(2),T.Wc(n.changeDate(i.createDate)),T.Gb(2),T.Wc(n.changeDate(i.lastActivity))}}var A=function(t){return["/ticket/list",1,t]};function B(t,e){if(1&t&&(T.bc(0,"a",47),T.bc(1,"span"),T.Vc(2,"\xab"),T.ac(),T.ac()),2&t){var c=T.nc();T.uc("routerLink",T.Ac(2,A,c.limit))("queryParams",c.query)}}var D=function(t,e){return["/ticket/list",t,e]};function z(t,e){if(1&t&&(T.bc(0,"a",47),T.Vc(1),T.ac()),2&t){var c=T.nc();T.uc("routerLink",T.Bc(3,D,c.prevPage,c.limit))("queryParams",c.query),T.Gb(1),T.Wc(c.prevPage)}}function Y(t,e){if(1&t&&(T.bc(0,"a",47),T.Vc(1),T.ac()),2&t){var c=T.nc();T.uc("routerLink",T.Bc(3,D,c.nextPage,c.limit))("queryParams",c.query),T.Gb(1),T.Wc(c.nextPage)}}function N(t,e){if(1&t&&(T.bc(0,"a",47),T.bc(1,"span"),T.Vc(2,"\xbb"),T.ac(),T.ac()),2&t){var c=T.nc();T.uc("routerLink",T.Bc(2,D,c.totalPages,c.limit))("queryParams",c.query)}}var U,H,Q=((U=function(){function t(e,c,i,n,a,s,r,o){_classCallCheck(this,t),this.dialog=e,this._route=c,this._router=i,this.confirmService=n,this.loader=a,this.snackBar=s,this._userService=r,this._ticketService=o,this.isSectorTickets=!1,this.token=r.getToken(),this.identity=r.getIdentity(),this.url=x.a.url,this.groupTicket=new Array}return _createClass(t,[{key:"ngOnInit",value:function(){this.setQuery(),this.getTickets()}},{key:"setQuery",value:function(){this.query={}}},{key:"getTickets",value:function(){var t=this;this._route.params.forEach((function(e){t._route.queryParams.forEach((function(c){var i;t.loader.open("Cargando tickets"),c.isSectorTickets?(t.query=c,t.getSectorTickets()):(t.query=c,t.page=e.page,t.limit=e.limit,"ROLE_REQUESTER"==t.identity.role&&(i=t.identity._id),t._ticketService.getList(t.token,t.page,t.limit,c,t.identity.company&&null!=t.identity.company?t.identity.company._id:null,i).subscribe((function(e){e.tickets&&(t.tickets=e.tickets.docs,t.limit=e.tickets.limit,t.nextPage=e.tickets.nextPage,t.prevPage=e.tickets.prevPage,t.totalDocs=e.tickets.totalDocs,t.totalPages=e.tickets.totalPages,t.pagingCounter=e.tickets.pagingCounter,t.loader.close())}),(function(e){t.openSnackBar(e.message,"Cerrar")})))}))}))}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"getSectorTickets",value:function(){var t=this;this._route.params.forEach((function(e){t._route.queryParams.forEach((function(c){t.query=c,t.page=e.page,t.limit=e.perPage,t._ticketService.getSectorPaginatedList(t.token,t.page,t.limit,c,t.identity.sector._id).subscribe((function(e){e.tickets&&(t.tickets=e.tickets.docs,t.limit=e.tickets.limit,t.nextPage=e.tickets.nextPage,t.prevPage=e.tickets.prevPage,t.totalDocs=e.tickets.totalDocs,t.totalPages=e.tickets.totalPages,t.pagingCounter=e.tickets.pagingCounter,t.loader.close()),t.loader.close()}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}))}))}},{key:"isLastPage",value:function(){return this.totalDocs<this.pagingCounter+this.limit?this.totalDocs:this.pagingCounter+this.limit-1}},{key:"changeLimit",value:function(t){this.limit=t,this._router.navigate(["/ticket/list",this.page,this.limit],{queryParams:this.query})}},{key:"changeDate",value:function(t){return k(t,"YYYY-MM-DD HH:mm").format("DD-MM-YYYY HH:mm")}},{key:"selectTicket",value:function(t,e){t.ctrlKey?"Cerrado"!=e.status?-1!=this.groupTicket.indexOf(e.numTicket)?this.groupTicket.splice(this.groupTicket.indexOf(e.numTicket),1):this.groupTicket.push(e.numTicket):this.openSnackBar("El ticket se encuentra cerrado","Cerrar"):this._router.navigate(["/ticket/gestion",e._id])}},{key:"isInGroup",value:function(t){return-1!=this.groupTicket.indexOf(t.numTicket)}},{key:"unify",value:function(){var t=this;this.confirmService.confirm({message:"\xbfEsta seguro que quiere unificar los tickets seleccionados? Prevalecer\xe1 el ticket mas antiguo y se pondr\xe1 en copia a los solicitantes que hayan generado las otras consultas."}).subscribe((function(e){e&&t._ticketService.unify(t.token,t.groupTicket).subscribe((function(e){e.tickets?(t.openSnackBar("Unificaci\xf3n realizada","Cerrar"),t.groupTicket=new Array,t.getTickets()):t._router.navigate(["/"])}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}))}},{key:"getQuery",value:function(){this._route.queryParams.forEach((function(t){return t}))}},{key:"refCheck",value:function(t){t.currentTarget.checked?(this.isSectorTickets=!0,this.getSectorTickets()):(this.isSectorTickets=!1,location.reload(),this.getTickets())}},{key:"openPopUp",value:function(){var t=this;this.loader.open(),this.dialog.open(E,{width:"720px",disableClose:!1,data:{title:"Filtro de tickets"}}).afterClosed().subscribe((function(e){e&&(t.isSectorTickets&&(e.isSectorTickets=!0),t._router.navigate(["ticket/list",1,t.limit],{queryParams:e})),t.loader.close()}))}}]),t}()).\u0275fac=function(t){return new(t||U)(T.Vb(f.b),T.Vb(n.a),T.Vb(n.g),T.Vb(m.a),T.Vb(g.a),T.Vb(w.a),T.Vb(v.a),T.Vb(y.a))},U.\u0275cmp=T.Pb({type:U,selectors:[["app-ticket-list"]],features:[T.Fb([v.a,y.a])],decls:87,vars:11,consts:[[1,"card","shadow"],[1,"card-body"],[1,"row"],[1,"col-md-6","text-nowrap"],["id","dataTable_length",1,"dataTables_length"],[1,"form-control","form-control-sm","custom-select","custom-select-sm",3,"change"],["value","10","selected",""],["value","25"],["value","50"],["value","100"],[1,"col-md-6"],["id","dataTable_filter",1,"text-md-right","dataTables_filter"],[1,"form-check"],["type","checkbox","id","ref",1,"form-check-input",3,"disabled","change"],["for","ref",1,"form-check-label"],[1,"row",2,"margin-bottom","5px"],[1,"col","text-nowrap"],["type","button",1,"btn","btn-dark","dark'",3,"click"],[1,"fa","fa-filter"],["class","btn btn-dark dark","type","button","style","margin-left: 5px;",3,"click",4,"ngIf"],["id","dataTable",1,"table-responsive","table"],["id","dataTable",1,"table","table-hover","table-sm"],[2,"width","300px"],[3,"className",4,"ngFor","ngForOf"],[1,"col-md-6","align-self-center"],["id","dataTable_info",1,"dataTables_info"],[1,"d-lg-flex","justify-content-lg-end","dataTables_paginate","paging_simple_numbers"],[1,"pagination"],[1,"page-item"],["class","page-link",3,"routerLink","queryParams",4,"ngIf"],[1,"page-item","active"],[1,"page-link"],["type","button",1,"btn","btn-dark","dark",2,"margin-left","5px",3,"click"],[3,"click"],["data-title","Numero"],["data-title","Solicitante"],["class","rounded-circle mr-2","width","30","height","30",3,"src",4,"ngIf"],["class","rounded-circle mr-2","width","30","height","30","src","assets/images/system/user-placeholder.png",4,"ngIf"],["data-title","Asunto",1,"text-nowrap","text-truncate","text-break"],["ng-bind","ticket.sub",1,"body-cell",2,"font-size","14px",3,"title"],["data-title","Agente",4,"ngIf"],["data-title","Estado"],["data-title","Fecha"],["data-title","Novedad"],["width","30","height","30",1,"rounded-circle","mr-2",3,"src"],["width","30","height","30","src","assets/images/system/user-placeholder.png",1,"rounded-circle","mr-2"],["data-title","Agente"],[1,"page-link",3,"routerLink","queryParams"]],template:function(t,e){1&t&&(T.bc(0,"mat-card",0),T.bc(1,"div",1),T.bc(2,"div",2),T.bc(3,"div",3),T.bc(4,"div",4),T.bc(5,"label"),T.Vc(6,"Mostrar\xa0 "),T.bc(7,"select",5),T.jc("change",(function(t){return e.changeLimit(t.target.value)})),T.bc(8,"option",6),T.Vc(9,"10"),T.ac(),T.bc(10,"option",7),T.Vc(11,"25"),T.ac(),T.bc(12,"option",8),T.Vc(13,"50"),T.ac(),T.bc(14,"option",9),T.Vc(15,"100"),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(16,"div",10),T.bc(17,"div",11),T.bc(18,"div",12),T.bc(19,"input",13),T.jc("change",(function(t){return e.refCheck(t)})),T.ac(),T.bc(20,"label",14),T.Vc(21,"TICKETS DEL SECTOR"),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(22,"div",15),T.bc(23,"div",16),T.bc(24,"button",17),T.jc("click",(function(t){return e.openPopUp()})),T.Wb(25,"i",18),T.ac(),T.Tc(26,V,2,0,"button",19),T.ac(),T.ac(),T.bc(27,"div",20),T.bc(28,"table",21),T.bc(29,"thead"),T.bc(30,"tr"),T.bc(31,"th"),T.Vc(32,"N\xfamero"),T.ac(),T.bc(33,"th"),T.Vc(34,"Solicitante"),T.ac(),T.bc(35,"th",22),T.Vc(36,"Asunto"),T.ac(),T.bc(37,"th"),T.Vc(38,"Agente"),T.ac(),T.bc(39,"th"),T.Vc(40,"Estado"),T.ac(),T.bc(41,"th"),T.Vc(42,"Fecha"),T.ac(),T.bc(43,"th"),T.Vc(44,"Novedad"),T.ac(),T.ac(),T.ac(),T.Tc(45,L,21,16,"tbody",23),T.bc(46,"tfoot"),T.bc(47,"tr"),T.bc(48,"td"),T.bc(49,"strong"),T.Vc(50,"Numero"),T.ac(),T.ac(),T.bc(51,"td"),T.bc(52,"strong"),T.Vc(53,"Solicitante"),T.ac(),T.ac(),T.bc(54,"td"),T.bc(55,"strong"),T.Vc(56,"Asunto"),T.ac(),T.ac(),T.bc(57,"td"),T.bc(58,"strong"),T.Vc(59,"Agente"),T.ac(),T.ac(),T.bc(60,"td"),T.bc(61,"strong"),T.Vc(62,"Estado"),T.ac(),T.ac(),T.bc(63,"td"),T.bc(64,"strong"),T.Vc(65,"Fecha"),T.ac(),T.ac(),T.bc(66,"td"),T.bc(67,"strong"),T.Vc(68,"Novedad"),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(69,"div",2),T.bc(70,"div",24),T.bc(71,"p",25),T.Vc(72),T.ac(),T.ac(),T.bc(73,"div",10),T.bc(74,"nav",26),T.bc(75,"ul",27),T.bc(76,"li",28),T.Tc(77,B,3,4,"a",29),T.ac(),T.bc(78,"li",28),T.Tc(79,z,2,6,"a",29),T.ac(),T.bc(80,"li",30),T.bc(81,"a",31),T.Vc(82),T.ac(),T.ac(),T.bc(83,"li",28),T.Tc(84,Y,2,6,"a",29),T.ac(),T.bc(85,"li",28),T.Tc(86,N,3,5,"a",29),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.ac()),2&t&&(T.Gb(19),T.uc("disabled",0==e.identity.sectorRef),T.Gb(7),T.uc("ngIf","ROLE_REQUESTER"!=e.identity.role&&e.groupTicket.length>1),T.Gb(19),T.uc("ngForOf",e.tickets),T.Gb(27),T.Zc("Mostrando ",e.pagingCounter," a ",e.isLastPage()," de ",e.totalDocs,""),T.Gb(5),T.uc("ngIf",null!=e.prevPage),T.Gb(2),T.uc("ngIf",null!=e.prevPage),T.Gb(3),T.Wc(e.page),T.Gb(2),T.uc("ngIf",null!=e.nextPage),T.Gb(2),T.uc("ngIf",null!=e.nextPage))},directives:[u.a,a.r,a.w,i.m,i.l,n.j],styles:[".body-cell[_ngcontent-%COMP%]{width:25em;margin:0 0 2em;text-overflow:ellipsis;overflow:hidden}.sesion-container[_ngcontent-%COMP%]{height:150px;overflow-y:auto}.selected[_ngcontent-%COMP%]{background-color:#018dda;color:#fff}.closed[_ngcontent-%COMP%]{background-color:#f1f1f1;font-style:italic}"]}),U),X=function t(e,c,i,n,a,s,r,o,u,l,d,p,f,h,b,m,g,k,v,y){_classCallCheck(this,t),this._id=e,this.sub=c,this.numTicket=i,this.requester=n,this.agent=a,this.team=s,this.status=r,this.lastActivity=o,this.createDate=u,this.resolveDate=l,this.rating=d,this.source=p,this.tags=f,this.priority=h,this.company=b,this.subTypeTicket=m,this.cc=g,this.workTime=k,this.realWorkTime=v,this.obsWorkTime=y},J=function t(e,c,i,n,a,s,r,o){_classCallCheck(this,t),this._id=e,this.text=c,this.user=i,this.createDate=n,this.ticket=a,this.type=s,this.files=r,this.read=o},K=c("3uMe"),Z=(c("AJX/"),c("tk/3")),tt=((H=function(){function t(e){_classCallCheck(this,t),this._httpClient=e,this.httpOptions={headers:new Z.e({"Content-Type":"application/json",Authorization:"null"})},this.url=x.a.url}return _createClass(t,[{key:"add",value:function(t,e){var c=JSON.stringify(e);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.post(this.url+"textblock/add",c,this.httpOptions)}},{key:"edit",value:function(t,e,c){var i=JSON.stringify(c);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"textblock/update/"+e,i,this.httpOptions)}},{key:"delete",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.delete(this.url+"textblock/delete/"+e,this.httpOptions)}},{key:"readAgent",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"textblock/read-agent/"+e,{read:!0},this.httpOptions)}},{key:"readRequester",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"textblock/read-requester/"+e,{read:!0},this.httpOptions)}},{key:"getList",value:function(t){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"textblock/textblocks",this.httpOptions)}},{key:"getOne",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"textblock/textblock/"+e,this.httpOptions)}},{key:"getForText",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"textblock/for-text/"+e,this.httpOptions)}},{key:"getForTicket",value:function(t,e,c){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"textblock/for-ticket/"+e+"/"+c,this.httpOptions)}}]),t}()).\u0275fac=function(t){return new(t||H)(T.fc(Z.c))},H.\u0275prov=T.Rb({token:H,factory:H.\u0275fac}),H),et=c("Q2c7"),ct=c("jZsi"),it=c("wkIo"),nt=c("AV9v"),at=c("47Ty"),st=c("vHsL"),rt=c("Nptc"),ot=c("AASI"),ut=c("49gX"),lt=c("7EHt"),dt=c("znSr"),pt=c("CzEO"),ft=c("/1cH");function ht(t,e){if(1&t&&(T.bc(0,"label",10),T.Vc(1),T.ac()),2&t){var c=T.nc();T.Gb(1),T.Wc(c.user)}}function bt(t,e){1&t&&(T.bc(0,"label",10),T.Vc(1,"Informaci\xf3n"),T.ac())}function mt(t,e){if(1&t){var c=T.cc();T.bc(0,"div",11),T.bc(1,"button",12),T.Wb(2,"i",13),T.ac(),T.bc(3,"div",14),T.bc(4,"a",15),T.jc("click",(function(t){return T.Mc(c),T.nc().delete()})),T.Vc(5," Eliminar "),T.ac(),T.ac(),T.ac()}}function gt(t,e){1&t&&T.Wb(0,"hr")}function kt(t,e){if(1&t&&T.Wb(0,"p",6),2&t){var c=T.nc();T.uc("innerHTML",c.sign,T.Nc)}}function vt(t,e){1&t&&T.Wb(0,"i",26)}function yt(t,e){1&t&&T.Wb(0,"i",27)}function xt(t,e){1&t&&T.Wb(0,"i",28)}function _t(t,e){1&t&&T.Wb(0,"i",29)}function Ct(t,e){1&t&&T.Wb(0,"i",30)}function Tt(t,e){1&t&&T.Wb(0,"i",31)}function wt(t,e){1&t&&T.Wb(0,"i",32)}function Mt(t,e){if(1&t&&(T.bc(0,"span"),T.bc(1,"a",18),T.Tc(2,vt,1,0,"i",19),T.Tc(3,yt,1,0,"i",20),T.Tc(4,xt,1,0,"i",21),T.Tc(5,_t,1,0,"i",22),T.Tc(6,Ct,1,0,"i",23),T.Tc(7,Tt,1,0,"i",24),T.Tc(8,wt,1,0,"i",25),T.ac(),T.ac()),2&t){var c=e.$implicit,i=T.nc(2);T.Gb(1),T.vc("href",i.url+"textblock/file/"+c,T.Oc),T.Gb(1),T.uc("ngIf",i.checkExt(c)&&"docx"==i.checkExt(c)||"odt"==i.checkExt(c)),T.Gb(1),T.uc("ngIf",i.checkExt(c)&&("xlsx"==i.checkExt(c)||"xls"==i.checkExt(c))),T.Gb(1),T.uc("ngIf",i.checkExt(c)&&"pdf"==i.checkExt(c)),T.Gb(1),T.uc("ngIf",i.checkExt(c)&&("jpge"==i.checkExt(c)||"jpg"==i.checkExt(c)||"jpeg"==i.checkExt(c)||"png"==i.checkExt(c)||"tiff"==i.checkExt(c)||"tif"==i.checkExt(c))),T.Gb(1),T.uc("ngIf",i.checkExt(c)&&("zip"==i.checkExt(c)||"rar"==i.checkExt(c))),T.Gb(1),T.uc("ngIf",i.checkExt(c)&&"msg"==i.checkExt(c)),T.Gb(1),T.uc("ngIf",!i.checkExt(c))}}function St(t,e){if(1&t&&(T.bc(0,"div",16),T.Tc(1,Mt,9,8,"span",17),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngForOf",c.groupFiles)}}var It,Gt=((It=function(){function t(e,c){_classCallCheck(this,t),this._textblockService=e,this._userService=c,this.deleteMessage=new T.o,this.errorMessage=new T.o,this.refresh=new T.o,this.identity=this._userService.getIdentity(),this.token=this._userService.getToken(),this.url=x.a.url}return _createClass(t,[{key:"ngOnInit",value:function(){this.date=k(this.date,"YYYY-MM-DD HH:mm").format("DD-MM-YYYY HH:mm"),this.groupFiles=this.files.split(",")}},{key:"ngAfterViewInit",value:function(){this.scrollElement(),$("table").attr("border","1")}},{key:"scrollElement",value:function(){var t=document.getElementById("chatbox-scroll");t.scrollTop=t.scrollHeight}},{key:"checkExt",value:function(t){var e=t.split(".")[1];return("pdf"==e||"xlsx"==e||"xls"==e||"msg"==e||"docx"==e||"odt"==e||"rar"==e||"zip"==e||"png"==e||"jpge"==e||"jpeg"==e||"jpg"==e||"tif"==e||"tiff"==e)&&e}},{key:"getCardClass",value:function(){var t;switch(this.type){case"PUBLIC":case"PRIVATE":t={card:!0,chatbox:!0};break;case"INFO":t="true"==this.info?{card:!0,chatinfo:!0}:{diplaynone:!0};break;case"REQUEST":t={card:!0,chatbox:!0,"ml-auto":!0};break;default:alert("Hubo un problema con la conversaci\xf3n del ticket, por favor reportarlo al administrador")}return t}},{key:"getContainerClass",value:function(){var t;switch(this.type){case"PUBLIC":case"PRIVATE":t={container:!0,chatheader:!0};break;case"INFO":t={container:!0,infoheader:!0};break;case"REQUEST":t={container:!0,chatheaderreq:!0};break;default:alert("Hubo un problema con la conversaci\xf3n del ticket, por favor reportarlo al administrador")}return t}},{key:"getCardBodyClass",value:function(){return"PRIVATE"==this.type?{"card-body":!0,chatprivate:!0}:{"card-body":!0}}},{key:"delete",value:function(){var t=k().format("YYYY-MM-DD HH:ss"),e=k(this.date,"DD-MM-YYYY HH:ss").add(2,"hours").format("YYYY-MM-DD HH:ss");k(t).isSameOrBefore(e)?this.updateChatbox():this.errorMessage.next()}},{key:"updateChatbox",value:function(){var t=this;this._textblockService.delete(this.token,this._id).subscribe((function(e){e.textblock&&(t.deleteMessage.next(),t.refresh.next())}),(function(t){null!=t&&(JSON.parse(t._body),console.error(t))}))}}]),t}()).\u0275fac=function(t){return new(t||It)(T.Vb(tt),T.Vb(v.a))},It.\u0275cmp=T.Pb({type:It,selectors:[["app-chatbox"]],inputs:{_id:"_id",text:"text",sign:"sign",user:"user",userId:"userId",date:"date",type:"type",files:"files",info:"info"},outputs:{deleteMessage:"deleteMessage",errorMessage:"errorMessage",refresh:"refresh"},features:[T.Fb([v.a,tt])],decls:13,vars:11,consts:[[3,"ngClass"],[2,"padding-right","0","padding-left","0",3,"ngClass"],[1,"user-date",2,"margin-top","4px"],["style","margin-left: 13px;",4,"ngIf"],["class","dropdown float-right","style","margin-top:-7px;",4,"ngIf"],[1,"float-right",2,"margin-right","15px"],[1,"card-text",3,"innerHTML"],[4,"ngIf"],["class","card-text",3,"innerHTML",4,"ngIf"],["class","text-right",4,"ngIf"],[2,"margin-left","13px"],[1,"dropdown","float-right",2,"margin-top","-7px"],["data-toggle","dropdown","aria-expanded","false","type","button",1,"btn","btn-sm"],[1,"fas","fa-ellipsis-v","option"],["role","menu",1,"dropdown-menu"],["role","presentation",1,"dropdown-item",3,"click"],[1,"text-right"],[4,"ngFor","ngForOf"],["target","blank",3,"href"],["class","fas fa-file-word adjunt adjunt-icon",4,"ngIf"],["class","fas fa-file-excel adjunt adjunt-icon",4,"ngIf"],["class","fas fa-file-pdf adjunt adjunt-icon",4,"ngIf"],["class","fas fa-file-image adjunt adjunt-icon",4,"ngIf"],["class","fas fa-file-archive adjunt adjunt-icon",4,"ngIf"],["class","fas fa-envelope adjunt adjunt-icon",4,"ngIf"],["class","fas fa-file adjunt adjunt-icon",4,"ngIf"],[1,"fas","fa-file-word","adjunt","adjunt-icon"],[1,"fas","fa-file-excel","adjunt","adjunt-icon"],[1,"fas","fa-file-pdf","adjunt","adjunt-icon"],[1,"fas","fa-file-image","adjunt","adjunt-icon"],[1,"fas","fa-file-archive","adjunt","adjunt-icon"],[1,"fas","fa-envelope","adjunt","adjunt-icon"],[1,"fas","fa-file","adjunt","adjunt-icon"]],template:function(t,e){1&t&&(T.bc(0,"div",0),T.bc(1,"div",1),T.bc(2,"div",2),T.Tc(3,ht,2,1,"label",3),T.Tc(4,bt,2,0,"label",3),T.Tc(5,mt,6,0,"div",4),T.bc(6,"label",5),T.Vc(7),T.ac(),T.ac(),T.ac(),T.bc(8,"div",0),T.Wb(9,"p",6),T.Tc(10,gt,1,0,"hr",7),T.Tc(11,kt,1,1,"p",8),T.Tc(12,St,2,1,"div",9),T.ac(),T.ac()),2&t&&(T.uc("ngClass",e.getCardClass()),T.Gb(1),T.uc("ngClass",e.getContainerClass()),T.Gb(2),T.uc("ngIf","INFO"!=e.type),T.Gb(1),T.uc("ngIf","INFO"==e.type),T.Gb(1),T.uc("ngIf",e.userId==e.identity._id&&"INFO"!=e.type),T.Gb(2),T.Wc(e.date),T.Gb(1),T.uc("ngClass",e.getCardBodyClass()),T.Gb(1),T.uc("innerHTML",e.text,T.Nc),T.Gb(1),T.uc("ngIf",""!=e.sign&&"INFO"!=e.type),T.Gb(1),T.uc("ngIf",""!=e.sign&&"INFO"!=e.type),T.Gb(1),T.uc("ngIf",e.files))},directives:[i.k,dt.a,i.m,i.l],styles:[".card[_ngcontent-%COMP%]{box-shadow:2px 2px 10px #666}.option[_ngcontent-%COMP%]{color:#dcdcdc}.adjunt-icon[_ngcontent-%COMP%]{font-size:23px;padding-top:5px;margin-left:3px}.chatheader[_ngcontent-%COMP%]{height:30px;display:flex;background-color:#1e2833;color:#fff}.chatinfo[_ngcontent-%COMP%]{border:1px solid #1e2833;margin:10px}@media (min-width:300px){.user-date[_ngcontent-%COMP%]{font-size:12px}}.user-date[_ngcontent-%COMP%]{width:80%}.infoheader[_ngcontent-%COMP%]{background-color:#5ab3e6;color:#000}.card.chatbox[_ngcontent-%COMP%]{max-width:80%;min-height:30%;border:1px solid #1e2833;margin:10px}.user-date[_ngcontent-%COMP%]{width:100%}.chatheaderreq[_ngcontent-%COMP%]{height:30px;display:flex;background-color:#46a376;color:#fff}.chatprivate[_ngcontent-%COMP%]{background-color:#676767;color:#fff}.adjunt[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;color:#7979ff}.card-text[_ngcontent-%COMP%]{overflow-x:auto}.diplaynone[_ngcontent-%COMP%]{display:none}"]}),It),Ot=c("7ZcW");function Et(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){return T.Mc(c),T.nc(3).setPriority("Urgente")})),T.Vc(1," Urgente "),T.ac()}}function Vt(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){return T.Mc(c),T.nc(3).setPriority("Normal")})),T.Vc(1," Normal "),T.ac()}}function jt(t,e){if(1&t&&(T.bc(0,"div",47),T.bc(1,"button",48),T.Vc(2),T.ac(),T.bc(3,"div",49),T.Tc(4,Et,2,0,"a",50),T.Tc(5,Vt,2,0,"a",50),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(2),T.Xc(" ",c.ticket.priority," "),T.Gb(2),T.uc("ngIf","Urgente"!=c.ticket.priority),T.Gb(1),T.uc("ngIf","Normal"!=c.ticket.priority)}}function qt(t,e){if(1&t&&(T.bc(0,"span"),T.bc(1,"strong"),T.Vc(2),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(2),T.Wc(c.ticket.priority)}}function Pt(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,jt,6,3,"div",46),T.Tc(2,qt,3,1,"span",7),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngIf",c.identity.company._id==c.ticket.company._id&&"Cerrado"!=c.ticket.status),T.Gb(1),T.uc("ngIf",c.identity.company._id!=c.ticket.company._id||"Cerrado"==c.ticket.status)}}function Ft(t,e){if(1&t&&(T.bc(0,"span"),T.bc(1,"strong"),T.Vc(2),T.ac(),T.ac()),2&t){var c=T.nc();T.Gb(2),T.Wc(c.ticket.priority)}}function Rt(t,e){if(1&t&&(T.bc(0,"strong"),T.Vc(1),T.ac()),2&t){var c=T.nc();T.Gb(1),T.Xc(" ",c.ticket.subTypeTicket.typeTicket.name," ")}}function Wt(t,e){if(1&t&&(T.bc(0,"strong"),T.Vc(1),T.ac()),2&t){var c=T.nc();T.Gb(1),T.Xc(" ",c.ticket.subTypeTicket.name," ")}}function Lt(t,e){if(1&t&&(T.bc(0,"span"),T.bc(1,"strong"),T.Vc(2),T.bc(3,"span"),T.Vc(4,";"),T.ac(),T.ac(),T.ac()),2&t){var c=e.$implicit;T.Gb(2),T.Wc(c.name)}}function At(t,e){1&t&&T.Wb(0,"img",52)}function Bt(t,e){if(1&t&&T.Wb(0,"img",53),2&t){var c=T.nc();T.vc("src",c.url+"user/image/"+c.ticket.requester.image,T.Oc)}}function Dt(t,e){if(1&t&&(T.bc(0,"div",10),T.bc(1,"div",55),T.bc(2,"span"),T.bc(3,"em"),T.Vc(4),T.ac(),T.ac(),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.Wc(c.ticket.requester.sector.name)}}function zt(t,e){if(1&t&&(T.bc(0,"div",10),T.bc(1,"div",55),T.bc(2,"span"),T.bc(3,"em"),T.Wb(4,"i",57),T.Vc(5),T.ac(),T.ac(),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(5),T.Xc(" ",c.ticket.requester.phone,"")}}function Yt(t,e){if(1&t&&(T.bc(0,"div",54),T.bc(1,"div",10),T.bc(2,"div",55),T.bc(3,"span"),T.bc(4,"strong"),T.Vc(5),T.ac(),T.ac(),T.ac(),T.ac(),T.Tc(6,Dt,5,1,"div",56),T.Tc(7,zt,6,1,"div",56),T.ac()),2&t){var c=T.nc();T.Gb(5),T.Wc(c.ticket.requester.name+" "+c.ticket.requester.surname),T.Gb(1),T.uc("ngIf",c.ticket.requester.sector),T.Gb(1),T.uc("ngIf",null!=c.ticket.requester.phone)}}function Nt(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).selectCompany(i._id,i.name)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.Xc(" ",i.name," ")}}function Ut(t,e){if(1&t&&(T.bc(0,"div",59),T.bc(1,"button",60),T.Vc(2," Cambiar "),T.ac(),T.bc(3,"div",49),T.Tc(4,Nt,2,1,"a",61),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.uc("ngForOf",c.companies)}}function $t(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,Ut,5,1,"div",58),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngIf",c.identity.company._id==c.ticket.company._id&&"Cerrado"!=c.ticket.status)}}function Ht(t,e){1&t&&T.Wb(0,"img",62)}function Qt(t,e){if(1&t&&T.Wb(0,"img",63),2&t){var c=T.nc();T.vc("src",c.url+"company/image/"+c.ticket.company.image,T.Oc)}}function Xt(t,e){1&t&&(T.bc(0,"p",64),T.bc(1,"strong"),T.Vc(2,"Sin departamento"),T.ac(),T.ac())}function Jt(t,e){if(1&t&&(T.bc(0,"p",64),T.bc(1,"strong"),T.Vc(2),T.ac(),T.ac()),2&t){var c=T.nc();T.Gb(2),T.Wc(c.ticket.company.name)}}function Kt(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).selectTeam(i._id,i.name)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.Xc(" ",i.name," ")}}function Zt(t,e){if(1&t&&(T.bc(0,"div",59),T.bc(1,"button",60),T.Vc(2," Cambiar "),T.ac(),T.bc(3,"div",49),T.Tc(4,Kt,2,1,"a",61),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.uc("ngForOf",c.teams)}}function te(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,Zt,5,1,"div",58),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngIf",c.identity.company._id==c.ticket.company._id&&"Cerrado"!=c.ticket.status)}}function ee(t,e){1&t&&T.Wb(0,"img",65)}function ce(t,e){if(1&t&&T.Wb(0,"img",63),2&t){var c=T.nc();T.vc("src",c.url+"team/image/"+c.ticket.team.image,T.Oc)}}function ie(t,e){1&t&&(T.bc(0,"p",64),T.bc(1,"strong"),T.Vc(2,"Sin equipo"),T.ac(),T.ac())}function ne(t,e){if(1&t&&(T.bc(0,"p",64),T.bc(1,"strong"),T.Vc(2),T.ac(),T.ac()),2&t){var c=T.nc();T.Gb(2),T.Wc(c.ticket.team.name)}}function ae(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).selectAgent(i._id,i.name,i.surname)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.Xc(" ",i.name+" "+i.surname," ")}}function se(t,e){if(1&t&&(T.bc(0,"div",67),T.bc(1,"button",60),T.Vc(2," Cambiar "),T.ac(),T.bc(3,"div",49),T.Tc(4,ae,2,1,"a",61),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.uc("ngForOf",c.agents)}}function re(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,se,5,1,"div",66),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngIf",c.identity.company._id==c.ticket.company._id&&"Cerrado"!=c.ticket.status)}}function oe(t,e){1&t&&T.Wb(0,"img",68)}function ue(t,e){if(1&t&&T.Wb(0,"img",63),2&t){var c=T.nc();T.vc("src",c.url+"user/image/"+c.ticket.agent.image,T.Oc)}}function le(t,e){if(1&t&&(T.bc(0,"p",64),T.bc(1,"strong"),T.Vc(2),T.ac(),T.ac()),2&t){var c=T.nc();T.Gb(2),T.Wc(c.ticket.agent.name+" "+c.ticket.agent.surname)}}function de(t,e){1&t&&(T.bc(0,"p",64),T.bc(1,"strong"),T.Vc(2,"Sin agente"),T.ac(),T.ac())}function pe(t,e){if(1&t){var c=T.cc();T.bc(0,"div",70),T.bc(1,"span"),T.Vc(2,"Fecha estimada de soluci\xf3n "),T.ac(),T.bc(3,"input",71,72),T.jc("ngModelChange",(function(t){return T.Mc(c),T.nc(2).ticket.resolveDate=t}))("change",(function(t){return T.Mc(c),T.nc(2).selectResolveDate()})),T.ac(),T.ac()}if(2&t){var i=T.nc(2);T.Gb(3),T.uc("ngModel",i.ticket.resolveDate)}}function fe(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,pe,5,1,"div",69),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngIf",c.identity.company._id==c.ticket.company._id)}}function he(t,e){if(1&t&&(T.bc(0,"small"),T.Vc(1),T.ac()),2&t){var c=T.nc().$implicit;T.Gb(1),T.Xc(" | ",c.item.brand,"")}}function be(t,e){if(1&t&&(T.bc(0,"li",6),T.bc(1,"span"),T.Vc(2),T.ac(),T.Tc(3,he,2,1,"small",7),T.ac()),2&t){var c=e.$implicit,i=T.nc(2);T.Gb(2),T.Wc(c.item.name),T.Gb(1),T.uc("ngIf",c.item.brand&&"ROLE_REQUESTER"!=i.identity.role)}}function me(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,be,4,2,"li",73),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngForOf",c.movimsTicket)}}function ge(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",81),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(2).getStock(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i),T.Gb(1),T.Xc(" ",i.name," ")}}function ke(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",82),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(2).setStock(i)})),T.bc(1,"span"),T.Vc(2),T.ac(),T.Vc(3," | "),T.bc(4,"small"),T.Vc(5),T.ac(),T.ac()}if(2&t){var i=e.$implicit;T.yc("matTooltip","",i.item.name," (",i.cant,") - ",i.item.brand,""),T.Gb(2),T.Yc("",i.item.name," (",i.cant,")"),T.Gb(3),T.Wc(i.item.brand)}}function ve(t,e){if(1&t){var c=T.cc();T.bc(0,"li",74),T.bc(1,"mat-form-field",75),T.bc(2,"mat-label"),T.Vc(3,"Dep\xf3sito"),T.ac(),T.bc(4,"mat-select",76),T.jc("ngModelChange",(function(t){return T.Mc(c),T.nc().deposit=t})),T.Tc(5,ge,2,2,"mat-option",77),T.ac(),T.ac(),T.bc(6,"mat-form-field",75),T.bc(7,"input",78),T.jc("input",(function(t){return T.Mc(c),T.nc().filterStock()}))("ngModelChange",(function(t){return T.Mc(c),T.nc().stockFilter=t})),T.ac(),T.bc(8,"mat-autocomplete",null,79),T.Tc(10,ke,6,6,"mat-option",80),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.Jc(9),n=T.nc();T.Gb(4),T.uc("ngModel",n.deposit),T.Gb(1),T.uc("ngForOf",n.deposits),T.Gb(2),T.uc("ngModel",n.stockFilter)("matAutocomplete",i),T.Gb(3),T.uc("ngForOf",n.stocks)}}function ye(t,e){if(1&t&&T.Wb(0,"img",86),2&t){var c=T.nc().$implicit,i=T.nc(2);T.vc("src",i.url+"user/image/"+c.image,T.Oc)}}function xe(t,e){1&t&&T.Wb(0,"img",87)}function _e(t,e){if(1&t){var c=T.cc();T.bc(0,"button",88),T.jc("click",(function(t){T.Mc(c);var e=T.nc().$implicit;return T.nc(2).deleteCc(e)})),T.Wb(1,"i",89),T.ac()}}function Ce(t,e){if(1&t&&(T.bc(0,"li",6),T.Tc(1,ye,1,1,"img",83),T.Tc(2,xe,1,0,"img",84),T.bc(3,"span"),T.Vc(4),T.ac(),T.Tc(5,_e,2,0,"button",85),T.ac()),2&t){var c=e.$implicit,i=T.nc(2);T.Gb(1),T.uc("ngIf","null"!=c.image),T.Gb(1),T.uc("ngIf","null"==c.image),T.Gb(2),T.Yc("",c.name," ",c.surname,""),T.Gb(1),T.uc("ngIf","Cerrado"!=i.ticket.status)}}function Te(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,Ce,6,5,"li",73),T.ac()),2&t){var c=T.nc();T.Gb(1),T.uc("ngForOf",c.ticket.cc)}}function we(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",93),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(2).setCc(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.Xc(" ",i.name+" "+i.surname," ")}}function Me(t,e){if(1&t){var c=T.cc();T.bc(0,"li",74),T.bc(1,"mat-form-field",75),T.bc(2,"input",90),T.jc("input",(function(t){return T.Mc(c),T.nc().filterCc()}))("ngModelChange",(function(t){return T.Mc(c),T.nc().ccFilter=t})),T.ac(),T.bc(3,"mat-autocomplete",null,91),T.Tc(5,we,2,1,"mat-option",92),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.Jc(4),n=T.nc();T.Gb(2),T.uc("ngModel",n.ccFilter)("matAutocomplete",i),T.Gb(3),T.uc("ngForOf",n.ccList)}}function Se(t,e){if(1&t){var c=T.cc();T.bc(0,"input",94),T.jc("ngModelChange",(function(t){return T.Mc(c),T.nc().subMod=t})),T.ac()}if(2&t){var i=T.nc();T.uc("ngModel",i.subMod)}}function Ie(t,e){if(1&t){var c=T.cc();T.bc(0,"input",95),T.jc("click",(function(t){return T.Mc(c),T.nc().editTicketSub()})),T.ac()}}function Ge(t,e){if(1&t){var c=T.cc();T.bc(0,"input",96),T.jc("click",(function(t){return T.Mc(c),T.nc().editSub=!1})),T.ac()}}function Oe(t,e){if(1&t){var c=T.cc();T.bc(0,"h6",97),T.jc("click",(function(t){T.Mc(c);var e=T.nc();return e.subToEdit(e.ticket.sub)})),T.bc(1,"strong"),T.Vc(2),T.ac(),T.ac()}if(2&t){var i=T.nc();T.Gb(2),T.Wc(i.ticket.sub)}}var Ee=function(t){return["/ticket/gestion",t]};function Ve(t,e){if(1&t&&(T.bc(0,"a",98),T.Wb(1,"i",99),T.ac()),2&t){var c=T.nc();T.uc("routerLink",T.Ac(1,Ee,c.prev._id))}}function je(t,e){1&t&&T.Wb(0,"i",100)}function qe(t,e){1&t&&T.Wb(0,"i",101)}function Pe(t,e){if(1&t&&(T.bc(0,"a",102),T.Wb(1,"i",103),T.ac()),2&t){var c=T.nc();T.uc("routerLink",T.Ac(1,Ee,c.next._id))}}function Fe(t,e){if(1&t){var c=T.cc();T.bc(0,"app-chatbox",104),T.jc("deleteMessage",(function(t){return T.Mc(c),T.nc().deleteMessage()}))("refresh",(function(t){return T.Mc(c),T.nc().getChat()}))("errorMessage",(function(t){return T.Mc(c),T.nc().errorMessage()})),T.ac()}if(2&t){var i=e.$implicit,n=T.nc();T.vc("_id",i._id),T.vc("text",i.text),T.vc("sign",i.user.sign),T.vc("type",i.type),T.vc("user",i.user.name+n.space+i.user.surname),T.vc("userId",i.user._id),T.vc("date",i.createDate),T.vc("files",i.files),T.vc("info",n.info)}}function Re(t,e){if(1&t){var c=T.cc();T.bc(0,"div",38),T.bc(1,"div",105),T.bc(2,"div",106),T.bc(3,"div"),T.bc(4,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude03")})),T.Wb(5,"img",107),T.ac(),T.bc(6,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude04")})),T.Wb(7,"img",108),T.ac(),T.bc(8,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude01")})),T.Wb(9,"img",109),T.ac(),T.bc(10,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude06")})),T.Wb(11,"img",110),T.ac(),T.bc(12,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude05")})),T.Wb(13,"img",111),T.ac(),T.bc(14,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude02")})),T.Wb(15,"img",112),T.ac(),T.bc(16,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude09")})),T.Wb(17,"img",113),T.ac(),T.bc(18,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude0a")})),T.Wb(19,"img",114),T.ac(),T.bc(20,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude1c")})),T.Wb(21,"img",115),T.ac(),T.bc(22,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude1d")})),T.Wb(23,"img",116),T.ac(),T.bc(24,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude10")})),T.Wb(25,"img",117),T.ac(),T.bc(26,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude2a")})),T.Wb(27,"img",118),T.ac(),T.bc(28,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude0e")})),T.Wb(29,"img",119),T.ac(),T.bc(30,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude32")})),T.Wb(31,"img",120),T.ac(),T.bc(32,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude13")})),T.Wb(33,"img",121),T.ac(),T.bc(34,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude29")})),T.Wb(35,"img",122),T.ac(),T.bc(36,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude20")})),T.Wb(37,"img",123),T.ac(),T.bc(38,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\udc4c")})),T.Wb(39,"img",124),T.ac(),T.bc(40,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\udc4d")})),T.Wb(41,"img",125),T.ac(),T.bc(42,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\udc4e")})),T.Wb(43,"img",126),T.ac(),T.bc(44,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\udc4f")})),T.Wb(45,"img",127),T.ac(),T.bc(46,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude4c")})),T.Wb(47,"img",128),T.ac(),T.bc(48,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude4f")})),T.Wb(49,"img",129),T.ac(),T.bc(50,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\udc40")})),T.Wb(51,"img",130),T.ac(),T.bc(52,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\u2620\ufe0f")})),T.Wb(53,"img",131),T.ac(),T.bc(54,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude48")})),T.Wb(55,"img",132),T.ac(),T.bc(56,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude49")})),T.Wb(57,"img",133),T.ac(),T.bc(58,"a",93),T.jc("click",(function(t){return T.Mc(c),T.nc().addEmoji("\ud83d\ude4a")})),T.Wb(59,"img",134),T.ac(),T.ac(),T.ac(),T.ac(),T.ac()}}function We(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(5).selectHashtag(i.resp)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.Xc(" ",i.hashtag," ")}}function Le(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,We,2,1,"a",61),T.ac()),2&t){var c=T.nc(4);T.Gb(1),T.uc("ngForOf",c.responses)}}function Ae(t,e){1&t&&(T.bc(0,"span",148),T.Vc(1," No tenes ning\xfana respuesta r\xe1pida configurada "),T.ac())}function Be(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,Le,2,1,"span",7),T.Tc(2,Ae,2,0,"span",147),T.ac()),2&t){var c=T.nc(3);T.Gb(1),T.uc("ngIf",0!=c.getLenght(c.responses)),T.Gb(1),T.uc("ngIf",0==c.getLenght(c.responses))}}function De(t,e){if(1&t&&(T.bc(0,"div",49),T.Tc(1,Be,3,2,"span",7),T.ac()),2&t){var c=T.nc(2);T.Gb(1),T.uc("ngIf",c.responses)}}function ze(t,e){if(1&t){var c=T.cc();T.bc(0,"button",149),T.jc("click",(function(t){return T.Mc(c),T.nc(),T.Jc(14).clear(t)})),T.bc(1,"mat-icon"),T.Vc(2,"clear"),T.ac(),T.ac()}}function Ye(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){return T.Mc(c),T.nc(2).setStatus("Pendiente")})),T.Vc(1," Pendiente "),T.ac()}}function Ne(t,e){if(1&t){var c=T.cc();T.bc(0,"a",51),T.jc("click",(function(t){return T.Mc(c),T.nc(2).checkWorkTime("Finalizado")})),T.Vc(1," Finalizado "),T.ac()}}function Ue(t,e){if(1&t){var c=T.cc();T.bc(0,"span"),T.bc(1,"button",135),T.Wb(2,"i",136),T.ac(),T.bc(3,"input",137),T.jc("ngModelChange",(function(t){return T.Mc(c),T.nc().isPrivate=t})),T.ac(),T.bc(4,"span",138),T.Vc(5,"Privado"),T.ac(),T.bc(6,"span"),T.Vc(7,"|"),T.ac(),T.bc(8,"div",139),T.bc(9,"button",140),T.Wb(10,"i",141),T.ac(),T.Tc(11,De,2,1,"div",142),T.ac(),T.bc(12,"mat-form-field"),T.bc(13,"ngx-mat-file-input",143,144),T.jc("ngModelChange",(function(t){return T.Mc(c),T.nc().files=t})),T.ac(),T.Tc(15,ze,3,0,"button",145),T.ac(),T.bc(16,"div",59),T.bc(17,"button",146),T.Vc(18),T.ac(),T.bc(19,"div",49),T.Tc(20,Ye,2,0,"a",50),T.Tc(21,Ne,2,0,"a",50),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.Jc(14),n=T.nc();T.Gb(1),T.uc("disabled",n.identity.company._id!=n.ticket.company._id||"Cerrado"==n.ticket.status),T.Gb(2),T.uc("disabled",n.identity.company._id!=n.ticket.company._id)("ngModel",n.isPrivate),T.Gb(8),T.uc("ngIf",n.identity.company._id==n.ticket.company._id),T.Gb(2),T.uc("ngModel",n.files),T.Gb(2),T.uc("ngIf",!i.empty),T.Gb(2),T.uc("ngClass",n.calculateClasses())("disabled",n.identity.company._id!=n.ticket.company._id||"Cerrado"==n.ticket.status&&"ROLE_REQUESTER"==n.identity.role),T.Gb(1),T.Xc(" ",n.ticket.status," "),T.Gb(2),T.uc("ngIf","Pendiente"!=n.ticket.status),T.Gb(1),T.uc("ngIf","Finalizado"!=n.ticket.status)}}function $e(t,e){if(1&t){var c=T.cc();T.bc(0,"button",149),T.jc("click",(function(t){return T.Mc(c),T.nc(),T.Jc(3).clear(t)})),T.bc(1,"mat-icon"),T.Vc(2,"clear"),T.ac(),T.ac()}}function He(t,e){if(1&t){var c=T.cc();T.bc(0,"button",152),T.jc("click",(function(t){return T.Mc(c),T.nc(2).cancelFinish()})),T.Wb(1,"i",153),T.ac()}}function Qe(t,e){if(1&t){var c=T.cc();T.bc(0,"span"),T.bc(1,"mat-form-field"),T.bc(2,"ngx-mat-file-input",143,144),T.jc("ngModelChange",(function(t){return T.Mc(c),T.nc().files=t})),T.ac(),T.Tc(4,$e,3,0,"button",145),T.ac(),T.bc(5,"button",135),T.Wb(6,"i",136),T.ac(),T.Tc(7,He,2,0,"button",150),T.bc(8,"div",59),T.bc(9,"button",151),T.Vc(10),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.Jc(3),n=T.nc();T.Gb(2),T.uc("ngModel",n.files),T.Gb(2),T.uc("ngIf",!i.empty),T.Gb(1),T.uc("disabled","Cerrado"==n.ticket.status),T.Gb(2),T.uc("ngIf","Finalizado"==n.ticket.status&&n.identity._id==n.ticket.requester._id),T.Gb(3),T.Xc(" ",n.ticket.status," ")}}var Xe,Je=function(t){return["/user/profile",t]},Ke=function(t){return{privatechattext:t}},Ze=((Xe=function(){function t(e,c,i,n,a,s,r,o,u,l,d,p,f,h,b,m,g){_classCallCheck(this,t),this.dialog=e,this._route=c,this._router=i,this.confirmService=n,this.loader=a,this.snackBar=s,this._userService=r,this._ticketService=o,this._teamService=u,this._textblockService=l,this._uploadService=d,this._responseService=p,this._companyService=f,this._notificationService=h,this._depositService=b,this._stockService=m,this._movimService=g,this.stocks=[],this.allStocks=[],this.stockFilter="",this.movimsTicket=[],this.imagesToUpload=new Array,this.identity=this._userService.getIdentity(),this.token=this._userService.getToken(),this.url=x.a.url,this.editSub=!1,this.subMod="",this.isPrivate=!1,this.space=" ",this.ccList=[],this.allCcList=[],this.ccFilter="",this.isCc=!1,this.stat="",this.info="true",this.ticket=new X("","",null,"","","","","","","",null,"",[""],"","","",[""],null,null,""),this.textblock=new J("","",this.identity._id,"","","",[""],!1),this.emojis=!1,this.config=x.a.richTextModule}return _createClass(t,[{key:"ngOnInit",value:function(){this.getTicket(),this.getHashtags(),this.getCompanies(),this.checkInfo(),this.getCc(),this.getDeposits()}},{key:"getDeposits",value:function(){var t=this;this._depositService.getList(this.token,{company:this.identity.company._id}).subscribe((function(e){e.deposits&&(t.deposits=e.deposits,t.deposit=t.deposits[0],t.getStock(t.deposits[0]))}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getStock",value:function(t){var e=this,c={deposit:t._id};this.stockFilter="",this.stocks=[],this._stockService.getList(this.token,c).subscribe((function(t){t.stocks&&(e.allStocks=t.stocks,console.log(e.allStocks))}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"filterStock",value:function(){var t=this;this.stocks=this.allStocks.filter((function(e){return(e.item.name+e.item.brand).toLowerCase().includes(t.stockFilter.toString().toLowerCase())}))}},{key:"getMovims",value:function(t){var e=this;this._movimService.getList(this.token,{ticket:t._id}).subscribe((function(t){t.movims&&(e.movimsTicket=t.movims)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"setStock",value:function(t){var e=this;if(0==t.cant)return this.openSnackBar("No hay insumo en stock para descontar","Cerrar");this.confirmService.confirm({message:"\xbfDescontar "+t.item.name+" "+t.item.brand+" del dep\xf3sito "+t.deposit.name+"?"}).subscribe((function(c){var i;c&&(i={$inc:{cant:-1}},e._stockService.edit(e.token,t._id,i).subscribe((function(c){c.stock&&e.saveMovim(t)}),(function(t){e.openSnackBar(t.message,"Cerrar")})))}))}},{key:"saveMovim",value:function(t){var e=this,c=new ut.a("",null,"Egreso",t.deposit._id,t.item._id,this.ticket.company._id,1,this.identity._id,null,new Date,new Date,null,this.ticket.requester._id,this.ticket._id,null,"");this.ticket.requester.sector&&(c.sector=this.ticket.requester.sector._id),this._movimService.add(this.token,c).subscribe((function(c){c.movim&&(e.openSnackBar("Movimiento realizado correctamente","Cerrar"),e.newInfo(e.identity.name+" "+e.identity.surname+" agreg\xf3 un/a "+t.item.name+" como insumo en este ticket."),t.cant=t.cant-1,e.getMovims(e.ticket))}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"checkInfo",value:function(){this.info=0!=this.identity.infoView?"true":"false"}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"getCc",value:function(){var t=this;this._userService.getList(this.token).subscribe((function(e){e.users&&(t.allCcList=e.users)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"changeInfo",value:function(){this.info="false"==this.info?"true":"false",this.getChat()}},{key:"getPrevNext",value:function(t,e){var c=this;this._ticketService.getPrevNext(this.token,this.identity._id,t,e,this.identity.role).subscribe((function(t){c.next=t.nextTicket,c.prev=t.prevTicket}),(function(t){c.openSnackBar(t.message,"Cerrar")}))}},{key:"filterCc",value:function(){var t=this;this.ccList=this.allCcList.filter((function(e){return(e.name+e.surname).toLowerCase().includes(t.ccFilter.toString().toLowerCase())}))}},{key:"setCc",value:function(t){var e=this;this._ticketService.addCc(this.token,this.ticket._id,t._id).subscribe((function(c){c.ticket?(e.newInfo(e.identity.name+" "+e.identity.surname+" puso en copia a "+t.name+" "+t.surname+" en este ticket"),e.getTicket()):e._router.navigate(["/"])}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"deleteCc",value:function(t){var e=this;this._ticketService.removecc(this.token,this.ticket._id,t._id).subscribe((function(c){c.ticket&&(e.newInfo(e.identity.name+" "+e.identity.surname+" elmin\xf3 a "+t.name+" "+t.surname+" de los usuarios en copia"),e.getTicket())}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getLenght",value:function(t){return t.length}},{key:"deleteMessage",value:function(){this.openSnackBar("El mensaje fue eliminado correctamente.","Cerrar")}},{key:"errorMessage",value:function(){this.openSnackBar("No puede eliminar un mensaje con m\xe1s de dos horas de realizado","Cerrar")}},{key:"getTeams",value:function(t){var e=this;this._teamService.getList(this.token,t).subscribe((function(t){t.teams?e.teams=t.teams:e._router.navigate(["/"])}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getCompanies",value:function(){var t=this;this._companyService.getList(this.token).subscribe((function(e){e.companies?t.companies=e.companies:t._router.navigate(["/"])}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getReqTickets",value:function(t){var e=this;t&&this._ticketService.getForUser(this.token,t._id).subscribe((function(t){t.tickets?e.reqTickets=t.tickets:e._router.navigate(["/"])}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getChat",value:function(){var t=this;this._route.params.forEach((function(e){t._textblockService.getForTicket(t.token,e.id,t.identity.role).subscribe((function(e){e.textblocks&&(t.chat=e.textblocks,"ROLE_REQUESTER"!=t.identity.role?t.ticket.agent&&t.identity._id==t.ticket.agent._id&&t._textblockService.readAgent(t.token,t.ticket._id).subscribe((function(t){t.textblock||console.error("Error en textblock")}),(function(e){t.openSnackBar(e.message,"Cerrar")})):t.identity._id==t.ticket.requester._id&&t._textblockService.readRequester(t.token,t.ticket._id).subscribe((function(t){}),(function(e){t.openSnackBar(e.message,"Cerrar")})),t.ticket.agent&&t.ticket.agent._id&&("ROLE_REQUESTER"!=t.identity.role&&t.identity._id==t.ticket.agent._id?t._textblockService.readAgent(t.token,t.ticket._id).subscribe((function(t){}),(function(e){t.openSnackBar(e.message,"Cerrar")})):"ROLE_REQUESTER"==t.identity.role&&t.identity._id==t.ticket.requester._id&&t._textblockService.readRequester(t.token,t.ticket._id).subscribe((function(t){}),(function(t){console.error(t)}))))}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}))}},{key:"getHashtags",value:function(){var t=this;this._responseService.getList(this.token,this.identity._id).subscribe((function(e){e.responses&&(t.responses=e.responses)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getTicket",value:function(){var t=this;this._route.params.forEach((function(e){t._ticketService.getOne(t.token,e.id).subscribe((function(e){t.ticket=e.ticket,setTimeout((function(){t.getChat()}),1e3),t.getPrevNext(e.ticket.numTicket,e.ticket.status),t.getTeams(e.ticket.company._id),e.ticket.team&&(t.agents=e.ticket.team.users),t.ticket.cc&&-1!=t.ticket.cc.map((function(t){return t._id})).indexOf(t.identity._id)&&(t.isCc=!0),t.getMovims(e.ticket)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}))}},{key:"selectHashtag",value:function(t){this.textblock.text=this.textblock.text+t,document.getElementById("editable").innerHTML=document.getElementById("editable").innerHTML+t}},{key:"selectAgent",value:function(t,e,c){"Pendiente"!=this.ticket.status?(this.ticket.agent=t,this.ticket.status="Pendiente",this.editTicket(),this.newInfo(this.identity._id==t?this.identity.name+" "+this.identity.surname+" se asign\xf3 como agente de esta solicitud":this.identity.name+" "+this.identity.surname+" asign\xf3 a "+e+" "+c+" como agente de esta solicitud")):(this.ticket.agent=t,this.editTicket(),this.newInfo(this.identity._id==t?this.identity.name+" "+this.identity.surname+" se asign\xf3 como agente de esta solicitud":this.identity.name+" "+this.identity.surname+" asign\xf3 a "+e+" "+c+" como agente de esta solicitud"))}},{key:"selectTeam",value:function(t,e){this.ticket.team=t,this.ticket.agent=null,this.ticket.status="Pendiente",this.editTicket(),this.newInfo(this.identity.name+" "+this.identity.surname+" asign\xf3 a "+e+" como equipo de esta solicitud"),this.newInfo(this.identity.name+" "+this.identity.surname+" ha cambiado el estado de la solicitud a pendiente")}},{key:"cancelFinish",value:function(){var t=this.textblock.text;""!=t&&(t=t.split("<span _ngco")[0]),""!=t?(this.newInfo(this.identity.name+" "+this.identity.surname+" ha reabierto el ticket"),this.createMessageNotification(this.ticket.agent._id,"#"+this.ticket.numTicket+" - "+this.identity.name+" "+this.identity.surname+" reabri\xf3 el ticket"),this.onSubmit(),this.ticket.status="Pendiente",this.editTicket()):this.openSnackBar("Escribe un mensaje antes de enviarlo","Cerrar")}},{key:"selectCompany",value:function(t,e){"Abierto"!=this.ticket.status?(this.ticket.company=t,this.ticket.team=null,this.ticket.agent=null,this.agents=null,this.ticket.status="Abierto",this.ticket.resolveDate=null,this.editTicket(),this.getTeams(t),this.newInfo(this.identity.name+" "+this.identity.surname+" asign\xf3 a "+e+" como departamento responsable de esta solicitud"),this.newInfo(this.identity.name+" "+this.identity.surname+" ha cambiado el estado de la solicitud a abierto")):(this.ticket.company=t,this.ticket.team=null,this.agents=null,this.ticket.agent=null,this.editTicket(),this.newInfo(this.identity.name+" "+this.identity.surname+" asign\xf3 a "+e+" como departamento responsable de esta solicitud"))}},{key:"selectResolveDate",value:function(){if(k(this.ticket.resolveDate).isSameOrAfter(k().format("YYYY-MM-DD"))){var t=this.ticket.resolveDate.split("-");this.ticket.resolveDate=t[2]+"-"+t[1]+"-"+t[0],this.editTicket(),this.newInfo(this.identity.name+" "+this.identity.surname+" ha actualizado la fecha estimada de soluci\xf3n a "+this.ticket.resolveDate)}else this.openSnackBar("No puede seleccionar una fecha anterior a la actual","Cerrar"),this.ticket.resolveDate=""}},{key:"calculateClasses",value:function(){var t={};switch(this.ticket.status){case"Pendiente":t={pending:!0};break;case"Abierto":t={open:!0};break;case"Cerrado":t={closer:!0};break;case"Finalizado":t={finish:!0}}return t.btn=!0,t["btn-dark"]=!0,t["dropdown-toggle"]=!0,t}},{key:"subToEdit",value:function(t){"Cerrado"!=this.ticket.status&&(this.identity.company?this.identity.company._id==this.ticket.company._id&&(this.editSub=!0,this.subMod=t):this.identity._id==this.ticket.requester._id&&(this.editSub=!0,this.subMod=t))}},{key:"editTicketSub",value:function(){this.newInfo(this.identity.name+" "+this.identity.surname+" ha cambiado el asunto de la solicitud de "+this.ticket.sub+" a "+this.subMod.toUpperCase()),this.ticket.sub=this.subMod,this.editTicket(),this.editSub=!1}},{key:"checkWorkTime",value:function(t){this.ticket.workTime?(this.stat=t,$("#timework").modal("show")):this.setStatus(t)}},{key:"setStatus",value:function(t){("Cerrado"==t||"Finalizado"==t)&&this.ticket.team&&this.ticket.agent||"Pendiente"==t&&this.ticket.team||"Abierto"==t?(this.newInfo(this.identity.name+" "+this.identity.surname+" ha cambiado el estado de la solicitud de "+this.ticket.status+" a "+t),this.ticket.status=t,this.editTicket(),"Finalizado"==t&&this.createMessageNotification(this.ticket.requester._id,"#"+this.ticket.numTicket+" - "+this.identity.name+" "+this.identity.surname+" finaliz\xf3 el ticket."),$("#timework").modal("hide")):this.openSnackBar("Debe seleccionar un responsable para cambiar el ticket a ese estado","Cerrar")}},{key:"setPriority",value:function(t){this.newInfo(this.identity.name+" "+this.identity.surname+" ha cambiado la prioridad de la solicitud de "+this.ticket.priority+" a "+t),this.ticket.priority=t,this.editTicket()}},{key:"editTicket",value:function(){var t=this;this._route.params.forEach((function(e){t._ticketService.edit(t.token,e.id,t.ticket).subscribe((function(e){e.ticket&&t.getTicket()}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}))}},{key:"newInfo",value:function(t){var e,c=this;e=new J("",t,this.identity._id,"","","INFO",[""],!1),this._route.params.forEach((function(t){e.ticket=t.id})),this._textblockService.add(this.token,e).subscribe((function(t){t.textblock&&c.pushText(t.textblock._id)}),(function(t){c.openSnackBar(t.message,"Cerrar")}))}},{key:"onSubmit",value:function(){var t,e=this;""!=this.textblock.text&&(this.textblock.text=this.textblock.text.split("<span _ngco")[0]),""!=this.textblock.text?("ROLE_REQUESTER"==this.identity.role?(this.textblock.type="REQUEST",t=this.ticket.agent,delete this.ticket.agent,delete this.ticket.team):(this.textblock.read=!0,this.textblock.type=this.isPrivate?"PRIVATE":"PUBLIC"),this._route.params.forEach((function(t){e.textblock.ticket=t.id})),this._textblockService.add(this.token,this.textblock).subscribe((function(c){if(c.textblock){var i="#"+e.ticket.numTicket+" - Nuevo mensaje";if("ROLE_REQUESTER"==e.identity.role)t&&e.createMessageNotification(t._id,i);else{var n=e.ticket.requester._id;e.createMessageNotification(n,i),e.ticket.cc&&e.ticket.cc.forEach((function(t){n=t._id,e.createMessageNotification(n,i)}))}null!=e.files&&null!=e.files&&(e._uploadService.makeFileRequest(e.url+"textblock/file/"+c.textblock._id,[],e.files.files,e.token,"file"),e.files=null)}var a,s;if("PRIVATE"!=e.textblock.type&&1==e.ticket.company.mailSender&&("ROLE_REQUESTER"!=e.identity.role?1==e.ticket.requester.receiveMail&&(a=e.ticket.requester.name+" "+e.ticket.requester.surname,s=e.ticket.requester.email):e.ticket.agent&&1==e.ticket.agent.receiveMail&&(a=e.ticket.agent.name+" "+e.ticket.agent.surname,s=e.ticket.agent.email),a)){var r=window.location.href,o=e.identity.name+" "+e.identity.surname,u=void 0;e.ticket.cc&&(u=e.ticket.cc.map((function(t){return t.email}))),e._ticketService.sendMail(e.token,o,e.ticket,c.textblock.text,a,s,r,u).subscribe((function(t){}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}e.editTicket(),e.pushText(c.textblock._id),e.textblock=new J("","",e.identity._id,"","","",[""],!1),document.getElementById("editable").innerHTML=""}),(function(t){e.openSnackBar(t,"Cerrar")}))):this.openSnackBar("Escriba un mensaje antes de enviarlo","Cerrar")}},{key:"showEmojis",value:function(){this.emojis=!this.emojis}},{key:"addEmoji",value:function(t){this.textblock.text=this.textblock.text+t,document.getElementById("editable").innerHTML=document.getElementById("editable").innerHTML+t}},{key:"pushText",value:function(t){var e=this;this._textblockService.getOne(this.token,t).subscribe((function(t){t.textblock&&e.chat.push(t.textblock)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"createMessageNotification",value:function(t,e){var c=this,i=k().format("YYYY-MM-DD HH:mm"),n=new nt.a("",e,"chat",i,i,"ticket/gestion/"+this.ticket._id,"primary",t,null,null);this._notificationService.add(this.token,n).subscribe((function(t){}),(function(t){c.openSnackBar("No pudo enviarse una notificaci\xf3n por sistema al usuario","Cerrar")}))}},{key:"changeDate",value:function(t){return k(t,"YYYY-MM-DD HH:mm").format("DD-MM-YYYY HH:mm")}},{key:"outOfLimit",value:function(){return 100*this.ticket.realWorkTime/this.ticket.workTime>=150}},{key:"pastePicture",value:function(t){return e=this,i=regeneratorRuntime.mark((function e(){var c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=0!=t.clipboardData.files.length,!e.t0){e.next=8;break}return this.imagesToUpload=new Array,this.imagesToUpload.push(t.clipboardData.files.item(0)),e.next=6,this._uploadService.makeFileRequest(this.url+"textblock/image",[],this.imagesToUpload,this.token,"image").then((function(t){document.getElementById("editable").innerHTML+='<a target="_blank" href="'+c.url+"textblock/image/"+t.filename+'"><img src="'+c.url+"textblock/image/"+t.filename+'" class="img-fluid" style="width: 80%; margin: 5px" alt="Responsive image"></a>'}));case 6:this.textblock.text=document.getElementById("editable").innerHTML,this.imagesToUpload=new Array;case 8:case"end":return e.stop()}}),e,this)})),new((c=void 0)||(c=Promise))((function(t,n){function a(t){try{r(i.next(t))}catch(e){n(e)}}function s(t){try{r(i.throw(t))}catch(e){n(e)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof c?i:new c((function(t){t(i)}))).then(a,s)}r((i=i.apply(e,[])).next())}));var e,c,i}}]),t}()).\u0275fac=function(t){return new(t||Xe)(T.Vb(f.b),T.Vb(n.a),T.Vb(n.g),T.Vb(m.a),T.Vb(g.a),T.Vb(w.a),T.Vb(v.a),T.Vb(y.a),T.Vb(K.a),T.Vb(tt),T.Vb(et.a),T.Vb(ct.a),T.Vb(it.a),T.Vb(at.a),T.Vb(ot.a),T.Vb(rt.a),T.Vb(st.a))},Xe.\u0275cmp=T.Pb({type:Xe,selectors:[["app-ticket-gestion"]],features:[T.Fb([v.a,y.a,at.a,K.a,tt,et.a,ct.a,it.a,st.a,rt.a,ot.a])],decls:149,vars:54,consts:[["id","ticket",1,"row"],["id","ticket-dates",1,"col-md-5","col-lg-5","col-xl-4","text-break"],[1,"card",2,"height","100%"],[3,"expanded"],[1,"accordion-text"],[1,"list-group","p-0","m-0"],[1,"list-group-item"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"list-group",3,"routerLink"],[1,"row"],[1,"col-xl-3"],["class","rounded-circle mr-2","width","50","height","50","src","assets/images/system/user-placeholder.png",4,"ngIf"],["class","rounded-circle mr-2","width","50","height","50",3,"src",4,"ngIf"],["class","col-xl-8 align-self-center",4,"ngIf"],[1,"list-group"],[2,"font-size","18px"],[2,"margin-bottom","25px"],["class","rounded-circle img-agent-team","src","assets/images/system/company-placeholder.png",4,"ngIf"],["class","rounded-circle img-agent-team",3,"src",4,"ngIf"],["class","d-inline","style","margin-left: 10px;",4,"ngIf"],["class","rounded-circle img-agent-team","src","assets/images/system/team-placeholder.png",4,"ngIf"],["class","rounded-circle img-agent-team","src","assets/images/system/user-placeholder.png",4,"ngIf"],["class","list-group-item text-center",4,"ngIf"],[1,"col-md-6","col-lg-7","col-xl-8"],[1,"container","text-center"],["type","text","name","sub",3,"ngModel","ngModelChange",4,"ngIf"],["style","margin-left: 3px;","type","button","class","btn btn-dark dark","value","Aceptar",3,"click",4,"ngIf"],["style","margin-left: 3px;","type","button","class","btn btn-danger","value","Cancelar",3,"click",4,"ngIf"],["class","d-inline",3,"click",4,"ngIf"],["class","float-left",3,"routerLink",4,"ngIf"],[1,"float-left",3,"click"],["class","fa fa-info-circle enabled","style","margin-left: 8px;",4,"ngIf"],["class","fa fa-info-circle disabled","style","margin-left: 8px;",4,"ngIf"],["class","float-right",3,"routerLink",4,"ngIf"],["id","chatbox-scroll",1,"col","chatbox-scroll"],[3,"_id","text","sign","type","user","userId","date","files","info","deleteMessage","refresh","errorMessage",4,"ngFor","ngForOf"],["class","row","style","margin-top: 10px;",4,"ngIf"],[1,"row",2,"margin-top","10px"],["id","chat-text",1,"col",3,"ngClass"],[3,"ngSubmit"],["form","ngForm"],[1,"container",2,"border","1px solid #4e5257"],[1,"p-0"],["theme","snow","placeholder","Escribe aqui tu mensaje","name","autoDesc",3,"modules","ngModel","ngModelChange"],["id","options-container",1,"container"],["class","dropdown d-inline",4,"ngIf"],[1,"dropdown","d-inline"],["data-toggle","dropdown","aria-expanded","false","type","button",1,"btn","btn-dark","dropdown-toggle","dark",2,"margin-right","15px"],["role","menu",1,"dropdown-menu"],["role","presentation","class","dropdown-item",3,"click",4,"ngIf"],["role","presentation",1,"dropdown-item",3,"click"],["width","50","height","50","src","assets/images/system/user-placeholder.png",1,"rounded-circle","mr-2"],["width","50","height","50",1,"rounded-circle","mr-2",3,"src"],[1,"col-xl-8","align-self-center"],[1,"col"],["class","row",4,"ngIf"],["aria-hidden","true",1,"fa","fa-phone"],["class","dropdown d-inline float-right",4,"ngIf"],[1,"dropdown","d-inline","float-right"],["data-toggle","dropdown","aria-expanded","false","type","button",1,"btn","btn-dark","dropdown-toggle","dark"],["role","presentation","class","dropdown-item",3,"click",4,"ngFor","ngForOf"],["src","assets/images/system/company-placeholder.png",1,"rounded-circle","img-agent-team"],[1,"rounded-circle","img-agent-team",3,"src"],[1,"d-inline",2,"margin-left","10px"],["src","assets/images/system/team-placeholder.png",1,"rounded-circle","img-agent-team"],["class","dropup d-inline float-right",4,"ngIf"],[1,"dropup","d-inline","float-right"],["src","assets/images/system/user-placeholder.png",1,"rounded-circle","img-agent-team"],["style","margin-top: 10px;",4,"ngIf"],[2,"margin-top","10px"],["type","date","name","resolveDate",2,"margin-right","5px",3,"ngModel","ngModelChange","change"],["resolveDate","ngModel"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item","text-center"],[1,"full-width"],[3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],["type","text","placeholder","Buscar insumo","aria-label","Text","matInput","",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoStock","matAutocomplete"],[3,"matTooltip","click",4,"ngFor","ngForOf"],[3,"value","click"],[3,"matTooltip","click"],["class","rounded-circle mr-2","width","30","height","30",3,"src",4,"ngIf"],["class","rounded-circle mr-2","width","30","height","30","src","assets/images/system/user-placeholder.png",4,"ngIf"],["class","btn btn-danger float-right","type","button",3,"click",4,"ngIf"],["width","30","height","30",1,"rounded-circle","mr-2",3,"src"],["width","30","height","30","src","assets/images/system/user-placeholder.png",1,"rounded-circle","mr-2"],["type","button",1,"btn","btn-danger","float-right",3,"click"],[1,"fa","fa-trash"],["type","text","placeholder","Buscar persona","aria-label","Text","matInput","",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoCC","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["type","text","name","sub",3,"ngModel","ngModelChange"],["type","button","value","Aceptar",1,"btn","btn-dark","dark",2,"margin-left","3px",3,"click"],["type","button","value","Cancelar",1,"btn","btn-danger",2,"margin-left","3px",3,"click"],[1,"d-inline",3,"click"],[1,"float-left",3,"routerLink"],[1,"fa","fa-arrow-circle-left","adjunt",2,"margin-left","6px"],[1,"fa","fa-info-circle","enabled",2,"margin-left","8px"],[1,"fa","fa-info-circle","disabled",2,"margin-left","8px"],[1,"float-right",3,"routerLink"],[1,"fa","fa-arrow-circle-right","adjunt",2,"margin-left","6px"],[3,"_id","text","sign","type","user","userId","date","files","info","deleteMessage","refresh","errorMessage"],["id","chat-text",1,"col"],[1,"container"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/smiling-face-with-open-mouth_1f603.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/smiling-face-with-open-mouth-and-smiling-eyes_1f604.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/grinning-face-with-smiling-eyes_1f601.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/smiling-face-with-open-mouth-and-tightly-closed-eyes_1f606.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/smiling-face-with-open-mouth-and-cold-sweat_1f605.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/face-with-tears-of-joy_1f602.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/winking-face_1f609.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/smiling-face-with-smiling-eyes_1f60a.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/face-with-stuck-out-tongue-and-winking-eye_1f61c.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/face-with-stuck-out-tongue-and-tightly-closed-eyes_1f61d.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/neutral-face_1f610.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/sleepy-face_1f62a.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/smiling-face-with-sunglasses_1f60e.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/astonished-face_1f632.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/face-with-cold-sweat_1f613.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/weary-face_1f629.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/angry-face_1f620.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/ok-hand-sign_1f44c.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/thumbs-up-sign_1f44d.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/thumbs-down-sign_1f44e.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/clapping-hands-sign_1f44f.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/person-raising-both-hands-in-celebration_1f64c.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/person-with-folded-hands_1f64f.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/eyes_1f440.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/skull-and-crossbones_2620.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/see-no-evil-monkey_1f648.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/hear-no-evil-monkey_1f649.png","width","30px",2,"margin-right","3px"],["src","https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/72/whatsapp/238/speak-no-evil-monkey_1f64a.png","width","30px",2,"margin-right","3px"],["type","submit",1,"btn","btn-primary","float-right",3,"disabled"],[1,"fa","fa-paper-plane"],["type","checkbox","name","isPrivate",3,"disabled","ngModel","ngModelChange"],[2,"margin-left","5px","margin-right","5px"],["id","hashtag",1,"dropdown","d-inline"],["data-toggle","dropdown","aria-expanded","false","type","button",1,"btn","dropdown-toggle"],[1,"fa","fa-hashtag","adjunt"],["role","menu","class","dropdown-menu",4,"ngIf"],["name","files","placeholder","Adjuntar archivos","multiple","",3,"ngModel","ngModelChange"],["removableInput",""],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["data-toggle","dropdown","aria-expanded","false","type","button",2,"margin-right","15px",3,"ngClass","disabled"],["class","card","style","padding: 5px;border: 1px solid gray;",4,"ngIf"],[1,"card",2,"padding","5px","border","1px solid gray"],["mat-icon-button","","matSuffix","",3,"click"],["class","btn btn-danger float-right","title","Reabrir el ticket","type","button","style","margin-right: 15px;",3,"click",4,"ngIf"],["disabled","","data-toggle","dropdown","aria-expanded","false","type","button",1,"btn","btn-dark","dropdown-toggle","dark",2,"margin-right","15px"],["title","Reabrir el ticket","type","button",1,"btn","btn-danger","float-right",2,"margin-right","15px",3,"click"],[1,"fa","fa-unlock"]],template:function(t,e){1&t&&(T.bc(0,"mat-card"),T.bc(1,"div",0),T.bc(2,"div",1),T.bc(3,"div",2),T.bc(4,"mat-accordion"),T.bc(5,"mat-expansion-panel",3),T.bc(6,"mat-expansion-panel-header"),T.bc(7,"mat-panel-title"),T.bc(8,"strong",4),T.Vc(9,"Informaci\xf3n general"),T.ac(),T.ac(),T.ac(),T.bc(10,"ul",5),T.bc(11,"li",6),T.bc(12,"span"),T.Vc(13,"N\xfamero:\xa0"),T.ac(),T.bc(14,"span"),T.bc(15,"strong"),T.Vc(16),T.ac(),T.ac(),T.ac(),T.bc(17,"li",6),T.bc(18,"span"),T.Vc(19,"Creaci\xf3n:\xa0"),T.ac(),T.bc(20,"span"),T.bc(21,"strong"),T.Vc(22),T.ac(),T.ac(),T.ac(),T.bc(23,"li",6),T.bc(24,"span"),T.Vc(25,"Actualizado:\xa0"),T.ac(),T.bc(26,"span"),T.bc(27,"strong"),T.Vc(28),T.ac(),T.ac(),T.ac(),T.bc(29,"li",6),T.bc(30,"span"),T.Vc(31,"Prioridad:\xa0"),T.ac(),T.Tc(32,Pt,3,2,"span",7),T.Tc(33,Ft,3,1,"span",7),T.ac(),T.bc(34,"li",6),T.bc(35,"span"),T.Vc(36," Tipo:\xa0 "),T.ac(),T.bc(37,"span"),T.Tc(38,Rt,2,1,"strong",7),T.ac(),T.ac(),T.bc(39,"li",6),T.bc(40,"span"),T.Vc(41," Subtipo:\xa0 "),T.ac(),T.bc(42,"span"),T.Tc(43,Wt,2,1,"strong",7),T.ac(),T.ac(),T.bc(44,"li",6),T.bc(45,"span"),T.Vc(46,"Fuente:\xa0"),T.ac(),T.bc(47,"span"),T.bc(48,"strong"),T.Vc(49),T.ac(),T.ac(),T.ac(),T.bc(50,"li",6),T.bc(51,"span"),T.Vc(52,"Fecha estimada de soluci\xf3n: "),T.bc(53,"span"),T.bc(54,"strong"),T.Vc(55),T.ac(),T.ac(),T.Vc(56,"\xa0"),T.ac(),T.Tc(57,Lt,5,1,"span",8),T.ac(),T.ac(),T.ac(),T.bc(58,"mat-expansion-panel"),T.bc(59,"mat-expansion-panel-header"),T.bc(60,"mat-panel-title"),T.bc(61,"strong",4),T.Vc(62,"Solicitante"),T.ac(),T.ac(),T.ac(),T.bc(63,"ul",9),T.bc(64,"li",6),T.bc(65,"div",10),T.bc(66,"div",11),T.Tc(67,At,1,0,"img",12),T.Tc(68,Bt,1,1,"img",13),T.ac(),T.Tc(69,Yt,8,3,"div",14),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(70,"mat-expansion-panel"),T.bc(71,"mat-expansion-panel-header"),T.bc(72,"mat-panel-title"),T.bc(73,"strong",4),T.Vc(74,"Responsabilidad"),T.ac(),T.ac(),T.ac(),T.bc(75,"ul",15),T.bc(76,"li",6),T.bc(77,"span",16),T.bc(78,"strong"),T.Vc(79,"Departamento"),T.ac(),T.ac(),T.Tc(80,$t,2,1,"span",7),T.Wb(81,"div",17),T.Tc(82,Ht,1,0,"img",18),T.Tc(83,Qt,1,1,"img",19),T.Tc(84,Xt,3,0,"p",20),T.Tc(85,Jt,3,1,"p",20),T.Wb(86,"hr"),T.bc(87,"span",16),T.bc(88,"strong"),T.Vc(89,"Equipo"),T.ac(),T.ac(),T.Tc(90,te,2,1,"span",7),T.Wb(91,"div",17),T.Tc(92,ee,1,0,"img",21),T.Tc(93,ce,1,1,"img",19),T.Tc(94,ie,3,0,"p",20),T.Tc(95,ne,3,1,"p",20),T.Wb(96,"hr"),T.bc(97,"span",16),T.bc(98,"strong"),T.Vc(99,"Agente"),T.ac(),T.ac(),T.Tc(100,re,2,1,"span",7),T.Wb(101,"div",17),T.Tc(102,oe,1,0,"img",22),T.Tc(103,ue,1,1,"img",19),T.Tc(104,le,3,1,"p",20),T.Tc(105,de,3,0,"p",20),T.Tc(106,fe,2,1,"span",7),T.ac(),T.ac(),T.ac(),T.bc(107,"mat-expansion-panel"),T.bc(108,"mat-expansion-panel-header"),T.bc(109,"mat-panel-title"),T.bc(110,"strong",4),T.Vc(111,"Insumos"),T.ac(),T.ac(),T.ac(),T.bc(112,"ul",15),T.Tc(113,me,2,1,"span",7),T.Tc(114,ve,11,5,"li",23),T.ac(),T.ac(),T.bc(115,"mat-expansion-panel"),T.bc(116,"mat-expansion-panel-header"),T.bc(117,"mat-panel-title"),T.bc(118,"strong",4),T.Vc(119,"En copia"),T.ac(),T.ac(),T.ac(),T.bc(120,"ul",15),T.Tc(121,Te,2,1,"span",7),T.Tc(122,Me,6,3,"li",23),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(123,"div",24),T.bc(124,"div",25),T.Tc(125,Se,1,1,"input",26),T.Tc(126,Ie,1,0,"input",27),T.Tc(127,Ge,1,0,"input",28),T.Tc(128,Oe,3,1,"h6",29),T.Tc(129,Ve,2,3,"a",30),T.bc(130,"a",31),T.jc("click",(function(t){return e.changeInfo()})),T.Tc(131,je,1,0,"i",32),T.Tc(132,qe,1,0,"i",33),T.ac(),T.Tc(133,Pe,2,3,"a",34),T.ac(),T.bc(134,"div",10),T.bc(135,"div",35),T.Tc(136,Fe,1,9,"app-chatbox",36),T.ac(),T.Wb(137,"span"),T.ac(),T.Tc(138,Re,60,0,"div",37),T.bc(139,"div",38),T.bc(140,"div",39),T.bc(141,"form",40,41),T.jc("ngSubmit",(function(t){return e.onSubmit()})),T.bc(143,"div",42),T.bc(144,"mat-card-content",43),T.bc(145,"quill-editor",44),T.jc("ngModelChange",(function(t){return e.textblock.text=t})),T.ac(),T.ac(),T.ac(),T.bc(146,"div",45),T.Tc(147,Ue,22,11,"span",7),T.Tc(148,Qe,11,5,"span",7),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.ac(),T.ac()),2&t&&(T.Gb(5),T.uc("expanded",!0),T.Gb(11),T.Xc("#",e.ticket.numTicket,""),T.Gb(6),T.Wc(e.changeDate(e.ticket.createDate)),T.Gb(6),T.Wc(e.changeDate(e.ticket.lastActivity)),T.Gb(4),T.uc("ngIf",e.identity.company),T.Gb(1),T.uc("ngIf",!e.identity.company),T.Gb(5),T.uc("ngIf",e.ticket.subTypeTicket),T.Gb(5),T.uc("ngIf",e.ticket.subTypeTicket),T.Gb(6),T.Wc(e.ticket.source),T.Gb(6),T.Wc(e.ticket.resolveDate),T.Gb(2),T.uc("ngForOf",e.ticket.tags),T.Gb(6),T.uc("routerLink",T.Ac(50,Je,e.ticket.requester._id)),T.Gb(4),T.uc("ngIf","null"==e.ticket.requester.image),T.Gb(1),T.uc("ngIf","null"!=e.ticket.requester.image),T.Gb(1),T.uc("ngIf",e.ticket.requester),T.Gb(11),T.uc("ngIf",e.identity.company),T.Gb(2),T.uc("ngIf",!e.ticket.company||"null"==e.ticket.company.image),T.Gb(1),T.uc("ngIf",e.ticket.company&&"null"!=e.ticket.company.image),T.Gb(1),T.uc("ngIf",!e.ticket.company),T.Gb(1),T.uc("ngIf",e.ticket.company),T.Gb(5),T.uc("ngIf",e.identity.company),T.Gb(2),T.uc("ngIf",!e.ticket.team||"null"==e.ticket.team.image),T.Gb(1),T.uc("ngIf",e.ticket.team&&"null"!=e.ticket.team.image),T.Gb(1),T.uc("ngIf",!e.ticket.team),T.Gb(1),T.uc("ngIf",e.ticket.team),T.Gb(5),T.uc("ngIf",e.identity.company),T.Gb(2),T.uc("ngIf",!e.ticket.agent||"null"==e.ticket.agent.image),T.Gb(1),T.uc("ngIf",e.ticket.agent&&"null"!=e.ticket.agent.image),T.Gb(1),T.uc("ngIf",e.ticket.agent),T.Gb(1),T.uc("ngIf",!e.ticket.agent),T.Gb(1),T.uc("ngIf",e.identity.company),T.Gb(7),T.uc("ngIf",e.movimsTicket&&0!=e.getLenght(e.movimsTicket)),T.Gb(1),T.uc("ngIf","ROLE_REQUESTER"!=e.identity.role&&e.identity.company._id==e.ticket.company._id&&"Cerrado"!=e.ticket.status),T.Gb(7),T.uc("ngIf",e.ticket.cc&&0!=e.getLenght(e.ticket.cc)),T.Gb(1),T.uc("ngIf","Cerrado"!=e.ticket.status),T.Gb(3),T.uc("ngIf",e.editSub),T.Gb(1),T.uc("ngIf",e.editSub),T.Gb(1),T.uc("ngIf",e.editSub),T.Gb(1),T.uc("ngIf",!e.editSub),T.Gb(1),T.uc("ngIf",("ROLE_REQUESTER"==e.identity.role||e.ticket.agent)&&e.prev),T.Gb(2),T.uc("ngIf","true"==e.info),T.Gb(1),T.uc("ngIf","false"==e.info),T.Gb(1),T.uc("ngIf",("ROLE_REQUESTER"==e.identity.role||e.ticket.agent)&&e.next),T.Gb(3),T.uc("ngForOf",e.chat),T.Gb(2),T.uc("ngIf",e.emojis),T.Gb(2),T.uc("ngClass",T.Ac(52,Ke,e.isPrivate)),T.Gb(5),T.uc("modules",e.config)("ngModel",e.textblock.text),T.Gb(2),T.uc("ngIf",e.identity.company),T.Gb(1),T.uc("ngIf",!e.identity.company))},directives:[u.a,lt.a,lt.c,lt.d,lt.e,i.m,i.l,n.h,i.k,dt.a,a.x,a.o,a.p,u.c,pt.a,a.n,a.q,a.c,p.a,p.d,S.a,s.b,ft.c,ft.a,C.p,h.a,n.j,Gt,a.a,Ot.a,o.b,p.e,r.a],styles:["#ticket-dates[_ngcontent-%COMP%]{overflow-y:auto}@media (max-width:992px){#ticket-dates[_ngcontent-%COMP%]{border-bottom:1px solid #737373}}.info-card[_ngcontent-%COMP%]{width:100%;padding-top:0}.container.title-container[_ngcontent-%COMP%]{margin-bottom:0}.title[_ngcontent-%COMP%]{width:100%}.card-body.card-req-tickets[_ngcontent-%COMP%]{height:250px;overflow-y:scroll}.chatbox-scroll[_ngcontent-%COMP%]{overflow-y:scroll;height:300px}.card.chatbox[_ngcontent-%COMP%]{max-width:80%;min-height:30%;border:1px solid #1e2833;margin:10px}.adjunt[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;color:#7979ff}.chatinfo[_ngcontent-%COMP%]{border:1px solid #1e2833;margin:10px}.chat-header[_ngcontent-%COMP%]{height:30px;display:flex;background-color:#1e2833;color:#fff}#chat-textbox[_ngcontent-%COMP%]{width:100%;min-height:100px}.container[_ngcontent-%COMP%]{padding-top:5px}.disabled[_ngcontent-%COMP%]{color:red}.disabled[_ngcontent-%COMP%], .enabled[_ngcontent-%COMP%]{cursor:pointer;font-size:20px}.enabled[_ngcontent-%COMP%]{color:green}.img-requester[_ngcontent-%COMP%]{width:50px;height:50px}.img-agent-team[_ngcontent-%COMP%]{width:30px;height:30px}.status-buble[_ngcontent-%COMP%]{color:#fff;padding:5px 10px}.pending[_ngcontent-%COMP%]{background-color:#f7813e}.finish[_ngcontent-%COMP%]{background-color:#10e00c}.closer[_ngcontent-%COMP%]{background-color:#929292}.open[_ngcontent-%COMP%]{background-color:#47b8b8}.privatechattext[_ngcontent-%COMP%]{background-color:#676767;color:#fff}li[_ngcontent-%COMP%]{padding-top:9px;padding-bottom:9px}mat-card[_ngcontent-%COMP%]{padding-left:10px}.accordion-text[_ngcontent-%COMP%]{font-size:16px}"]}),Xe),tc=c("rpG9"),ec=c("Xwq+"),cc=c("xHqg"),ic=c("bSwM");function nc(t,e){1&t&&T.Vc(0,"Solicitante")}function ac(t,e){if(1&t&&(T.bc(0,"mat-option",33),T.Vc(1),T.ac()),2&t){var c=e.$implicit;T.uc("value",c),T.Gb(1),T.Xc(" ",c.name+" "+c.surname," ")}}function sc(t,e){1&t&&T.Wb(0,"img",34)}function rc(t,e){if(1&t&&T.Wb(0,"img",35),2&t){var c=T.nc(2);T.vc("src",c.url+"user/image/"+c.requester.image,T.Oc)}}function oc(t,e){if(1&t&&(T.bc(0,"div",36),T.bc(1,"div",37),T.bc(2,"div",38),T.bc(3,"span"),T.bc(4,"strong"),T.Vc(5),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(6,"div",37),T.bc(7,"div",38),T.bc(8,"span"),T.bc(9,"em"),T.Vc(10),T.ac(),T.ac(),T.ac(),T.ac(),T.bc(11,"div",37),T.bc(12,"div",38),T.bc(13,"span"),T.bc(14,"em"),T.Vc(15),T.ac(),T.ac(),T.ac(),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(5),T.Yc("",c.requester.name," ",c.requester.surname,""),T.Gb(5),T.Wc(c.requester.email),T.Gb(5),T.Wc(c.requester.phone)}}function uc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-step",24),T.Tc(1,nc,1,0,"ng-template",5),T.bc(2,"form",11),T.bc(3,"div",7),T.bc(4,"mat-form-field",8),T.bc(5,"input",25),T.jc("input",(function(t){return T.Mc(c),T.nc().filterRequester(t.target.value)})),T.ac(),T.bc(6,"mat-autocomplete",26,27),T.jc("optionSelected",(function(t){return T.Mc(c),T.nc().setRequester(t.option.value)})),T.Tc(8,ac,2,2,"mat-option",28),T.ac(),T.ac(),T.Wb(9,"span",10),T.bc(10,"div",8),T.bc(11,"div",29),T.Tc(12,sc,1,0,"img",30),T.Tc(13,rc,1,1,"img",31),T.ac(),T.Tc(14,oc,16,4,"div",32),T.ac(),T.ac(),T.ac(),T.bc(15,"div"),T.bc(16,"button",21),T.Vc(17,"Siguiente"),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.Jc(7),n=T.nc();T.uc("stepControl",n.requesterControl),T.Gb(5),T.uc("matAutocomplete",i),T.Gb(1),T.uc("displayWith",n.displayRequester),T.Gb(2),T.uc("ngForOf",n.requesters),T.Gb(4),T.uc("ngIf",!n.requester||"null"==n.requester.image),T.Gb(1),T.uc("ngIf",n.requester&&"null"!=n.requester.image),T.Gb(1),T.uc("ngIf",n.requester&&""!=n.requester._id),T.Gb(2),T.uc("disabled",!n.requester)}}function lc(t,e){1&t&&T.Vc(0,"Tipo de ticket")}function dc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",42),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(2).setCompany(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i),T.Gb(1),T.Xc("",i.name," ")}}function pc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",42),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).setType(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i),T.Gb(1),T.Xc("",i.name," ")}}function fc(t,e){if(1&t&&(T.bc(0,"mat-form-field",8),T.bc(1,"mat-label"),T.Vc(2,"Tipo"),T.ac(),T.bc(3,"mat-select"),T.Tc(4,pc,2,2,"mat-option",40),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.uc("ngForOf",c.types)}}function hc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",42),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).setSubType(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i),T.Gb(1),T.Xc("",i.name," ")}}function bc(t,e){if(1&t&&(T.bc(0,"mat-form-field",8),T.bc(1,"mat-label"),T.Vc(2,"Sub-tipo"),T.ac(),T.bc(3,"mat-select"),T.Tc(4,hc,2,2,"mat-option",40),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.uc("ngForOf",c.subTypes)}}function mc(t,e){if(1&t&&(T.bc(0,"mat-step",39),T.Tc(1,lc,1,0,"ng-template",5),T.bc(2,"form",6),T.bc(3,"div",7),T.bc(4,"mat-form-field",8),T.bc(5,"mat-label"),T.Vc(6,"Departamento"),T.ac(),T.bc(7,"mat-select"),T.Tc(8,dc,2,2,"mat-option",40),T.ac(),T.ac(),T.ac(),T.bc(9,"div",7),T.Tc(10,fc,5,1,"mat-form-field",41),T.Wb(11,"span",10),T.Tc(12,bc,5,1,"mat-form-field",41),T.ac(),T.bc(13,"div",18),T.bc(14,"button",21),T.Vc(15,"Siguiente"),T.ac(),T.ac(),T.ac(),T.ac()),2&t){var c=T.nc();T.uc("stepControl",c.typeControl),T.Gb(2),T.uc("formGroup",c.typeControl),T.Gb(6),T.uc("ngForOf",c.companies),T.Gb(2),T.uc("ngIf",c.types),T.Gb(2),T.uc("ngIf",c.subTypes),T.Gb(2),T.uc("disabled",c.typeControl.invalid)}}function gc(t,e){1&t&&T.Vc(0,"Asunto y descripci\xf3n")}function kc(t,e){if(1&t){var c=T.cc();T.bc(0,"button",43),T.jc("click",(function(t){return T.Mc(c),T.nc(),T.Jc(15).clear(t)})),T.bc(1,"mat-icon"),T.Vc(2,"clear"),T.ac(),T.ac()}}function vc(t,e){1&t&&(T.bc(0,"mat-checkbox",44),T.Vc(1,"Es urgente "),T.ac()),2&t&&T.uc("color","primary")}function yc(t,e){1&t&&T.Vc(0,"Responsables")}function xc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",42),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(2).setTeam(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i),T.Gb(1),T.Xc("",i.name," ")}}function _c(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",42),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).setAgent(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.uc("value",i),T.Gb(1),T.Yc("",i.name," ",i.surname," ")}}function Cc(t,e){if(1&t&&(T.bc(0,"mat-form-field",8),T.bc(1,"mat-label"),T.Vc(2,"Agente"),T.ac(),T.bc(3,"mat-select"),T.Tc(4,_c,2,3,"mat-option",40),T.ac(),T.ac()),2&t){var c=T.nc(2);T.Gb(4),T.uc("ngForOf",c.agents)}}function Tc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-step",45),T.Tc(1,yc,1,0,"ng-template",5),T.bc(2,"form",6),T.bc(3,"div",7),T.bc(4,"mat-form-field",8),T.bc(5,"mat-label"),T.Vc(6,"Equipo"),T.ac(),T.bc(7,"mat-select"),T.Tc(8,xc,2,2,"mat-option",40),T.ac(),T.ac(),T.Wb(9,"span",10),T.Tc(10,Cc,5,1,"mat-form-field",41),T.ac(),T.bc(11,"div",18),T.bc(12,"button",19),T.Vc(13,"Anterior"),T.ac(),T.Wb(14,"span",20),T.bc(15,"button",46),T.jc("click",(function(t){return T.Mc(c),T.nc().submit()})),T.Vc(16,"Crear ticket"),T.ac(),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.nc();T.uc("stepControl",i.respControl),T.Gb(2),T.uc("formGroup",i.respControl),T.Gb(6),T.uc("ngForOf",i.teams),T.Gb(2),T.uc("ngIf",i.agents)}}function wc(t,e){1&t&&T.Vc(0,"En copia")}function Mc(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-option",54),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(2).setCc(i)})),T.Vc(1),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.Xc(" ",i.name+" "+i.surname," ")}}function Sc(t,e){if(1&t&&T.Wb(0,"img",61),2&t){var c=T.nc().$implicit,i=T.nc(3);T.vc("src",i.url+"user/image/"+c.image,T.Oc)}}function Ic(t,e){1&t&&T.Wb(0,"img",62)}function Gc(t,e){if(1&t){var c=T.cc();T.bc(0,"li",56),T.Tc(1,Sc,1,1,"img",57),T.Tc(2,Ic,1,0,"img",58),T.bc(3,"span"),T.Vc(4),T.ac(),T.bc(5,"button",59),T.jc("click",(function(t){T.Mc(c);var i=e.$implicit;return T.nc(3).deleteCc(i)})),T.Wb(6,"i",60),T.ac(),T.ac()}if(2&t){var i=e.$implicit;T.Gb(1),T.uc("ngIf","null"!=i.image),T.Gb(1),T.uc("ngIf","null"==i.image),T.Gb(2),T.Yc("",i.name," ",i.surname,"")}}function Oc(t,e){if(1&t&&(T.bc(0,"span"),T.Tc(1,Gc,7,4,"li",55),T.ac()),2&t){var c=T.nc(2);T.Gb(1),T.uc("ngForOf",c.cc)}}function Ec(t,e){if(1&t){var c=T.cc();T.bc(0,"mat-step",47),T.Tc(1,wc,1,0,"ng-template",5),T.bc(2,"form",11),T.bc(3,"div",7),T.bc(4,"mat-form-field",48),T.bc(5,"input",49),T.jc("input",(function(t){return T.Mc(c),T.nc().filterCc()}))("ngModelChange",(function(t){return T.Mc(c),T.nc().ccFilter=t})),T.ac(),T.bc(6,"mat-autocomplete",null,50),T.Tc(8,Mc,2,1,"mat-option",51),T.ac(),T.ac(),T.ac(),T.bc(9,"div",7),T.bc(10,"ul",52),T.Tc(11,Oc,2,1,"span",53),T.ac(),T.ac(),T.bc(12,"div",18),T.bc(13,"button",19),T.Vc(14,"Anterior"),T.ac(),T.Wb(15,"span",20),T.bc(16,"button",46),T.jc("click",(function(t){return T.Mc(c),T.nc().submit()})),T.Vc(17,"Crear ticket"),T.ac(),T.ac(),T.ac(),T.ac()}if(2&t){var i=T.Jc(7),n=T.nc();T.Gb(5),T.uc("ngModel",n.ccFilter)("matAutocomplete",i),T.Gb(3),T.uc("ngForOf",n.ccList),T.Gb(3),T.uc("ngIf",0!=n.getLenght(n.cc))}}var Vc,jc=[{path:"",children:[{path:"list/:page/:limit",component:Q,data:{title:"Lista",breadcrumb:"LISTA"}},{path:"gestion/:id",component:Ze,data:{title:"Gesti\xf3n",breadcrumb:"GESTION"}},{path:"new",component:(Vc=function(){function t(e,c,i,n,a,s,r,o,u,l,d){_classCallCheck(this,t),this._ticketService=e,this._userService=c,this._textBlockService=i,this._uploadService=n,this.snackBar=a,this._teamService=s,this._companyService=r,this._router=o,this.loader=u,this._typeTicketService=l,this._subTypeTicketService=d,this.url=x.a.url,this.config=x.a.richTextModule,this.ccList=[],this.allCcList=[],this.ccFilter="",this.token=c.getToken(),this.identity=c.getIdentity(),this.cc=new Array}return _createClass(t,[{key:"ngOnInit",value:function(){"ROLE_REQUESTER"==this.identity.role?(this.getCompany(),this.getCc()):(this.getTeams(),this.getRequesters()),this.buildForm()}},{key:"buildForm",value:function(){this.requesterControl=new a.h({requester:new a.e(null,[a.v.required])}),this.descriptionControl=new a.h({sub:new a.e(null,[a.v.required]),text:new a.e(null,[a.v.required]),important:new a.e(!1),files:new a.e(void 0)}),this.respControl=new a.h({team:new a.e(null,[a.v.required]),agent:new a.e(null,[a.v.required])}),this.typeControl=new a.h({company:new a.e(null,[a.v.required]),subtype:new a.e(null,[a.v.required]),resolve:new a.e(null)})}},{key:"getRequesters",value:function(){var t=this;this._userService.getListReq(this.token,this.identity.company._id).subscribe((function(e){e.users&&(t.requesters=e.users,t.tempRequesters=e.users)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getTeams",value:function(){var t=this;this._teamService.getList(this.token,this.identity.company._id).subscribe((function(e){e.teams&&(t.teams=e.teams)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getTypes",value:function(t){var e=this;this._typeTicketService.getList(this.token,t).subscribe((function(t){t.typeTickets&&(e.types=t.typeTickets)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getSubTypes",value:function(t){var e=this;this._subTypeTicketService.getList(this.token,t).subscribe((function(t){t.subTypeTickets&&(e.subTypes=t.subTypeTickets)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getCompany",value:function(){var t=this;this._companyService.getList(this.token).subscribe((function(e){e.companies&&(t.companies=e.companies)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getCc",value:function(){var t=this;this._userService.getList(this.token).subscribe((function(e){e.users&&(t.allCcList=e.users)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"setTeam",value:function(t){this.respControl.controls.team.setValue(t._id),this.getAgents(t.users)}},{key:"setCompany",value:function(t){this.typeControl.controls.company.setValue(t._id),this.typeControl.controls.subtype.setValue(null),this.subTypes=null,this.getTypes(t._id)}},{key:"setType",value:function(t){this.getSubTypes(t._id)}},{key:"setSubType",value:function(t){this.subType=t,this.typeControl.controls.subtype.setValue(t._id),this.descriptionControl.controls.sub.setValue(null),this.descriptionControl.controls.text.setValue(null),t.autoSub&&""!=t.autoSub&&this.descriptionControl.controls.sub.setValue(t.autoSub),t.autoDesc&&""!=t.autoDesc&&this.descriptionControl.controls.text.setValue(t.autoDesc),this.respControl.controls.team.setValue(null),t.team&&this.respControl.controls.team.setValue(t.team._id),this.setResolve(t)}},{key:"getAgents",value:function(t){this.agents=t,this.tempAgents=t}},{key:"setAgent",value:function(t){this.respControl.controls.agent.setValue(t._id)}},{key:"setRequester",value:function(t){this.requesterControl.controls.requester.setValue(t._id),this.requester=t}},{key:"setResolve",value:function(t){var e=k().add(t.resolveDays,"days").format("DD-MM-YYYY");6!=k(e,"DD-MM-YYYY").weekday()&&0!=k(e,"DD-MM-YYYY").weekday()||(e=k(e,"DD-MM-YYYY").add(2,"days").format("DD-MM-YYYY")),this.typeControl.controls.resolve.setValue(e)}},{key:"filterRequester",value:function(t){this.requesters=this.tempRequesters.filter((function(e){return(e.name+e.surname).toLowerCase().includes(t.toString().toLowerCase())}))}},{key:"resetFiles",value:function(){this.descriptionControl.controls.files.setValue(void 0),this.openSnackBar("Adjuntos eliminados","Cerrar")}},{key:"getLenght",value:function(t){return t.length}},{key:"displayRequester",value:function(t){return t.name+" "+t.surname}},{key:"submit",value:function(){var t=this;if(this.loader.open("Generando ticket"),"ROLE_REQUESTER"!=this.identity.role)this.ticket=new X("","",null,null,null,null,"Abierto","","",null,null,"MANUAL",[null],"Normal",this.identity.company._id,null,new Array,null,null,""),this.ticket.requester=this.requesterControl.controls.requester.value,this.descriptionControl.controls.important.value&&(this.ticket.priority="Urgente"),this.respControl.controls.agent.value&&(this.ticket.agent=this.respControl.controls.agent.value),this.ticket.source="MANUAL";else if(this.ticket=new X("","",null,this.identity._id,null,null,"Abierto","","",null,null,"MANUAL",[null],"Normal",null,null,new Array,null,null,""),this.ticket.company=this.typeControl.controls.company.value,this.ticket.subTypeTicket=this.typeControl.controls.subtype.value,this.ticket.source="PORTAL",this.ticket.resolveDate=this.typeControl.controls.resolve.value,0!=this.cc.length){var e=new Array;this.cc.forEach((function(t){e.push(t._id)})),this.ticket.cc=e}this.ticket.sub=this.descriptionControl.controls.sub.value,this.respControl.controls.team.value&&(this.ticket.team=this.respControl.controls.team.value,this.ticket.status="Pendiente"),this._ticketService.add(this.token,this.ticket).subscribe((function(e){e.ticket&&(t.text=new J("",t.descriptionControl.controls.text.value,t.identity._id,"",e.ticket._id,"PUBLIC",[null],!1),"ROLE_REQUESTER"==t.identity.role&&(t.text.type="REQUEST"),t._textBlockService.add(t.token,t.text).subscribe((function(e){e.textblock&&(null!=t.descriptionControl.controls.files.value&&null!=t.descriptionControl.controls.files.value?t._uploadService.makeFileRequest(t.url+"textblock/file/"+e.textblock._id,[],t.descriptionControl.controls.files.value.files,t.token,"file").then((function(e){t.loader.close()}),(function(e){t.openSnackBar(e.message,"Cerrar")})):t.loader.close(),t.openSnackBar("Ticket generado correctamente","Cerrar"),t._router.navigate(["/ticket/gestion",e.textblock.ticket]))}),(function(e){t.loader.close(),t.openSnackBar(e.message,"Cerrar")})))}),(function(e){t.loader.close(),t.openSnackBar(e.message,"Cerrar")}))}},{key:"isInvalid",value:function(){return!!this.descriptionControl.invalid||"ROLE_REQUESTER"==this.identity.role&&0!=this.subType.autoChange&&null!=this.subType.autoChange&&this.descriptionControl.controls.text.value==this.subType.autoDesc&&this.descriptionControl.controls.sub.value==this.subType.autoSub}},{key:"fileChangeEvent",value:function(t){this.descriptionControl.controls.files.setValue(t.target.files),this.openSnackBar("Adjuntos a\xf1adidos","Cerrar")}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"filterCc",value:function(){var t=this;this.ccList=this.allCcList.filter((function(e){return(e.name+e.surname).toLowerCase().includes(t.ccFilter.toString().toLowerCase())}))}},{key:"setCc",value:function(t){-1==this.cc.indexOf(t)&&this.cc.push(t)}},{key:"deleteCc",value:function(t){-1!=this.cc.indexOf(t)&&this.cc.splice(this.cc.indexOf(t),1)}}]),t}(),Vc.\u0275fac=function(t){return new(t||Vc)(T.Vb(y.a),T.Vb(v.a),T.Vb(tt),T.Vb(et.a),T.Vb(w.a),T.Vb(K.a),T.Vb(it.a),T.Vb(n.g),T.Vb(g.a),T.Vb(tc.a),T.Vb(ec.a))},Vc.\u0275cmp=T.Pb({type:Vc,selectors:[["app-new-ticket"]],features:[T.Fb([K.a,tt,et.a,tc.a,ec.a,it.a])],decls:30,vars:11,consts:[[1,"p-0"],[3,"linear"],["id","requesterStep",3,"stepControl",4,"ngIf"],["id","typeStep",3,"stepControl",4,"ngIf"],["id","descriptionStep",3,"stepControl"],["matStepLabel",""],["fxFlex","",3,"formGroup"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","",1,"full-width"],["type","text","placeholder","Asunto","aria-label","Text","formControlName","sub","matInput",""],["fxFlex","16px"],["fxFlex",""],["fxFlex","","formControlName","files","name","files","placeholder","Adjuntar archivos","multiple",""],["removableInput",""],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["fxFlex","","class","full-width","formControlName","important","name","sectorRef",3,"color",4,"ngIf"],["fxFlex","",1,"p-0"],["theme","snow","placeholder","Escribe aqui tu mensaje","name","autoDesc","formControlName","text",3,"modules"],["fxLayout","row"],["mat-raised-button","","color","accent","matStepperPrevious",""],["fxFlex","8px"],["mat-raised-button","","color","primary","matStepperNext","",3,"disabled"],["id","respStep",3,"stepControl",4,"ngIf"],["id","ccStep",3,"stepControl",4,"ngIf"],["id","requesterStep",3,"stepControl"],["type","text","placeholder","Buscar solicitante","aria-label","Text","matInput","",3,"matAutocomplete","input"],[3,"displayWith","optionSelected"],["autoReq","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-xl-5"],["style","width: 150px;height: 150px;","src","assets/images/system/user-placeholder.png",4,"ngIf"],["style","width: 150px;height: 150px;",3,"src",4,"ngIf"],["class","col-xl-6 align-self-center",4,"ngIf"],[3,"value"],["src","assets/images/system/user-placeholder.png",2,"width","150px","height","150px"],[2,"width","150px","height","150px",3,"src"],[1,"col-xl-6","align-self-center"],[1,"form-row"],[1,"col"],["id","typeStep",3,"stepControl"],[3,"value","click",4,"ngFor","ngForOf"],["fxFlex","","class","full-width",4,"ngIf"],[3,"value","click"],["mat-icon-button","","matSuffix","",3,"click"],["fxFlex","","formControlName","important","name","sectorRef",1,"full-width",3,"color"],["id","respStep",3,"stepControl"],["mat-raised-button","","color","primary","matStepperNext","",3,"click"],["id","ccStep",3,"stepControl"],[1,"full-width"],["type","text","placeholder","Buscar persona","aria-label","Text","matInput","","name","ccFilter",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoCC","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],[1,"list-group","full-width"],[4,"ngIf"],[3,"click"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],["class","rounded-circle mr-2","width","30","height","30",3,"src",4,"ngIf"],["class","rounded-circle mr-2","width","30","height","30","src","assets/images/system/user-placeholder.png",4,"ngIf"],["type","button",1,"btn","btn-danger","float-right",3,"click"],[1,"fa","fa-trash"],["width","30","height","30",1,"rounded-circle","mr-2",3,"src"],["width","30","height","30","src","assets/images/system/user-placeholder.png",1,"rounded-circle","mr-2"]],template:function(t,e){if(1&t&&(T.bc(0,"mat-card",0),T.bc(1,"mat-card-content"),T.bc(2,"mat-horizontal-stepper",1),T.Tc(3,uc,18,8,"mat-step",2),T.Tc(4,mc,16,6,"mat-step",3),T.bc(5,"mat-step",4),T.Tc(6,gc,1,0,"ng-template",5),T.bc(7,"form",6),T.bc(8,"div",7),T.bc(9,"mat-form-field",8),T.Wb(10,"input",9),T.ac(),T.Wb(11,"span",10),T.bc(12,"div",11),T.bc(13,"mat-form-field"),T.Wb(14,"ngx-mat-file-input",12,13),T.Tc(16,kc,3,0,"button",14),T.ac(),T.ac(),T.Wb(17,"span",10),T.Tc(18,vc,2,1,"mat-checkbox",15),T.ac(),T.bc(19,"div",7),T.bc(20,"mat-card-content",16),T.Wb(21,"quill-editor",17),T.ac(),T.ac(),T.bc(22,"div",18),T.bc(23,"button",19),T.Vc(24,"Anterior"),T.ac(),T.Wb(25,"span",20),T.bc(26,"button",21),T.Vc(27,"Siguiente"),T.ac(),T.ac(),T.ac(),T.ac(),T.Tc(28,Tc,17,4,"mat-step",22),T.Tc(29,Ec,18,4,"mat-step",23),T.ac(),T.ac(),T.ac()),2&t){var c=T.Jc(15);T.Gb(2),T.uc("linear",!0),T.Gb(1),T.uc("ngIf","ROLE_REQUESTER"!=e.identity.role),T.Gb(1),T.uc("ngIf","ROLE_REQUESTER"==e.identity.role),T.Gb(1),T.uc("stepControl",e.descriptionControl),T.Gb(2),T.uc("formGroup",e.descriptionControl),T.Gb(9),T.uc("ngIf",!c.empty),T.Gb(2),T.uc("ngIf","ROLE_REQUESTER"!=e.identity.role),T.Gb(3),T.uc("modules",e.config),T.Gb(5),T.uc("disabled",e.isInvalid()),T.Gb(2),T.uc("ngIf","ROLE_REQUESTER"!=e.identity.role),T.Gb(1),T.uc("ngIf","ROLE_REQUESTER"==e.identity.role)}},directives:[u.a,u.c,cc.a,i.m,cc.b,cc.c,a.x,a.o,M.b,a.i,M.d,p.a,a.c,s.b,a.n,a.g,Ot.a,pt.a,o.b,cc.f,cc.e,a.p,ft.c,ft.a,i.l,C.p,p.d,S.a,p.e,r.a,ic.a,a.q],styles:[".butt[_ngcontent-%COMP%]{background-color:#018aca}.butt[_ngcontent-%COMP%], .butt-trash[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#fff;display:inline-block;transition:all .5s;cursor:pointer;padding:10px 15px!important;text-transform:uppercase;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center}.butt-trash[_ngcontent-%COMP%]{background-color:#ff1717}"]}),Vc),data:{title:"Nuevo",breadcrumb:"NUEVO"}}]}],qc=c("YUcS");c.d(e,"TicketModule",(function(){return Fc}));var Pc,Fc=((Pc=function t(){_classCallCheck(this,t)}).\u0275mod=T.Tb({type:Pc}),Pc.\u0275inj=T.Sb({factory:function(t){return new(t||Pc)},providers:[y.a,v.a],imports:[[a.j,i.c,Ot.b,cc.d,S.b,a.t,qc.a,ft.b,lt.b,ic.b,f.f,h.b,pt.b,d.b,b.a,s.c,p.c,r.b,o.c,u.e,l.b,n.k.forChild(jc)]]}),Pc)},Q2c7:function(t,e,c){"use strict";c.d(e,"a",(function(){return s})),c("AJX/");var i=c("YFeJ"),n=c("fXoL"),a=c("qlzE"),s=function(){var t=function(){function t(e){_classCallCheck(this,t),this._http=e,this.url=i.a.url}return _createClass(t,[{key:"makeFileRequest",value:function(t,e,c,i,n){return new Promise((function(e,a){for(var s=new FormData,r=new XMLHttpRequest,o=0;o<c.length;o++)s.append(n,c[o],c[o].name);r.onreadystatechange=function(){4==r.readyState&&(200==r.status?e(JSON.parse(r.response)):a(r.response))},r.open("POST",t,!0),r.setRequestHeader("Authorization",i),r.send(s)}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(n.fc(a.a))},t.\u0275prov=n.Rb({token:t,factory:t.\u0275fac}),t}()}}]);