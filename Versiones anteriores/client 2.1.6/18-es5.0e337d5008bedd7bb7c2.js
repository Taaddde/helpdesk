function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,c=new Array(t);a<t;a++)c[a]=e[a];return c}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var c=t[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"9Mbw":function(e,t,a){"use strict";a.r(t);var c=a("ofXK"),n=a("tyNb"),r=a("3Pt+"),o=a("qFsG"),i=a("NFeN"),s=a("bTqV"),l=a("Wp6s"),u=a("f0Cb"),d=a("kmnG"),b=a("0IaG"),m=a("Qu3c"),f=a("PCNd"),p=a("YUcS"),g=a("7EHt"),h=a("/1cH"),v=a("d3UM"),y=a("iadO"),k=a("xHqg"),x=a("bSwM"),w=a("7ZcW"),S=a("CzEO"),M=a("lDzL"),C=a("gU78"),I=a("YFeJ"),_=a("3sEA"),G=a("L/iA"),V=a("U14E"),T=function e(t,a,c,n,r,o,i,s,l,u){_classCallCheck(this,e),this._id=t,this.numOrder=a,this.date=c,this.dateRequired=n,this.uploadDate=r,this.company=o,this.sectorDestiny=i,this.justification=s,this.obs=l,this.status=u},A=function e(t,a,c,n,r,o,i){_classCallCheck(this,e),this._id=t,this.order=a,this.item=c,this.cant=n,this.obs=r,this.code=o,this.costSector=i},O=a("Nptc"),F=a("AASI"),j=a("kwbH"),D=a("O4PR"),L=a("sd1j"),W=a("FKr1"),P=a("fXoL"),E=a("dNgK"),N=a("XiUz");function q(e,t){if(1&e&&(P.bc(0,"small"),P.Vc(1),P.ac()),2&e){var a=P.nc().$implicit;P.Gb(1),P.Xc(" | ",a.brand,"")}}function R(e,t){if(1&e&&(P.bc(0,"mat-option",14),P.Vc(1),P.Tc(2,q,2,1,"small",15),P.ac()),2&e){var a=t.$implicit;P.uc("value",a),P.Gb(1),P.Xc(" ",a.name," "),P.Gb(1),P.uc("ngIf",a.brand)}}function B(e,t){if(1&e&&(P.bc(0,"mat-option",14),P.bc(1,"span"),P.Vc(2),P.ac(),P.ac()),2&e){var a=t.$implicit;P.uc("value",a.name),P.Gb(2),P.Wc(a.name)}}var H,z=((H=function(){function e(t,a,c,n,r,o){_classCallCheck(this,e),this.data=t,this.dialogRef=a,this.snackBar=c,this._userService=n,this._itemService=r,this._sectorService=o,this.place="Articulo",this.tmpSectors=[],this.token=n.getToken(),this.identity=n.getIdentity()}return _createClass(e,[{key:"ngOnInit",value:function(){if(this.data.payload){var e=this.data.payload;this.orderItem=new A("",e.order,e.item,e.cant,e.obs,e.code,e.costSector),this.place=this.orderItem.item.name+" | "+this.orderItem.item.brand}else this.orderItem=new A("",null,null,1,"","","");this.getItems(),this.getSectors()}},{key:"openSnackBar",value:function(e,t){this.snackBar.open(e,t,{duration:1e4})}},{key:"submit",value:function(e){this.dialogRef.close(e?{delete:!0}:{item:this.orderItem})}},{key:"getItems",value:function(){var e=this;this._itemService.getList(this.token,{company:this.identity.company._id}).subscribe((function(t){t.items&&(e.items=t.items)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getSectors",value:function(){var e=this;this._sectorService.getList(this.token).subscribe((function(t){t.sectors&&(e.sectors=t.sectors)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"filterSector",value:function(e){this.tmpSectors=this.sectors.filter((function(t){return t.name.toLowerCase().includes(e.toString().toLowerCase())}))}}]),e}()).\u0275fac=function(e){return new(e||H)(P.Vb(b.a),P.Vb(b.g),P.Vb(E.a),P.Vb(C.a),P.Vb(j.a),P.Vb(D.a))},H.\u0275cmp=P.Pb({type:H,selectors:[["app-orderitem-popup"]],features:[P.Fb([j.a,C.a,D.a])],decls:23,vars:9,consts:[["matDialogTitle",""],[1,"p-0"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","100",1,"pr-1"],[1,"full-width"],["name","item",3,"placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","number","placeholder","Cantidad","aria-label","Text","min","1","matInput","","name","cant",3,"ngModel","ngModelChange"],["type","text","placeholder","Observacion","aria-label","Text","matInput","","name","obs",3,"ngModel","ngModelChange"],["type","text","placeholder","Centro de costo","aria-label","Text","matInput","","name","costSector",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoActiveFirstOption",""],["autoSector","matAutocomplete"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click"],[3,"value"],[4,"ngIf"]],template:function(e,t){if(1&e&&(P.bc(0,"h1",0),P.Vc(1),P.ac(),P.bc(2,"mat-card",1),P.bc(3,"mat-card-content"),P.bc(4,"form"),P.bc(5,"div",2),P.bc(6,"div",3),P.bc(7,"mat-form-field",4),P.bc(8,"mat-select",5),P.jc("ngModelChange",(function(e){return t.orderItem.item=e})),P.Tc(9,R,3,3,"mat-option",6),P.ac(),P.ac(),P.bc(10,"mat-form-field",4),P.bc(11,"input",7),P.jc("ngModelChange",(function(e){return t.orderItem.cant=e})),P.ac(),P.ac(),P.bc(12,"mat-form-field",4),P.bc(13,"input",8),P.jc("ngModelChange",(function(e){return t.orderItem.obs=e})),P.ac(),P.ac(),P.bc(14,"mat-form-field",4),P.bc(15,"input",9),P.jc("input",(function(e){return t.filterSector(e.target.value)}))("ngModelChange",(function(e){return t.orderItem.costSector=e})),P.ac(),P.bc(16,"mat-autocomplete",10,11),P.Tc(18,B,3,2,"mat-option",6),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(19,"button",12),P.jc("click",(function(e){return t.submit()})),P.Vc(20,"Guardar"),P.ac(),P.bc(21,"button",13),P.jc("click",(function(e){return t.submit(!0)})),P.Vc(22,"Eliminar"),P.ac(),P.ac(),P.ac(),P.ac()),2&e){var a=P.Jc(17);P.Gb(1),P.Wc(t.data.title),P.Gb(7),P.uc("placeholder",t.place)("ngModel",t.orderItem.item),P.Gb(1),P.uc("ngForOf",t.items),P.Gb(2),P.uc("ngModel",t.orderItem.cant),P.Gb(2),P.uc("ngModel",t.orderItem.obs),P.Gb(2),P.uc("ngModel",t.orderItem.costSector)("matAutocomplete",a),P.Gb(3),P.uc("ngForOf",t.tmpSectors)}},directives:[l.a,l.c,r.x,r.o,r.p,N.d,N.b,d.a,v.a,r.n,r.q,c.l,r.s,o.b,r.c,h.c,h.a,s.b,W.p,c.m],encapsulation:2}),H);function J(e,t){1&e&&P.Vc(0,"Orden")}function X(e,t){if(1&e&&(P.bc(0,"mat-option",36),P.bc(1,"span"),P.Vc(2),P.ac(),P.ac()),2&e){var a=t.$implicit;P.uc("value",a.name),P.Gb(2),P.Wc(a.name)}}function U(e,t){if(1&e){var a=P.cc();P.bc(0,"mat-step",19),P.Tc(1,J,1,0,"ng-template",4),P.bc(2,"form"),P.bc(3,"div",5),P.bc(4,"div",20),P.bc(5,"div",7),P.bc(6,"mat-form-field",21),P.bc(7,"mat-label"),P.Vc(8,"Fecha"),P.ac(),P.bc(9,"input",22),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.date=e})),P.ac(),P.Wb(10,"mat-datepicker-toggle",23),P.Wb(11,"mat-datepicker",null,24),P.ac(),P.ac(),P.bc(13,"div",7),P.bc(14,"mat-form-field",21),P.bc(15,"input",25),P.jc("input",(function(e){return P.Mc(a),P.nc().filterSector(e.target.value)}))("ngModelChange",(function(e){return P.Mc(a),P.nc().order.sectorDestiny=e})),P.ac(),P.bc(16,"mat-autocomplete",26,27),P.Tc(18,X,3,2,"mat-option",28),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(19,"div",29),P.bc(20,"div",7),P.bc(21,"mat-form-field",21),P.bc(22,"mat-label"),P.Vc(23,"Fecha de entrega requerida"),P.ac(),P.bc(24,"input",30),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.dateRequired=e})),P.ac(),P.Wb(25,"mat-datepicker-toggle",23),P.Wb(26,"mat-datepicker",null,31),P.ac(),P.ac(),P.bc(28,"div",7),P.bc(29,"mat-form-field",21),P.bc(30,"input",32),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.obs=e})),P.ac(),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(31,"div",5),P.bc(32,"div",6),P.bc(33,"quill-editor",33),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.justification=e})),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(34,"div",34),P.bc(35,"button",35),P.Vc(36,"Siguiente"),P.ac(),P.ac(),P.ac()}if(2&e){var c=P.Jc(12),n=P.Jc(17),r=P.Jc(27),o=P.nc();P.Gb(9),P.uc("ngModel",o.order.date)("matDatepicker",c),P.Gb(1),P.uc("for",c),P.Gb(5),P.uc("ngModel",o.order.sectorDestiny)("matAutocomplete",n),P.Gb(3),P.uc("ngForOf",o.tmpSectors),P.Gb(6),P.uc("ngModel",o.order.dateRequired)("matDatepicker",r),P.Gb(1),P.uc("for",r),P.Gb(5),P.uc("ngModel",o.order.obs),P.Gb(3),P.uc("modules",o.config)("ngModel",o.order.justification)}}function $(e,t){1&e&&P.Vc(0,"Articulos")}function K(e,t){1&e&&P.Vc(0),2&e&&P.Xc(" ",t.rowIndex+1," ")}function Y(e,t){1&e&&P.Vc(0),2&e&&P.Xc(" ",t.row.cant," ")}function Q(e,t){if(1&e&&(P.bc(0,"small",37),P.Vc(1),P.ac()),2&e){var a=P.nc().row;P.uc("matTooltip",a.item.name+" | "+a.item.brand),P.Gb(1),P.Xc(" | ",a.item.brand,"")}}function Z(e,t){if(1&e&&(P.bc(0,"span",37),P.Vc(1),P.ac(),P.Tc(2,Q,2,2,"small",38)),2&e){var a=t.row;P.uc("matTooltip",a.item.name+" | "+a.item.brand),P.Gb(1),P.Wc(a.item.name),P.Gb(1),P.uc("ngIf",a.item.brand)}}function ee(e,t){if(1&e&&(P.bc(0,"span",37),P.Vc(1),P.ac()),2&e){var a=t.row;P.uc("matTooltip",a.obs),P.Gb(1),P.Wc(a.obs)}}function te(e,t){if(1&e&&(P.bc(0,"span",37),P.Vc(1),P.ac()),2&e){var a=t.row;P.uc("matTooltip",a.costSector),P.Gb(1),P.Wc(a.costSector)}}function ae(e,t){1&e&&(P.bc(0,"button",35),P.Vc(1,"Crear y autorizar"),P.ac())}function ce(e,t){1&e&&P.Vc(0,"Orden")}function ne(e,t){if(1&e&&(P.bc(0,"mat-option",36),P.bc(1,"span"),P.Vc(2),P.ac(),P.ac()),2&e){var a=t.$implicit;P.uc("value",a.name),P.Gb(2),P.Wc(a.name)}}function re(e,t){if(1&e){var a=P.cc();P.bc(0,"mat-step",19),P.Tc(1,ce,1,0,"ng-template",4),P.bc(2,"form"),P.bc(3,"div",5),P.bc(4,"div",20),P.bc(5,"div",7),P.bc(6,"mat-form-field",21),P.bc(7,"mat-label"),P.Vc(8,"Fecha"),P.ac(),P.bc(9,"input",22),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.date=e})),P.ac(),P.Wb(10,"mat-datepicker-toggle",23),P.Wb(11,"mat-datepicker",null,24),P.ac(),P.ac(),P.bc(13,"div",7),P.bc(14,"mat-form-field",21),P.bc(15,"input",25),P.jc("input",(function(e){return P.Mc(a),P.nc().filterSector(e.target.value)}))("ngModelChange",(function(e){return P.Mc(a),P.nc().order.sectorDestiny=e})),P.ac(),P.bc(16,"mat-autocomplete",26,27),P.Tc(18,ne,3,2,"mat-option",28),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(19,"div",29),P.bc(20,"div",7),P.bc(21,"mat-form-field",21),P.bc(22,"mat-label"),P.Vc(23,"Fecha de entrega requerida"),P.ac(),P.bc(24,"input",30),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.dateRequired=e})),P.ac(),P.Wb(25,"mat-datepicker-toggle",23),P.Wb(26,"mat-datepicker",null,31),P.ac(),P.ac(),P.bc(28,"div",7),P.bc(29,"mat-form-field",21),P.bc(30,"input",32),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.obs=e})),P.ac(),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(31,"div",5),P.bc(32,"div",6),P.bc(33,"quill-editor",33),P.jc("ngModelChange",(function(e){return P.Mc(a),P.nc().order.justification=e})),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(34,"div",34),P.bc(35,"button",35),P.Vc(36,"Siguiente"),P.ac(),P.ac(),P.ac()}if(2&e){var c=P.Jc(12),n=P.Jc(17),r=P.Jc(27),o=P.nc();P.Gb(9),P.uc("ngModel",o.order.date)("matDatepicker",c),P.Gb(1),P.uc("for",c),P.Gb(5),P.uc("ngModel",o.order.sectorDestiny)("matAutocomplete",n),P.Gb(3),P.uc("ngForOf",o.tmpSectors),P.Gb(6),P.uc("ngModel",o.order.dateRequired)("matDatepicker",r),P.Gb(1),P.uc("for",r),P.Gb(5),P.uc("ngModel",o.order.obs),P.Gb(3),P.uc("modules",o.config)("ngModel",o.order.justification)}}function oe(e,t){1&e&&P.Vc(0,"Articulos")}function ie(e,t){1&e&&P.Vc(0),2&e&&P.Xc(" ",t.rowIndex+1," ")}function se(e,t){1&e&&P.Vc(0),2&e&&P.Xc(" ",t.row.cant," ")}function le(e,t){if(1&e&&(P.bc(0,"small",37),P.Vc(1),P.ac()),2&e){var a=P.nc().row;P.uc("matTooltip",a.item.name+" | "+a.item.brand),P.Gb(1),P.Xc(" | ",a.item.brand,"")}}function ue(e,t){if(1&e&&(P.bc(0,"span",37),P.Vc(1),P.ac(),P.Tc(2,le,2,2,"small",38)),2&e){var a=t.row;P.uc("matTooltip",a.item.name+" | "+a.item.brand),P.Gb(1),P.Wc(a.item.name),P.Gb(1),P.uc("ngIf",a.item.brand)}}function de(e,t){if(1&e&&(P.bc(0,"span",37),P.Vc(1),P.ac()),2&e){var a=t.row;P.uc("matTooltip",a.obs),P.Gb(1),P.Wc(a.obs)}}function be(e,t){if(1&e&&(P.bc(0,"span",37),P.Vc(1),P.ac()),2&e){var a=t.row;P.uc("matTooltip",a.costSector),P.Gb(1),P.Wc(a.costSector)}}function me(e,t){1&e&&(P.bc(0,"button",35),P.Vc(1,"Crear y autorizar"),P.ac())}var fe,pe,ge=[{path:"",children:[{path:"new",component:(pe=function(){function e(t,a,c,n,r,o,i,s,l,u){_classCallCheck(this,e),this._userService=t,this.snackBar=a,this._router=c,this.loader=n,this.dialog=r,this._orderService=o,this._orderItemService=i,this._stockService=s,this._depositService=l,this._sectorService=u,this.config=I.a.richTextModule,this.tmpItems=[],this.tmpSectors=[],this.token=t.getToken(),this.identity=t.getIdentity(),this.order=new T("",null,new Date,new Date,null,this.identity.company._id,null,"","","Pendiente"),this.orderItem=new A("","",null,1,"","","")}return _createClass(e,[{key:"ngOnInit",value:function(){this.order.dateRequired.setMonth(this.order.dateRequired.getMonth()+1),this.getDeposits(),this.getSectors()}},{key:"getSectors",value:function(){var e=this;this._sectorService.getList(this.token).subscribe((function(t){t.sectors&&(e.sectors=t.sectors)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"getDeposits",value:function(){var e=this;this._depositService.getList(this.token,{company:this.identity.company._id}).subscribe((function(t){if(t.deposits){var a=new Array;t.deposits.forEach((function(e){a.push(e._id)})),e.getStockMissing(a)}}),(function(e){console.error(e)}))}},{key:"getStockMissing",value:function(e){var t=this;this._stockService.getList(this.token,{deposit:e,onOrder:!1,$where:"this.cant < this.cantMin"}).subscribe((function(e){e.stocks&&(t.orderItems=new Array,t.lowStocks=e.stocks,t.lowStocks.forEach((function(e){var a=new A("",null,e.item,e.cantMin-e.cant,"","",null);t.orderItems.push(a)})))}),(function(e){console.error(e)}))}},{key:"filterSector",value:function(e){this.tmpSectors=this.sectors.filter((function(t){return t.name.toLowerCase().includes(e.toString().toLowerCase())}))}},{key:"getLenght",value:function(e){return e.length}},{key:"openSnackBar",value:function(e,t){this.snackBar.open(e,t,{duration:1e4})}},{key:"onActivate",value:function(e){"click"==e.type&&this.newItem(!1,e.row)}},{key:"newItem",value:function(e,t){var a=this;this.dialog.open(z,{width:"720px",disableClose:!1,data:{payload:t,title:e?"Nuevo articulo":"Editar articulo"}}).afterClosed().subscribe((function(c){if(c){if(c.delete)a.orderItems.splice(a.orderItems.indexOf(t),1),a.orderItems=_toConsumableArray(a.orderItems);else{var n=new A("",null,c.item.item,c.item.cant,c.item.obs,c.item.code,c.item.costSector);a.loader.open(),e?a.orderItems=a.orderItems.concat([n]):(t.cant=n.cant,t.item=n.item,t.obs=n.obs,t.costSector=n.costSector)}a.loader.close()}}))}},{key:"send",value:function(e){var t=this;this.order.status=e?"Autorizado":"Pendiente",this._orderService.add(this.token,this.order).subscribe((function(e){if(e.order){var a=e.order,c={onOrder:!0};t.orderItems.forEach((function(e){e.order=a._id,t._stockService.editMany(t.token,e.item._id,c).subscribe((function(e){}),(function(e){console.error(e)})),t._orderItemService.add(t.token,e).subscribe((function(e){}),(function(e){console.error(e)}))})),t.openSnackBar("Pedido enviado para autorizar","Cerrar"),t._router.navigate(["deposit/home"])}}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}}]),e}(),pe.\u0275fac=function(e){return new(e||pe)(P.Vb(C.a),P.Vb(E.a),P.Vb(n.g),P.Vb(_.a),P.Vb(b.b),P.Vb(G.a),P.Vb(V.a),P.Vb(O.a),P.Vb(F.a),P.Vb(D.a))},pe.\u0275cmp=P.Pb({type:pe,selectors:[["app-new-order"]],features:[P.Fb([{provide:W.c,useClass:L.b},{provide:W.f,useValue:L.a},G.a,V.a,O.a,F.a,j.a,D.a])],decls:28,vars:14,consts:[[1,"p-0"],[3,"linear"],["id","orderStep",4,"ngIf"],["id","orderItemsStep"],["matStepLabel",""],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-xs","100",1,"pr-1"],[1,"pb-1"],["mat-raised-button","","color","primary",3,"click"],[1,"material","bg-white",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight","activate"],["name","Item",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Cantidad",3,"flexGrow"],["name","Descripci\xf3n",3,"flexGrow"],["name","Observaci\xf3n",3,"flexGrow"],["name","Centro de costo",3,"flexGrow"],["mat-raised-button","","color","primary","matStepperNext","",3,"click"],["fxFlex","16px"],["mat-raised-button","","color","primary","matStepperNext","",4,"ngIf"],["id","orderStep"],["fxFlex","100","fxFlex.gt-xs","50",1,"pr-1"],[1,"full-width"],["matInput","","name","date",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["date",""],["type","text","placeholder","Destino","aria-label","Text","matInput","","name","sectorDestiny",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-xs","50"],["matInput","","name","dateRequired",3,"ngModel","matDatepicker","ngModelChange"],["dateRequired",""],["type","text","placeholder","Observaciones","aria-label","Text","matInput","","name","obs",3,"ngModel","ngModelChange"],["theme","snow","placeholder","Justificativo de compra","name","justification",3,"modules","ngModel","ngModelChange"],[2,"margin-top","50px"],["mat-raised-button","","color","primary","matStepperNext",""],[3,"value"],[3,"matTooltip"],[3,"matTooltip",4,"ngIf"]],template:function(e,t){1&e&&(P.bc(0,"mat-card",0),P.bc(1,"mat-card-content"),P.bc(2,"mat-horizontal-stepper",1),P.Tc(3,U,37,12,"mat-step",2),P.bc(4,"mat-step",3),P.Tc(5,$,1,0,"ng-template",4),P.bc(6,"form"),P.bc(7,"div",5),P.bc(8,"div",6),P.bc(9,"div",7),P.bc(10,"button",8),P.jc("click",(function(e){return t.newItem(!0)})),P.Vc(11,"A\xf1adir articulo"),P.ac(),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(12,"ngx-datatable",9),P.jc("activate",(function(e){return t.onActivate(e)})),P.bc(13,"ngx-datatable-column",10),P.Tc(14,K,1,1,"ng-template",11),P.ac(),P.bc(15,"ngx-datatable-column",12),P.Tc(16,Y,1,1,"ng-template",11),P.ac(),P.bc(17,"ngx-datatable-column",13),P.Tc(18,Z,3,3,"ng-template",11),P.ac(),P.bc(19,"ngx-datatable-column",14),P.Tc(20,ee,2,2,"ng-template",11),P.ac(),P.bc(21,"ngx-datatable-column",15),P.Tc(22,te,2,2,"ng-template",11),P.ac(),P.ac(),P.bc(23,"div"),P.bc(24,"button",16),P.jc("click",(function(e){return t.send(!1)})),P.Vc(25,"Enviar a autorizar"),P.ac(),P.Wb(26,"span",17),P.Tc(27,ae,2,0,"button",18),P.ac(),P.ac(),P.ac(),P.ac(),P.ac()),2&e&&(P.Gb(2),P.uc("linear",!0),P.Gb(1),P.uc("ngIf","ROLE_ADMIN"==t.identity.role),P.Gb(9),P.uc("rows",t.orderItems)("columnMode","flex")("headerHeight",40)("footerHeight",50)("limit",10)("rowHeight",45),P.Gb(1),P.uc("flexGrow",1),P.Gb(2),P.uc("flexGrow",1),P.Gb(2),P.uc("flexGrow",7),P.Gb(2),P.uc("flexGrow",7),P.Gb(2),P.uc("flexGrow",3),P.Gb(6),P.uc("ngIf","ROLE_ADMIN"==t.identity.role))},directives:[l.a,l.c,k.a,c.m,k.b,k.c,r.x,r.o,r.p,N.d,N.b,s.b,M.d,M.b,M.a,k.e,d.a,d.d,o.b,r.c,y.b,r.n,r.q,y.d,d.e,y.a,h.c,h.a,c.l,S.a,W.p,m.a],styles:[".butt[_ngcontent-%COMP%]{background-color:#018aca}.butt[_ngcontent-%COMP%], .butt-trash[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#fff;display:inline-block;transition:all .5s;cursor:pointer;padding:10px 15px!important;text-transform:uppercase;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center}.butt-trash[_ngcontent-%COMP%]{background-color:#ff1717}"]}),pe),data:{title:"Nueva orden",breadcrumb:"NUEVA ORDEN"}},{path:"get/:id",component:(fe=function(){function e(t,a,c,n,r,o,i,s,l,u){_classCallCheck(this,e),this._userService=t,this.snackBar=a,this._router=c,this.loader=n,this.dialog=r,this._route=o,this._stockService=i,this._orderService=s,this._orderItemService=l,this._sectorService=u,this.config=I.a.richTextModule,this.tmpItems=[],this.tmpSectors=[],this.token=t.getToken(),this.identity=t.getIdentity(),this.order=new T("",null,new Date,new Date,null,this.identity.company._id,null,"","","Pendiente")}return _createClass(e,[{key:"ngOnInit",value:function(){this.getSectors(),this.getOrders()}},{key:"getOrders",value:function(){var e=this;this._route.params.forEach((function(t){e._orderService.getOne(e.token,t.id).subscribe((function(t){t.order?(e.order=t.order,e._orderItemService.getList(e.token,{order:e.order._id}).subscribe((function(t){t.orderItems&&(e.orderItems=t.orderItems)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))):(e.openSnackBar("Orden no encontrada","Cerrar"),e._router.navigate(["deposit/home"]))}),(function(t){e._router.navigate(["deposit/home"]),e.openSnackBar(t.message,"Cerrar")}))}))}},{key:"getSectors",value:function(){var e=this;this._sectorService.getList(this.token).subscribe((function(t){t.sectors&&(e.sectors=t.sectors)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"filterSector",value:function(e){this.tmpSectors=this.sectors.filter((function(t){return t.name.toLowerCase().includes(e.toString().toLowerCase())}))}},{key:"getLenght",value:function(e){return e.length}},{key:"openSnackBar",value:function(e,t){this.snackBar.open(e,t,{duration:1e4})}},{key:"onActivate",value:function(e){"click"==e.type&&this.newItem(!1,e.row)}},{key:"newItem",value:function(e,t){var a=this;this.dialog.open(z,{width:"720px",disableClose:!1,data:{payload:t,title:e?"Nuevo articulo":"Editar articulo"}}).afterClosed().subscribe((function(e){e&&(console.log(e.item),a.loader.close())}))}},{key:"send",value:function(e){var t=this;this.order.status=e?"Autorizado":"Pendiente",this._orderService.add(this.token,this.order).subscribe((function(e){}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}}]),e}(),fe.\u0275fac=function(e){return new(e||fe)(P.Vb(C.a),P.Vb(E.a),P.Vb(n.g),P.Vb(_.a),P.Vb(b.b),P.Vb(n.a),P.Vb(O.a),P.Vb(G.a),P.Vb(V.a),P.Vb(D.a))},fe.\u0275cmp=P.Pb({type:fe,selectors:[["app-new-order"]],features:[P.Fb([{provide:W.c,useClass:L.b},{provide:W.f,useValue:L.a},G.a,V.a,j.a,D.a,O.a])],decls:28,vars:14,consts:[[1,"p-0"],[3,"linear"],["id","orderStep",4,"ngIf"],["id","orderItemsStep"],["matStepLabel",""],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-xs","100",1,"pr-1"],[1,"pb-1"],["mat-raised-button","","color","primary",3,"click"],[1,"material","bg-white",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight","activate"],["name","Item",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Cantidad",3,"flexGrow"],["name","Descripci\xf3n",3,"flexGrow"],["name","Observaci\xf3n",3,"flexGrow"],["name","Centro de costo",3,"flexGrow"],["mat-raised-button","","color","primary","matStepperNext","",3,"click"],["fxFlex","16px"],["mat-raised-button","","color","primary","matStepperNext","",4,"ngIf"],["id","orderStep"],["fxFlex","100","fxFlex.gt-xs","50",1,"pr-1"],[1,"full-width"],["matInput","","name","date",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["date",""],["type","text","placeholder","Destino","aria-label","Text","matInput","","name","sectorDestiny",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-xs","50"],["matInput","","name","dateRequired",3,"ngModel","matDatepicker","ngModelChange"],["dateRequired",""],["type","text","placeholder","Observaciones","aria-label","Text","matInput","","name","obs",3,"ngModel","ngModelChange"],["theme","snow","placeholder","Justificativo de compra","name","justification",3,"modules","ngModel","ngModelChange"],[2,"margin-top","50px"],["mat-raised-button","","color","primary","matStepperNext",""],[3,"value"],[3,"matTooltip"],[3,"matTooltip",4,"ngIf"]],template:function(e,t){1&e&&(P.bc(0,"mat-card",0),P.bc(1,"mat-card-content"),P.bc(2,"mat-horizontal-stepper",1),P.Tc(3,re,37,12,"mat-step",2),P.bc(4,"mat-step",3),P.Tc(5,oe,1,0,"ng-template",4),P.bc(6,"form"),P.bc(7,"div",5),P.bc(8,"div",6),P.bc(9,"div",7),P.bc(10,"button",8),P.jc("click",(function(e){return t.newItem(!0)})),P.Vc(11,"A\xf1adir articulo"),P.ac(),P.ac(),P.ac(),P.ac(),P.ac(),P.bc(12,"ngx-datatable",9),P.jc("activate",(function(e){return t.onActivate(e)})),P.bc(13,"ngx-datatable-column",10),P.Tc(14,ie,1,1,"ng-template",11),P.ac(),P.bc(15,"ngx-datatable-column",12),P.Tc(16,se,1,1,"ng-template",11),P.ac(),P.bc(17,"ngx-datatable-column",13),P.Tc(18,ue,3,3,"ng-template",11),P.ac(),P.bc(19,"ngx-datatable-column",14),P.Tc(20,de,2,2,"ng-template",11),P.ac(),P.bc(21,"ngx-datatable-column",15),P.Tc(22,be,2,2,"ng-template",11),P.ac(),P.ac(),P.bc(23,"div"),P.bc(24,"button",16),P.jc("click",(function(e){return t.send(!1)})),P.Vc(25,"Enviar a autorizar"),P.ac(),P.Wb(26,"span",17),P.Tc(27,me,2,0,"button",18),P.ac(),P.ac(),P.ac(),P.ac(),P.ac()),2&e&&(P.Gb(2),P.uc("linear",!0),P.Gb(1),P.uc("ngIf","ROLE_ADMIN"==t.identity.role),P.Gb(9),P.uc("rows",t.orderItems)("columnMode","flex")("headerHeight",40)("footerHeight",50)("limit",10)("rowHeight",45),P.Gb(1),P.uc("flexGrow",1),P.Gb(2),P.uc("flexGrow",1),P.Gb(2),P.uc("flexGrow",7),P.Gb(2),P.uc("flexGrow",7),P.Gb(2),P.uc("flexGrow",3),P.Gb(6),P.uc("ngIf","ROLE_ADMIN"==t.identity.role))},directives:[l.a,l.c,k.a,c.m,k.b,k.c,r.x,r.o,r.p,N.d,N.b,s.b,M.d,M.b,M.a,k.e,d.a,d.d,o.b,r.c,y.b,r.n,r.q,y.d,d.e,y.a,h.c,h.a,c.l,S.a,W.p,m.a],styles:[".butt[_ngcontent-%COMP%]{background-color:#018aca}.butt[_ngcontent-%COMP%], .butt-trash[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#fff;display:inline-block;transition:all .5s;cursor:pointer;padding:10px 15px!important;text-transform:uppercase;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center}.butt-trash[_ngcontent-%COMP%]{background-color:#ff1717}"]}),fe),data:{title:"Orden",breadcrumb:"ORDEN"}}]}];a.d(t,"AppOrderModule",(function(){return ve}));var he,ve=((he=function e(){_classCallCheck(this,e)}).\u0275mod=P.Tb({type:he}),he.\u0275inj=P.Sb({factory:function(e){return new(e||he)},imports:[[c.c,r.t,d.c,w.b,S.b,k.d,r.j,M.e,u.b,g.b,h.b,b.f,v.b,f.a,m.b,y.c,i.b,s.c,l.e,x.b,o.c,p.a,n.k.forChild(ge)]]}),he)}}]);