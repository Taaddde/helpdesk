(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"9Mbw":function(t,e,c){"use strict";c.r(e);var a=c("ofXK"),o=c("tyNb"),r=c("3Pt+"),n=c("qFsG"),i=c("NFeN"),s=c("bTqV"),d=c("Wp6s"),l=c("f0Cb"),u=c("kmnG"),b=c("0IaG"),m=c("Qu3c"),p=c("PCNd"),h=c("YUcS"),g=c("7EHt"),f=c("/1cH"),x=c("d3UM"),w=c("iadO"),v=c("xHqg"),S=c("bSwM"),M=c("7ZcW"),k=c("CzEO"),I=c("lDzL"),G=c("gU78"),C=c("YFeJ"),y=c("3sEA"),V=c("L/iA"),_=c("U14E");class T{constructor(t,e,c,a,o,r,n,i,s,d){this._id=t,this.numOrder=e,this.date=c,this.dateRequired=a,this.uploadDate=o,this.company=r,this.sectorDestiny=n,this.justification=i,this.obs=s,this.status=d}}class O{constructor(t,e,c,a,o,r,n){this._id=t,this.order=e,this.item=c,this.cant=a,this.obs=o,this.code=r,this.costSector=n}}var F=c("Nptc"),A=c("AASI"),D=c("kwbH"),j=c("O4PR"),L=c("sd1j"),N=c("FKr1"),W=c("fXoL"),q=c("dNgK"),E=c("XiUz");function R(t,e){if(1&t&&(W.bc(0,"small"),W.Vc(1),W.ac()),2&t){const t=W.nc().$implicit;W.Gb(1),W.Xc(" | ",t.brand,"")}}function B(t,e){if(1&t&&(W.bc(0,"mat-option",14),W.Vc(1),W.Tc(2,R,2,1,"small",15),W.ac()),2&t){const t=e.$implicit;W.uc("value",t),W.Gb(1),W.Xc(" ",t.name," "),W.Gb(1),W.uc("ngIf",t.brand)}}function P(t,e){if(1&t&&(W.bc(0,"mat-option",14),W.bc(1,"span"),W.Vc(2),W.ac(),W.ac()),2&t){const t=e.$implicit;W.uc("value",t.name),W.Gb(2),W.Wc(t.name)}}let z=(()=>{class t{constructor(t,e,c,a,o,r){this.data=t,this.dialogRef=e,this.snackBar=c,this._userService=a,this._itemService=o,this._sectorService=r,this.place="Articulo",this.tmpSectors=[],this.token=a.getToken(),this.identity=a.getIdentity()}ngOnInit(){if(this.data.payload){let t=this.data.payload;this.orderItem=new O("",t.order,t.item,t.cant,t.obs,t.code,t.costSector),this.place=this.orderItem.item.name+" | "+this.orderItem.item.brand}else this.orderItem=new O("",null,null,1,"","","");this.getItems(),this.getSectors()}openSnackBar(t,e){this.snackBar.open(t,e,{duration:1e4})}submit(t){this.dialogRef.close(t?{delete:!0}:{item:this.orderItem})}getItems(){this._itemService.getList(this.token,{company:this.identity.company._id}).subscribe(t=>{t.items&&(this.items=t.items)},t=>{this.openSnackBar(t.message,"Cerrar")})}getSectors(){this._sectorService.getList(this.token).subscribe(t=>{t.sectors&&(this.sectors=t.sectors)},t=>{this.openSnackBar(t.message,"Cerrar")})}filterSector(t){this.tmpSectors=this.sectors.filter(e=>e.name.toLowerCase().includes(t.toString().toLowerCase()))}}return t.\u0275fac=function(e){return new(e||t)(W.Vb(b.a),W.Vb(b.g),W.Vb(q.a),W.Vb(G.a),W.Vb(D.a),W.Vb(j.a))},t.\u0275cmp=W.Pb({type:t,selectors:[["app-orderitem-popup"]],features:[W.Fb([D.a,G.a,j.a])],decls:23,vars:9,consts:[["matDialogTitle",""],[1,"p-0"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","100",1,"pr-1"],[1,"full-width"],["name","item",3,"placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","number","placeholder","Cantidad","aria-label","Text","min","1","matInput","","name","cant",3,"ngModel","ngModelChange"],["type","text","placeholder","Observacion","aria-label","Text","matInput","","name","obs",3,"ngModel","ngModelChange"],["type","text","placeholder","Centro de costo","aria-label","Text","matInput","","name","costSector",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoActiveFirstOption",""],["autoSector","matAutocomplete"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click"],[3,"value"],[4,"ngIf"]],template:function(t,e){if(1&t&&(W.bc(0,"h1",0),W.Vc(1),W.ac(),W.bc(2,"mat-card",1),W.bc(3,"mat-card-content"),W.bc(4,"form"),W.bc(5,"div",2),W.bc(6,"div",3),W.bc(7,"mat-form-field",4),W.bc(8,"mat-select",5),W.jc("ngModelChange",(function(t){return e.orderItem.item=t})),W.Tc(9,B,3,3,"mat-option",6),W.ac(),W.ac(),W.bc(10,"mat-form-field",4),W.bc(11,"input",7),W.jc("ngModelChange",(function(t){return e.orderItem.cant=t})),W.ac(),W.ac(),W.bc(12,"mat-form-field",4),W.bc(13,"input",8),W.jc("ngModelChange",(function(t){return e.orderItem.obs=t})),W.ac(),W.ac(),W.bc(14,"mat-form-field",4),W.bc(15,"input",9),W.jc("input",(function(t){return e.filterSector(t.target.value)}))("ngModelChange",(function(t){return e.orderItem.costSector=t})),W.ac(),W.bc(16,"mat-autocomplete",10,11),W.Tc(18,P,3,2,"mat-option",6),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(19,"button",12),W.jc("click",(function(t){return e.submit()})),W.Vc(20,"Guardar"),W.ac(),W.bc(21,"button",13),W.jc("click",(function(t){return e.submit(!0)})),W.Vc(22,"Eliminar"),W.ac(),W.ac(),W.ac(),W.ac()),2&t){const t=W.Jc(17);W.Gb(1),W.Wc(e.data.title),W.Gb(7),W.uc("placeholder",e.place)("ngModel",e.orderItem.item),W.Gb(1),W.uc("ngForOf",e.items),W.Gb(2),W.uc("ngModel",e.orderItem.cant),W.Gb(2),W.uc("ngModel",e.orderItem.obs),W.Gb(2),W.uc("ngModel",e.orderItem.costSector)("matAutocomplete",t),W.Gb(3),W.uc("ngForOf",e.tmpSectors)}},directives:[d.a,d.c,r.x,r.o,r.p,E.d,E.b,u.a,x.a,r.n,r.q,a.l,r.s,n.b,r.c,f.c,f.a,s.b,N.p,a.m],encapsulation:2}),t})();function H(t,e){1&t&&W.Vc(0,"Orden")}function J(t,e){if(1&t&&(W.bc(0,"mat-option",36),W.bc(1,"span"),W.Vc(2),W.ac(),W.ac()),2&t){const t=e.$implicit;W.uc("value",t.name),W.Gb(2),W.Wc(t.name)}}function X(t,e){if(1&t){const t=W.cc();W.bc(0,"mat-step",19),W.Tc(1,H,1,0,"ng-template",4),W.bc(2,"form"),W.bc(3,"div",5),W.bc(4,"div",20),W.bc(5,"div",7),W.bc(6,"mat-form-field",21),W.bc(7,"mat-label"),W.Vc(8,"Fecha"),W.ac(),W.bc(9,"input",22),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.date=e})),W.ac(),W.Wb(10,"mat-datepicker-toggle",23),W.Wb(11,"mat-datepicker",null,24),W.ac(),W.ac(),W.bc(13,"div",7),W.bc(14,"mat-form-field",21),W.bc(15,"input",25),W.jc("input",(function(e){return W.Mc(t),W.nc().filterSector(e.target.value)}))("ngModelChange",(function(e){return W.Mc(t),W.nc().order.sectorDestiny=e})),W.ac(),W.bc(16,"mat-autocomplete",26,27),W.Tc(18,J,3,2,"mat-option",28),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(19,"div",29),W.bc(20,"div",7),W.bc(21,"mat-form-field",21),W.bc(22,"mat-label"),W.Vc(23,"Fecha de entrega requerida"),W.ac(),W.bc(24,"input",30),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.dateRequired=e})),W.ac(),W.Wb(25,"mat-datepicker-toggle",23),W.Wb(26,"mat-datepicker",null,31),W.ac(),W.ac(),W.bc(28,"div",7),W.bc(29,"mat-form-field",21),W.bc(30,"input",32),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.obs=e})),W.ac(),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(31,"div",5),W.bc(32,"div",6),W.bc(33,"quill-editor",33),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.justification=e})),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(34,"div",34),W.bc(35,"button",35),W.Vc(36,"Siguiente"),W.ac(),W.ac(),W.ac()}if(2&t){const t=W.Jc(12),e=W.Jc(17),c=W.Jc(27),a=W.nc();W.Gb(9),W.uc("ngModel",a.order.date)("matDatepicker",t),W.Gb(1),W.uc("for",t),W.Gb(5),W.uc("ngModel",a.order.sectorDestiny)("matAutocomplete",e),W.Gb(3),W.uc("ngForOf",a.tmpSectors),W.Gb(6),W.uc("ngModel",a.order.dateRequired)("matDatepicker",c),W.Gb(1),W.uc("for",c),W.Gb(5),W.uc("ngModel",a.order.obs),W.Gb(3),W.uc("modules",a.config)("ngModel",a.order.justification)}}function U(t,e){1&t&&W.Vc(0,"Articulos")}function $(t,e){1&t&&W.Vc(0),2&t&&W.Xc(" ",e.rowIndex+1," ")}function K(t,e){1&t&&W.Vc(0),2&t&&W.Xc(" ",e.row.cant," ")}function Y(t,e){if(1&t&&(W.bc(0,"small",37),W.Vc(1),W.ac()),2&t){const t=W.nc().row;W.uc("matTooltip",t.item.name+" | "+t.item.brand),W.Gb(1),W.Xc(" | ",t.item.brand,"")}}function Q(t,e){if(1&t&&(W.bc(0,"span",37),W.Vc(1),W.ac(),W.Tc(2,Y,2,2,"small",38)),2&t){const t=e.row;W.uc("matTooltip",t.item.name+" | "+t.item.brand),W.Gb(1),W.Wc(t.item.name),W.Gb(1),W.uc("ngIf",t.item.brand)}}function Z(t,e){if(1&t&&(W.bc(0,"span",37),W.Vc(1),W.ac()),2&t){const t=e.row;W.uc("matTooltip",t.obs),W.Gb(1),W.Wc(t.obs)}}function tt(t,e){if(1&t&&(W.bc(0,"span",37),W.Vc(1),W.ac()),2&t){const t=e.row;W.uc("matTooltip",t.costSector),W.Gb(1),W.Wc(t.costSector)}}function et(t,e){1&t&&(W.bc(0,"button",35),W.Vc(1,"Crear y autorizar"),W.ac())}function ct(t,e){1&t&&W.Vc(0,"Orden")}function at(t,e){if(1&t&&(W.bc(0,"mat-option",36),W.bc(1,"span"),W.Vc(2),W.ac(),W.ac()),2&t){const t=e.$implicit;W.uc("value",t.name),W.Gb(2),W.Wc(t.name)}}function ot(t,e){if(1&t){const t=W.cc();W.bc(0,"mat-step",19),W.Tc(1,ct,1,0,"ng-template",4),W.bc(2,"form"),W.bc(3,"div",5),W.bc(4,"div",20),W.bc(5,"div",7),W.bc(6,"mat-form-field",21),W.bc(7,"mat-label"),W.Vc(8,"Fecha"),W.ac(),W.bc(9,"input",22),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.date=e})),W.ac(),W.Wb(10,"mat-datepicker-toggle",23),W.Wb(11,"mat-datepicker",null,24),W.ac(),W.ac(),W.bc(13,"div",7),W.bc(14,"mat-form-field",21),W.bc(15,"input",25),W.jc("input",(function(e){return W.Mc(t),W.nc().filterSector(e.target.value)}))("ngModelChange",(function(e){return W.Mc(t),W.nc().order.sectorDestiny=e})),W.ac(),W.bc(16,"mat-autocomplete",26,27),W.Tc(18,at,3,2,"mat-option",28),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(19,"div",29),W.bc(20,"div",7),W.bc(21,"mat-form-field",21),W.bc(22,"mat-label"),W.Vc(23,"Fecha de entrega requerida"),W.ac(),W.bc(24,"input",30),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.dateRequired=e})),W.ac(),W.Wb(25,"mat-datepicker-toggle",23),W.Wb(26,"mat-datepicker",null,31),W.ac(),W.ac(),W.bc(28,"div",7),W.bc(29,"mat-form-field",21),W.bc(30,"input",32),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.obs=e})),W.ac(),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(31,"div",5),W.bc(32,"div",6),W.bc(33,"quill-editor",33),W.jc("ngModelChange",(function(e){return W.Mc(t),W.nc().order.justification=e})),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(34,"div",34),W.bc(35,"button",35),W.Vc(36,"Siguiente"),W.ac(),W.ac(),W.ac()}if(2&t){const t=W.Jc(12),e=W.Jc(17),c=W.Jc(27),a=W.nc();W.Gb(9),W.uc("ngModel",a.order.date)("matDatepicker",t),W.Gb(1),W.uc("for",t),W.Gb(5),W.uc("ngModel",a.order.sectorDestiny)("matAutocomplete",e),W.Gb(3),W.uc("ngForOf",a.tmpSectors),W.Gb(6),W.uc("ngModel",a.order.dateRequired)("matDatepicker",c),W.Gb(1),W.uc("for",c),W.Gb(5),W.uc("ngModel",a.order.obs),W.Gb(3),W.uc("modules",a.config)("ngModel",a.order.justification)}}function rt(t,e){1&t&&W.Vc(0,"Articulos")}function nt(t,e){1&t&&W.Vc(0),2&t&&W.Xc(" ",e.rowIndex+1," ")}function it(t,e){1&t&&W.Vc(0),2&t&&W.Xc(" ",e.row.cant," ")}function st(t,e){if(1&t&&(W.bc(0,"small",37),W.Vc(1),W.ac()),2&t){const t=W.nc().row;W.uc("matTooltip",t.item.name+" | "+t.item.brand),W.Gb(1),W.Xc(" | ",t.item.brand,"")}}function dt(t,e){if(1&t&&(W.bc(0,"span",37),W.Vc(1),W.ac(),W.Tc(2,st,2,2,"small",38)),2&t){const t=e.row;W.uc("matTooltip",t.item.name+" | "+t.item.brand),W.Gb(1),W.Wc(t.item.name),W.Gb(1),W.uc("ngIf",t.item.brand)}}function lt(t,e){if(1&t&&(W.bc(0,"span",37),W.Vc(1),W.ac()),2&t){const t=e.row;W.uc("matTooltip",t.obs),W.Gb(1),W.Wc(t.obs)}}function ut(t,e){if(1&t&&(W.bc(0,"span",37),W.Vc(1),W.ac()),2&t){const t=e.row;W.uc("matTooltip",t.costSector),W.Gb(1),W.Wc(t.costSector)}}function bt(t,e){1&t&&(W.bc(0,"button",35),W.Vc(1,"Crear y autorizar"),W.ac())}const mt=[{path:"",children:[{path:"new",component:(()=>{class t{constructor(t,e,c,a,o,r,n,i,s,d){this._userService=t,this.snackBar=e,this._router=c,this.loader=a,this.dialog=o,this._orderService=r,this._orderItemService=n,this._stockService=i,this._depositService=s,this._sectorService=d,this.config=C.a.richTextModule,this.tmpItems=[],this.tmpSectors=[],this.token=t.getToken(),this.identity=t.getIdentity(),this.order=new T("",null,new Date,new Date,null,this.identity.company._id,null,"","","Pendiente"),this.orderItem=new O("","",null,1,"","","")}ngOnInit(){this.order.dateRequired.setMonth(this.order.dateRequired.getMonth()+1),this.getDeposits(),this.getSectors()}getSectors(){this._sectorService.getList(this.token).subscribe(t=>{t.sectors&&(this.sectors=t.sectors)},t=>{this.openSnackBar(t.message,"Cerrar")})}getDeposits(){this._depositService.getList(this.token,{company:this.identity.company._id}).subscribe(t=>{if(t.deposits){let e=new Array;t.deposits.forEach(t=>{e.push(t._id)}),this.getStockMissing(e)}},t=>{console.error(t)})}getStockMissing(t){this._stockService.getList(this.token,{deposit:t,onOrder:!1,$where:"this.cant < this.cantMin"}).subscribe(t=>{t.stocks&&(this.orderItems=new Array,this.lowStocks=t.stocks,this.lowStocks.forEach(t=>{let e=new O("",null,t.item,t.cantMin-t.cant,"","",null);this.orderItems.push(e)}))},t=>{console.error(t)})}filterSector(t){this.tmpSectors=this.sectors.filter(e=>e.name.toLowerCase().includes(t.toString().toLowerCase()))}getLenght(t){return t.length}openSnackBar(t,e){this.snackBar.open(t,e,{duration:1e4})}onActivate(t){"click"==t.type&&this.newItem(!1,t.row)}newItem(t,e){this.dialog.open(z,{width:"720px",disableClose:!1,data:{payload:e,title:t?"Nuevo articulo":"Editar articulo"}}).afterClosed().subscribe(c=>{if(c){if(c.delete)this.orderItems.splice(this.orderItems.indexOf(e),1),this.orderItems=[...this.orderItems];else{let a=new O("",null,c.item.item,c.item.cant,c.item.obs,c.item.code,c.item.costSector);this.loader.open(),t?this.orderItems=this.orderItems.concat([a]):(e.cant=a.cant,e.item=a.item,e.obs=a.obs,e.costSector=a.costSector)}this.loader.close()}})}send(t){this.order.status=t?"Autorizado":"Pendiente",this._orderService.add(this.token,this.order).subscribe(t=>{if(t.order){let e=t.order,c={onOrder:!0};this.orderItems.forEach(t=>{t.order=e._id,this._stockService.editMany(this.token,t.item._id,c).subscribe(t=>{},t=>{console.error(t)}),this._orderItemService.add(this.token,t).subscribe(t=>{},t=>{console.error(t)})}),this.openSnackBar("Pedido enviado para autorizar","Cerrar"),this._router.navigate(["deposit/home"])}},t=>{this.openSnackBar(t.message,"Cerrar")})}}return t.\u0275fac=function(e){return new(e||t)(W.Vb(G.a),W.Vb(q.a),W.Vb(o.g),W.Vb(y.a),W.Vb(b.b),W.Vb(V.a),W.Vb(_.a),W.Vb(F.a),W.Vb(A.a),W.Vb(j.a))},t.\u0275cmp=W.Pb({type:t,selectors:[["app-new-order"]],features:[W.Fb([{provide:N.c,useClass:L.b},{provide:N.f,useValue:L.a},V.a,_.a,F.a,A.a,D.a,j.a])],decls:28,vars:14,consts:[[1,"p-0"],[3,"linear"],["id","orderStep",4,"ngIf"],["id","orderItemsStep"],["matStepLabel",""],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-xs","100",1,"pr-1"],[1,"pb-1"],["mat-raised-button","","color","primary",3,"click"],[1,"material","bg-white",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight","activate"],["name","Item",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Cantidad",3,"flexGrow"],["name","Descripci\xf3n",3,"flexGrow"],["name","Observaci\xf3n",3,"flexGrow"],["name","Centro de costo",3,"flexGrow"],["mat-raised-button","","color","primary","matStepperNext","",3,"click"],["fxFlex","16px"],["mat-raised-button","","color","primary","matStepperNext","",4,"ngIf"],["id","orderStep"],["fxFlex","100","fxFlex.gt-xs","50",1,"pr-1"],[1,"full-width"],["matInput","","name","date",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["date",""],["type","text","placeholder","Destino","aria-label","Text","matInput","","name","sectorDestiny",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-xs","50"],["matInput","","name","dateRequired",3,"ngModel","matDatepicker","ngModelChange"],["dateRequired",""],["type","text","placeholder","Observaciones","aria-label","Text","matInput","","name","obs",3,"ngModel","ngModelChange"],["theme","snow","placeholder","Justificativo de compra","name","justification",3,"modules","ngModel","ngModelChange"],[2,"margin-top","50px"],["mat-raised-button","","color","primary","matStepperNext",""],[3,"value"],[3,"matTooltip"],[3,"matTooltip",4,"ngIf"]],template:function(t,e){1&t&&(W.bc(0,"mat-card",0),W.bc(1,"mat-card-content"),W.bc(2,"mat-horizontal-stepper",1),W.Tc(3,X,37,12,"mat-step",2),W.bc(4,"mat-step",3),W.Tc(5,U,1,0,"ng-template",4),W.bc(6,"form"),W.bc(7,"div",5),W.bc(8,"div",6),W.bc(9,"div",7),W.bc(10,"button",8),W.jc("click",(function(t){return e.newItem(!0)})),W.Vc(11,"A\xf1adir articulo"),W.ac(),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(12,"ngx-datatable",9),W.jc("activate",(function(t){return e.onActivate(t)})),W.bc(13,"ngx-datatable-column",10),W.Tc(14,$,1,1,"ng-template",11),W.ac(),W.bc(15,"ngx-datatable-column",12),W.Tc(16,K,1,1,"ng-template",11),W.ac(),W.bc(17,"ngx-datatable-column",13),W.Tc(18,Q,3,3,"ng-template",11),W.ac(),W.bc(19,"ngx-datatable-column",14),W.Tc(20,Z,2,2,"ng-template",11),W.ac(),W.bc(21,"ngx-datatable-column",15),W.Tc(22,tt,2,2,"ng-template",11),W.ac(),W.ac(),W.bc(23,"div"),W.bc(24,"button",16),W.jc("click",(function(t){return e.send(!1)})),W.Vc(25,"Enviar a autorizar"),W.ac(),W.Wb(26,"span",17),W.Tc(27,et,2,0,"button",18),W.ac(),W.ac(),W.ac(),W.ac(),W.ac()),2&t&&(W.Gb(2),W.uc("linear",!0),W.Gb(1),W.uc("ngIf","ROLE_ADMIN"==e.identity.role),W.Gb(9),W.uc("rows",e.orderItems)("columnMode","flex")("headerHeight",40)("footerHeight",50)("limit",10)("rowHeight",45),W.Gb(1),W.uc("flexGrow",1),W.Gb(2),W.uc("flexGrow",1),W.Gb(2),W.uc("flexGrow",7),W.Gb(2),W.uc("flexGrow",7),W.Gb(2),W.uc("flexGrow",3),W.Gb(6),W.uc("ngIf","ROLE_ADMIN"==e.identity.role))},directives:[d.a,d.c,v.a,a.m,v.b,v.c,r.x,r.o,r.p,E.d,E.b,s.b,I.d,I.b,I.a,v.e,u.a,u.d,n.b,r.c,w.b,r.n,r.q,w.d,u.e,w.a,f.c,f.a,a.l,k.a,N.p,m.a],styles:[".butt[_ngcontent-%COMP%]{background-color:#018aca}.butt[_ngcontent-%COMP%], .butt-trash[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#fff;display:inline-block;transition:all .5s;cursor:pointer;padding:10px 15px!important;text-transform:uppercase;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center}.butt-trash[_ngcontent-%COMP%]{background-color:#ff1717}"]}),t})(),data:{title:"Nueva orden",breadcrumb:"NUEVA ORDEN"}},{path:"get/:id",component:(()=>{class t{constructor(t,e,c,a,o,r,n,i,s,d){this._userService=t,this.snackBar=e,this._router=c,this.loader=a,this.dialog=o,this._route=r,this._stockService=n,this._orderService=i,this._orderItemService=s,this._sectorService=d,this.config=C.a.richTextModule,this.tmpItems=[],this.tmpSectors=[],this.token=t.getToken(),this.identity=t.getIdentity(),this.order=new T("",null,new Date,new Date,null,this.identity.company._id,null,"","","Pendiente")}ngOnInit(){this.getSectors(),this.getOrders()}getOrders(){this._route.params.forEach(t=>{this._orderService.getOne(this.token,t.id).subscribe(t=>{t.order?(this.order=t.order,this._orderItemService.getList(this.token,{order:this.order._id}).subscribe(t=>{t.orderItems&&(this.orderItems=t.orderItems)},t=>{this.openSnackBar(t.message,"Cerrar")})):(this.openSnackBar("Orden no encontrada","Cerrar"),this._router.navigate(["deposit/home"]))},t=>{this._router.navigate(["deposit/home"]),this.openSnackBar(t.message,"Cerrar")})})}getSectors(){this._sectorService.getList(this.token).subscribe(t=>{t.sectors&&(this.sectors=t.sectors)},t=>{this.openSnackBar(t.message,"Cerrar")})}filterSector(t){this.tmpSectors=this.sectors.filter(e=>e.name.toLowerCase().includes(t.toString().toLowerCase()))}getLenght(t){return t.length}openSnackBar(t,e){this.snackBar.open(t,e,{duration:1e4})}onActivate(t){"click"==t.type&&this.newItem(!1,t.row)}newItem(t,e){this.dialog.open(z,{width:"720px",disableClose:!1,data:{payload:e,title:t?"Nuevo articulo":"Editar articulo"}}).afterClosed().subscribe(t=>{t&&(console.log(t.item),this.loader.close())})}send(t){this.order.status=t?"Autorizado":"Pendiente",this._orderService.add(this.token,this.order).subscribe(t=>{},t=>{this.openSnackBar(t.message,"Cerrar")})}}return t.\u0275fac=function(e){return new(e||t)(W.Vb(G.a),W.Vb(q.a),W.Vb(o.g),W.Vb(y.a),W.Vb(b.b),W.Vb(o.a),W.Vb(F.a),W.Vb(V.a),W.Vb(_.a),W.Vb(j.a))},t.\u0275cmp=W.Pb({type:t,selectors:[["app-new-order"]],features:[W.Fb([{provide:N.c,useClass:L.b},{provide:N.f,useValue:L.a},V.a,_.a,D.a,j.a,F.a])],decls:28,vars:14,consts:[[1,"p-0"],[3,"linear"],["id","orderStep",4,"ngIf"],["id","orderItemsStep"],["matStepLabel",""],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-xs","100",1,"pr-1"],[1,"pb-1"],["mat-raised-button","","color","primary",3,"click"],[1,"material","bg-white",3,"rows","columnMode","headerHeight","footerHeight","limit","rowHeight","activate"],["name","Item",3,"flexGrow"],["ngx-datatable-cell-template",""],["name","Cantidad",3,"flexGrow"],["name","Descripci\xf3n",3,"flexGrow"],["name","Observaci\xf3n",3,"flexGrow"],["name","Centro de costo",3,"flexGrow"],["mat-raised-button","","color","primary","matStepperNext","",3,"click"],["fxFlex","16px"],["mat-raised-button","","color","primary","matStepperNext","",4,"ngIf"],["id","orderStep"],["fxFlex","100","fxFlex.gt-xs","50",1,"pr-1"],[1,"full-width"],["matInput","","name","date",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["date",""],["type","text","placeholder","Destino","aria-label","Text","matInput","","name","sectorDestiny",3,"ngModel","matAutocomplete","input","ngModelChange"],["autoActiveFirstOption",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-xs","50"],["matInput","","name","dateRequired",3,"ngModel","matDatepicker","ngModelChange"],["dateRequired",""],["type","text","placeholder","Observaciones","aria-label","Text","matInput","","name","obs",3,"ngModel","ngModelChange"],["theme","snow","placeholder","Justificativo de compra","name","justification",3,"modules","ngModel","ngModelChange"],[2,"margin-top","50px"],["mat-raised-button","","color","primary","matStepperNext",""],[3,"value"],[3,"matTooltip"],[3,"matTooltip",4,"ngIf"]],template:function(t,e){1&t&&(W.bc(0,"mat-card",0),W.bc(1,"mat-card-content"),W.bc(2,"mat-horizontal-stepper",1),W.Tc(3,ot,37,12,"mat-step",2),W.bc(4,"mat-step",3),W.Tc(5,rt,1,0,"ng-template",4),W.bc(6,"form"),W.bc(7,"div",5),W.bc(8,"div",6),W.bc(9,"div",7),W.bc(10,"button",8),W.jc("click",(function(t){return e.newItem(!0)})),W.Vc(11,"A\xf1adir articulo"),W.ac(),W.ac(),W.ac(),W.ac(),W.ac(),W.bc(12,"ngx-datatable",9),W.jc("activate",(function(t){return e.onActivate(t)})),W.bc(13,"ngx-datatable-column",10),W.Tc(14,nt,1,1,"ng-template",11),W.ac(),W.bc(15,"ngx-datatable-column",12),W.Tc(16,it,1,1,"ng-template",11),W.ac(),W.bc(17,"ngx-datatable-column",13),W.Tc(18,dt,3,3,"ng-template",11),W.ac(),W.bc(19,"ngx-datatable-column",14),W.Tc(20,lt,2,2,"ng-template",11),W.ac(),W.bc(21,"ngx-datatable-column",15),W.Tc(22,ut,2,2,"ng-template",11),W.ac(),W.ac(),W.bc(23,"div"),W.bc(24,"button",16),W.jc("click",(function(t){return e.send(!1)})),W.Vc(25,"Enviar a autorizar"),W.ac(),W.Wb(26,"span",17),W.Tc(27,bt,2,0,"button",18),W.ac(),W.ac(),W.ac(),W.ac(),W.ac()),2&t&&(W.Gb(2),W.uc("linear",!0),W.Gb(1),W.uc("ngIf","ROLE_ADMIN"==e.identity.role),W.Gb(9),W.uc("rows",e.orderItems)("columnMode","flex")("headerHeight",40)("footerHeight",50)("limit",10)("rowHeight",45),W.Gb(1),W.uc("flexGrow",1),W.Gb(2),W.uc("flexGrow",1),W.Gb(2),W.uc("flexGrow",7),W.Gb(2),W.uc("flexGrow",7),W.Gb(2),W.uc("flexGrow",3),W.Gb(6),W.uc("ngIf","ROLE_ADMIN"==e.identity.role))},directives:[d.a,d.c,v.a,a.m,v.b,v.c,r.x,r.o,r.p,E.d,E.b,s.b,I.d,I.b,I.a,v.e,u.a,u.d,n.b,r.c,w.b,r.n,r.q,w.d,u.e,w.a,f.c,f.a,a.l,k.a,N.p,m.a],styles:[".butt[_ngcontent-%COMP%]{background-color:#018aca}.butt[_ngcontent-%COMP%], .butt-trash[_ngcontent-%COMP%]{font-size:12px;font-weight:300;color:#fff;display:inline-block;transition:all .5s;cursor:pointer;padding:10px 15px!important;text-transform:uppercase;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;text-align:center}.butt-trash[_ngcontent-%COMP%]{background-color:#ff1717}"]}),t})(),data:{title:"Orden",breadcrumb:"ORDEN"}}]}];c.d(e,"AppOrderModule",(function(){return pt}));let pt=(()=>{class t{}return t.\u0275mod=W.Tb({type:t}),t.\u0275inj=W.Sb({factory:function(e){return new(e||t)},imports:[[a.c,r.t,u.c,M.b,k.b,v.d,r.j,I.e,l.b,g.b,f.b,b.f,x.b,p.a,m.b,w.c,i.b,s.c,d.e,S.b,n.c,h.a,o.k.forChild(mt)]]}),t})()}}]);