(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{RazQ:function(t,e,i){"use strict";i.r(e);var a=i("ofXK"),o=i("tyNb"),s=i("bSwM"),c=i("QibW"),n=i("qFsG"),r=i("lDzL"),p=i("NFeN"),d=i("bTqV"),l=i("Wp6s"),u=i("f0Cb"),h=i("wZkO"),b=i("MutI"),m=i("YUcS"),f=i("aYsj"),g=i("kmnG"),w=i("d3UM"),k=i("3Pt+"),y=i("1jcm"),v=i("Qu3c"),C=i("PCNd"),S=i("gU78"),x=i("3sEA"),I=i("AASI"),B=i("0IaG");class D{constructor(t,e,i){this._id=t,this.name=e,this.company=i}}var M=i("fXoL"),N=i("dNgK"),V=i("XiUz");let j=(()=>{class t{constructor(t,e,i){this.data=t,this.dialogRef=e,this.snackBar=i,this.deposit=new D("","","")}ngOnInit(){this.build(this.data.payload)}build(t){t&&(this.deposit=t)}openSnackBar(t,e){this.snackBar.open(t,e,{duration:1e4})}submit(){if(!this.check())return this.openSnackBar("Faltan campos para completar","Cerrar");this.dialogRef.close({deposit:this.deposit})}check(){return""!=this.deposit.name}}return t.\u0275fac=function(e){return new(e||t)(M.Vb(B.a),M.Vb(B.g),M.Vb(N.a))},t.\u0275cmp=M.Pb({type:t,selectors:[["app-deposit-popop"]],decls:11,vars:2,consts:[["matDialogTitle",""],[1,"p-0"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","100",1,"pr-1"],[1,"full-width"],["type","text","placeholder","Nombre","aria-label","Text","matInput","","name","name",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(M.bc(0,"h1",0),M.Vc(1),M.ac(),M.bc(2,"mat-card",1),M.bc(3,"mat-card-content"),M.bc(4,"form"),M.bc(5,"div",2),M.bc(6,"div",3),M.bc(7,"mat-form-field",4),M.bc(8,"input",5),M.jc("ngModelChange",(function(t){return e.deposit.name=t})),M.ac(),M.ac(),M.ac(),M.ac(),M.bc(9,"button",6),M.jc("click",(function(t){return e.submit()})),M.Vc(10,"Guardar"),M.ac(),M.ac(),M.ac(),M.ac()),2&t&&(M.Gb(1),M.Wc(e.data.title),M.Gb(7),M.uc("ngModel",e.deposit.name))},directives:[l.a,l.c,k.x,k.o,k.p,V.d,V.b,g.a,n.b,k.c,k.n,k.q,d.b],encapsulation:2}),t})();function L(t,e){if(1&t){const t=M.cc();M.bc(0,"div",5),M.bc(1,"button",6),M.jc("click",(function(e){return M.Mc(t),M.nc().toNew()})),M.Vc(2,"Nuevo"),M.ac(),M.ac()}}const P=[{path:"",children:[{path:"list",component:(()=>{class t{constructor(t,e,i,a,o){this._userService=t,this._depositService=e,this.loader=i,this.snackBar=a,this.dialog=o,this.rows=[],this.columns=[],this.temp=[],this.canCreate=!1,this.token=t.getToken(),this.identity=t.getIdentity()}ngOnInit(){this.getColumns(),this.getDeposits(),"ROLE_ADMIN"==this.identity.role&&(this.canCreate=!0)}getDeposits(){this._depositService.getList(this.token,{company:this.identity.company._id}).subscribe(t=>{t.deposits&&(this.rows=t.deposits,this.temp=t.deposits)},t=>{this.openSnackBar(t.message,"Cerrar")})}openSnackBar(t,e){this.snackBar.open(t,e,{duration:1e4})}getColumns(){this.columns=[{prop:"name",name:"Nombre",flexGrow:1}]}updateFilter(t){const e=t.target.value.toLowerCase();var i=Object.keys(this.temp[0]);if(i.splice(i.length-1),!i.length)return;const a=this.temp.filter((function(t){for(let a=0;a<=i.length;a++){let o=i[a];if(t[o]&&t[o].toString().toLowerCase().indexOf(e)>-1)return!0}}));this.rows=a}toNew(){this.openPopUp(!0)}openPopUp(t,e){this.dialog.open(j,{width:"720px",disableClose:!1,data:{payload:e,title:t?"Nuevo deposito":"Editar deposito"}}).afterClosed().subscribe(e=>{if(e){if(this.loader.open(),t){let t=new D("",e.deposit.name,this.identity.company._id);this._depositService.add(this.token,t).subscribe(t=>{t.deposit&&(this.openSnackBar("Deposito creado","Cerrar"),this.getDeposits())},t=>{this.openSnackBar(t.message,"Cerrar")})}else this._depositService.edit(this.token,e.deposit._id,e.deposit).subscribe(t=>{t.deposit&&(this.openSnackBar("Deposito actualizado","Cerrar"),this.getDeposits())},t=>{this.openSnackBar(t.message,"Cerrar")});this.loader.close()}})}toProfile(t,e){"click"==t.type&&this.canCreate&&this.openPopUp(!1,t.row)}}return t.\u0275fac=function(e){return new(e||t)(M.Vb(S.a),M.Vb(I.a),M.Vb(x.a),M.Vb(N.a),M.Vb(B.b))},t.\u0275cmp=M.Pb({type:t,selectors:[["app-deposit-list"]],features:[M.Fb([S.a,I.a])],decls:5,vars:8,consts:[[1,"margin-333",2,"width","100%"],["matInput","","placeholder","Filtrar por todas las columnas","value","",3,"keyup"],["class","profile-actions mb-1","style","margin-left: 5px;",4,"ngIf"],[1,"mat-box-shadow","margin-333"],[1,"material","bg-white",3,"columnMode","headerHeight","footerHeight","rowHeight","limit","rows","columns","activate"],[1,"profile-actions","mb-1",2,"margin-left","5px"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(M.bc(0,"mat-form-field",0),M.bc(1,"input",1),M.jc("keyup",(function(t){return e.updateFilter(t)})),M.ac(),M.ac(),M.Tc(2,L,3,0,"div",2),M.bc(3,"div",3),M.bc(4,"ngx-datatable",4),M.jc("activate",(function(t){return e.toProfile(t)})),M.ac(),M.ac()),2&t&&(M.Gb(2),M.uc("ngIf",e.canCreate),M.Gb(2),M.uc("columnMode","flex")("headerHeight",40)("footerHeight",50)("rowHeight",50)("limit",7)("rows",e.rows)("columns",e.columns))},directives:[g.a,n.b,a.m,r.d,d.b],encapsulation:2}),t})(),data:{title:"Lista de depositos",breadcrumb:"LISTA DE DEPOSITOS"}}]}];i.d(e,"AppDepositModule",(function(){return _}));let _=(()=>{class t{}return t.\u0275mod=M.Tb({type:t}),t.\u0275inj=M.Sb({factory:function(e){return new(e||t)},imports:[[a.c,k.t,g.c,k.j,u.b,w.b,C.a,b.d,v.b,p.b,d.c,l.e,y.a,s.b,c.c,h.c,n.c,m.a,r.e,f.a,o.k.forChild(P)]]}),t})()}}]);