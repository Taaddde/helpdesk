(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"L/iA":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i("AJX/");var s=i("tk/3"),n=i("YFeJ"),o=i("fXoL");let a=(()=>{class t{constructor(t){this._httpClient=t,this.httpOptions={headers:new s.e({"Content-Type":"application/json",Authorization:"null"})},this.url=n.a.url,this.path="order"}add(t,e){let i=JSON.stringify(e);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.post(this.url+this.path+"/add",i,this.httpOptions)}print(t,e,i){let s={body:e};return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.post(this.url+"order/print/"+i,s,this.httpOptions)}getPrint(t){return this._httpClient.get(this.url+"order/print/"+t,this.httpOptions)}edit(t,e,i){let s=JSON.stringify(i);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+this.path+"/update/"+e,s,this.httpOptions)}delete(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.delete(this.url+this.path+"/delete/"+e,this.httpOptions)}getList(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+this.path+"/list",{headers:this.httpOptions.headers,params:e})}getOne(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+this.path+"/get/"+e,this.httpOptions)}}return t.\u0275fac=function(e){return new(e||t)(o.fc(s.c))},t.\u0275prov=o.Rb({token:t,factory:t.\u0275fac}),t})()},U14E:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i("AJX/");var s=i("tk/3"),n=i("YFeJ"),o=i("fXoL");let a=(()=>{class t{constructor(t){this._httpClient=t,this.httpOptions={headers:new s.e({"Content-Type":"application/json",Authorization:"null"})},this.url=n.a.url,this.path="orderitem"}add(t,e){let i=JSON.stringify(e);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.post(this.url+this.path+"/add",i,this.httpOptions)}edit(t,e,i){let s=JSON.stringify(i);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+this.path+"/update/"+e,s,this.httpOptions)}delete(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.delete(this.url+this.path+"/delete/"+e,this.httpOptions)}getList(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+this.path+"/list",{headers:this.httpOptions.headers,params:e})}getOne(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+this.path+"/get/"+e,this.httpOptions)}}return t.\u0275fac=function(e){return new(e||t)(o.fc(s.c))},t.\u0275prov=o.Rb({token:t,factory:t.\u0275fac}),t})()},fk7W:function(t,e,i){"use strict";i.r(e);var s=i("ofXK"),n=i("3Pt+"),o=i("bTqV"),a=i("Wp6s"),r=i("A5z7"),c=i("7EHt"),h=i("zkoq"),p=i("NFeN"),l=i("MutI"),u=i("STbY"),d=i("bv9b"),m=i("+0xr"),b=i("wZkO"),g=i("tyNb"),f=i("YUcS"),w=i("LPYB"),k=i("DKVz"),O=i("lDzL"),x=i("aYsj"),M=i("kmnG"),v=i("qFsG"),G=i("d3UM"),y=i("/1cH"),A=i("GmJt"),_=i("ETNk"),V=i("gU78"),C=i("Nptc"),L=i("vHsL"),S=i("wd/R"),T=i("AASI"),z=i("L/iA"),N=i("U14E"),H=i("fXoL"),I=i("XiUz"),P=i("FKr1");function X(t,e){1&t&&H.Vc(0," # ")}function F(t,e){1&t&&H.Vc(0),2&t&&H.Xc(" ",e.row.numMovim," ")}function D(t,e){1&t&&H.Vc(0," Tipo ")}function E(t,e){1&t&&H.Vc(0),2&t&&H.Xc(" ",e.row.type," ")}function J(t,e){1&t&&H.Vc(0," Articulo ")}function Y(t,e){if(1&t&&(H.bc(0,"span",21),H.bc(1,"span"),H.Vc(2),H.ac(),H.Vc(3," | "),H.bc(4,"small"),H.Vc(5),H.ac(),H.ac()),2&t){const t=e.row;H.uc("matTooltip",t.item.name+" | "+t.item.brand),H.Gb(2),H.Wc(t.item.name),H.Gb(3),H.Wc(t.item.brand)}}function j(t,e){1&t&&H.Vc(0," Cantidad ")}function U(t,e){1&t&&H.Vc(0),2&t&&H.Xc(" ",e.row.cant," ")}function W(t,e){1&t&&H.Vc(0," Fecha ")}function R(t,e){if(1&t&&H.Vc(0),2&t){const t=e.row,i=H.nc();H.Xc(" ",i.changeDate(t.date)," ")}}function q(t,e){if(1&t){const t=H.cc();H.bc(0,"mat-option",22),H.jc("click",(function(i){H.Mc(t);const s=e.$implicit;return H.nc().getStock(s)})),H.Vc(1),H.ac()}if(2&t){const t=e.$implicit;H.uc("value",t),H.Gb(1),H.Xc(" ",t.name," ")}}function K(t,e){1&t&&H.Vc(0," Articulo ")}function $(t,e){1&t&&H.Vc(0),2&t&&H.Xc(" ",e.row.itemName," ")}function B(t,e){1&t&&H.Vc(0," Marca ")}function Z(t,e){1&t&&H.Vc(0),2&t&&H.Xc(" ",e.row.brandName," ")}function Q(t,e){1&t&&H.Vc(0," Stock ")}function tt(t,e){1&t&&H.Vc(0),2&t&&H.Xc(" ",e.row.cant," ")}const et=function(){return{y:"50px",delay:"300ms"}},it=function(t){return{value:"*",params:t}},st=function(){return{scale:".9",delay:"600ms"}},nt=function(){return["/deposit/order/new"]},ot=function(){return{scale:".9",delay:"900ms"}},at=function(){return["/deposit/movim/list"]},rt=function(){return{scale:".9",delay:"1200ms"}},ct=[{path:"",children:[{path:"movim",loadChildren:()=>Promise.all([i.e(0),i.e(17)]).then(i.bind(null,"oBY8")).then(t=>t.AppMovimModule),data:{title:"Movimientos",breadcrumb:"MOVIMIENTOS"}},{path:"order",loadChildren:()=>Promise.all([i.e(3),i.e(0),i.e(18)]).then(i.bind(null,"9Mbw")).then(t=>t.AppOrderModule),data:{title:"Ordenes",breadcrumb:"ORDENES"}},{path:"home",component:(()=>{class t{constructor(t,e,i,s,n,o,a,r){this.themeService=t,this._route=e,this._userService=i,this._stockService=s,this._movimService=n,this._depositService=o,this._orderService=a,this._orderItemService=r,this.temp=[],this.stockMissingColumns=[{prop:"completeName",name:"Articulo",flexGrow:2},{prop:"cant",name:"Cantidad",flexGrow:1},{prop:"cantMin",name:"M\xednimo",flexGrow:1},{prop:"depositName",name:"Dep\xf3sito",flexGrow:1}],this.token=i.getToken(),this.identity=i.getIdentity()}ngAfterViewInit(){}ngOnInit(){this.getLastestMovims(5),this.getDeposits()}getOrders(){this._orderService.getList(this.token,{company:this.identity.company._id,status:"Pendiente"}).subscribe(t=>{if(t.orders){let e=t.orders,i=new Array;e.forEach(t=>{i.push(t._id)}),this.getOrderItems(i)}},t=>{console.error(t.message)})}getOrderItems(t){this.itemsPending=new Array,this._orderItemService.getList(this.token,{order:t}).subscribe(t=>{t.orderItems&&(t.orderItems.forEach(t=>{this.itemsPending.push(t.item._id)}),this.stockMissing.forEach(t=>{-1!=this.itemsPending.indexOf(t.item._id)&&(this.stockMissing.splice(this.stockMissing.indexOf(t),1),this.stockMissing=[...this.stockMissing])}))},t=>{console.error(t.message)})}getDeposits(){this._depositService.getList(this.token,{company:this.identity.company._id}).subscribe(t=>{if(t.deposits){this.deposits=t.deposits,this.deposit=this.deposits[0],this.getStock(this.deposit);let e=new Array;this.deposits.forEach(t=>{e.push(t._id)}),this.getStockMissing(e)}},t=>{console.error(t)})}getStock(t){this._stockService.getList(this.token,{deposit:t._id}).subscribe(t=>{if(t.stocks){this.stocks=t.stocks,this.temp=t.stocks;for(let t=0;t<this.stocks.length;t++){const e=this.stocks[t];this.stocks[t].itemName=e.item.name,this.stocks[t].brandName=e.item.brand,this.temp[t].itemName=e.item.name,this.temp[t].brandName=e.item.brand}}},t=>{console.error(t)})}getStockMissing(t){this._stockService.getList(this.token,{deposit:t,onOrder:!1,$where:"this.cant < this.cantMin"}).subscribe(t=>{t.stocks&&(this.stockMissing=t.stocks,this.stockMissing.forEach(t=>{t.completeName=t.item.name+" "+t.item.brand,t.depositName=t.deposit.name}))},t=>{console.error(t)})}getLastestMovims(t){this._movimService.getLastestList(this.token,{},t).subscribe(t=>{t.movims&&(this.lastestMovims=t.movims)},t=>{console.error(t)})}changeDate(t){return S(t).format("DD-MM-YYYY")}updateFilter(t){const e=t.target.value.toLowerCase();var i=Object.keys(this.temp[0]);if(i.splice(i.length-1),!i.length)return;const s=this.temp.filter((function(t){for(let s=0;s<=i.length;s++){let n=i[s];if(t[n]&&t[n].toString().toLowerCase().indexOf(e)>-1)return!0}}));this.stocks=s}check(t){return-1!=this.itemsPending.indexOf(t)}}return t.\u0275fac=function(e){return new(e||t)(H.Vb(_.a),H.Vb(g.a),H.Vb(V.a),H.Vb(C.a),H.Vb(L.a),H.Vb(T.a),H.Vb(z.a),H.Vb(N.a))},t.\u0275cmp=H.Pb({type:t,selectors:[["app-analytics"]],features:[H.Fb([V.a,C.a,L.a,T.a,z.a,N.a])],decls:45,vars:47,consts:[["fxLayout","row","fxLayout.xs","column","fxLayoutWrap","","fxLayoutGap","0.5%","fxLayoutAlign","center"],["fxLayout","row wrap"],["fxFlex","",1,"p-0"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"material","bg-white",3,"columnMode","headerHeight","footerHeight","rowHeight","limit","rows","columns"],[1,"material","bg-white",3,"columnMode","headerHeight","rowHeight","rows"],["name","num",3,"flexGrow"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["name","type",3,"flexGrow"],["name","item",3,"flexGrow"],["name","cant",3,"flexGrow"],["name","date",3,"flexGrow"],[1,"full-width"],["name","deposit",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[1,"margin-333",2,"width","100%"],["matInput","","placeholder","Filtrar por articulo","value","",3,"keyup"],["ngx-resize-watcher","",1,"material","bg-white",3,"columnMode","headerHeight","footerHeight","rowHeight","limit","rows"],["name","itemName",3,"flexGrow"],["name","brandName",3,"flexGrow"],[3,"matTooltip"],[3,"value","click"]],template:function(t,e){1&t&&(H.bc(0,"mat-card"),H.bc(1,"div",0),H.bc(2,"h1"),H.Vc(3,"Dep\xf3sito"),H.ac(),H.ac(),H.ac(),H.bc(4,"div",1),H.bc(5,"mat-card",2),H.bc(6,"button",3),H.Vc(7,"Crear pedido"),H.ac(),H.Wb(8,"ngx-datatable",4),H.ac(),H.bc(9,"mat-card",2),H.bc(10,"button",3),H.Vc(11,"Ver lista completa"),H.ac(),H.bc(12,"ngx-datatable",5),H.bc(13,"ngx-datatable-column",6),H.Tc(14,X,1,0,"ng-template",7),H.Tc(15,F,1,1,"ng-template",8),H.ac(),H.bc(16,"ngx-datatable-column",9),H.Tc(17,D,1,0,"ng-template",7),H.Tc(18,E,1,1,"ng-template",8),H.ac(),H.bc(19,"ngx-datatable-column",10),H.Tc(20,J,1,0,"ng-template",7),H.Tc(21,Y,6,3,"ng-template",8),H.ac(),H.bc(22,"ngx-datatable-column",11),H.Tc(23,j,1,0,"ng-template",7),H.Tc(24,U,1,1,"ng-template",8),H.ac(),H.bc(25,"ngx-datatable-column",12),H.Tc(26,W,1,0,"ng-template",7),H.Tc(27,R,1,1,"ng-template",8),H.ac(),H.ac(),H.ac(),H.ac(),H.bc(28,"div",1),H.bc(29,"mat-card",2),H.bc(30,"mat-form-field",13),H.bc(31,"mat-select",14),H.jc("ngModelChange",(function(t){return e.deposit=t})),H.Tc(32,q,2,2,"mat-option",15),H.ac(),H.ac(),H.bc(33,"mat-form-field",16),H.bc(34,"input",17),H.jc("keyup",(function(t){return e.updateFilter(t)})),H.ac(),H.ac(),H.bc(35,"ngx-datatable",18),H.bc(36,"ngx-datatable-column",19),H.Tc(37,K,1,0,"ng-template",7),H.Tc(38,$,1,1,"ng-template",8),H.ac(),H.bc(39,"ngx-datatable-column",20),H.Tc(40,B,1,0,"ng-template",7),H.Tc(41,Z,1,1,"ng-template",8),H.ac(),H.bc(42,"ngx-datatable-column",11),H.Tc(43,Q,1,0,"ng-template",7),H.Tc(44,tt,1,1,"ng-template",8),H.ac(),H.ac(),H.ac(),H.ac()),2&t&&(H.uc("@animate",H.Ac(34,it,H.zc(33,et))),H.Gb(5),H.uc("@animate",H.Ac(37,it,H.zc(36,st))),H.Gb(1),H.uc("routerLink",H.zc(39,nt)),H.Gb(2),H.uc("columnMode","flex")("headerHeight",40)("footerHeight",50)("rowHeight",50)("limit",5)("rows",e.stockMissing)("columns",e.stockMissingColumns),H.Gb(1),H.uc("@animate",H.Ac(41,it,H.zc(40,ot))),H.Gb(1),H.uc("routerLink",H.zc(43,at)),H.Gb(2),H.uc("columnMode","flex")("headerHeight",40)("rowHeight",50)("rows",e.lastestMovims),H.Gb(1),H.uc("flexGrow",1),H.Gb(3),H.uc("flexGrow",2),H.Gb(3),H.uc("flexGrow",5),H.Gb(3),H.uc("flexGrow",1),H.Gb(3),H.uc("flexGrow",2),H.Gb(4),H.uc("@animate",H.Ac(45,it,H.zc(44,rt))),H.Gb(2),H.uc("ngModel",e.deposit),H.Gb(1),H.uc("ngForOf",e.deposits),H.Gb(3),H.uc("columnMode","flex")("headerHeight",40)("footerHeight",50)("rowHeight",40)("limit",8)("rows",e.stocks),H.Gb(1),H.uc("flexGrow",3),H.Gb(3),H.uc("flexGrow",3),H.Gb(3),H.uc("flexGrow",1))},directives:[a.a,I.d,I.e,I.c,I.b,o.b,g.h,O.d,O.b,O.c,O.a,M.a,G.a,n.n,n.q,s.l,v.b,P.p],styles:["mat-option[_ngcontent-%COMP%], mat-select[_ngcontent-%COMP%]{text-align:center}"],data:{animation:A.a}}),t})(),data:{title:"Principal",breadcrumb:"PRINCIPAL"}}]}];i.d(e,"AppDepositSettingsModule",(function(){return ht}));let ht=(()=>{class t{}return t.\u0275mod=H.Tb({type:t}),t.\u0275inj=H.Sb({factory:function(e){return new(e||t)},imports:[[s.c,p.b,n.j,a.e,n.t,u.b,d.b,y.b,c.b,o.c,G.b,v.c,r.d,l.d,b.c,m.k,M.c,h.b,f.a,w.a,k.a,O.e,x.a,g.k.forChild(ct)]]}),t})()}}]);