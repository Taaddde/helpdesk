function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{y64J:function(t,e,o){"use strict";o.r(e);var i,a,n,c,r=o("bFKe"),s=o("3Pt+"),u=o("bTqV"),d=o("bSwM"),l=o("A5z7"),f=o("FKr1"),h=o("iadO"),p=o("0IaG"),b=o("f0Cb"),m=o("kmnG"),g=o("NFeN"),v=o("qFsG"),k=o("STbY"),y=o("/t3+"),T=o("Qu3c"),L=o("ofXK"),x=o("7ZcW"),M=o("Wp6s"),C=o("tyNb"),_=o("2Vo4"),D=o("fXoL"),G=o("tk/3"),S=((a=function(){function t(e){_classCallCheck(this,t),this.http=e,this.searchTerm=new _.a("")}return _createClass(t,[{key:"getTodoList",value:function(){return this.http.get("/api/todoList")}},{key:"getTodoById",value:function(t){return this.http.get("/api/todoList/"+t)}},{key:"getTagList",value:function(){return this.http.get("/api/todoTag")}},{key:"updateSearchTerm",value:function(t){this.searchTerm.next(t)}},{key:"getSearchTerm",value:function(){return this.searchTerm}},{key:"saveTag",value:function(t){return this.http.post("/api/todoTag/",t)}},{key:"deleteTag",value:function(t){this.http.delete("/api/todoTag/"+t.id).subscribe((function(t){}))}},{key:"deleteTodo",value:function(t){return this.http.delete("/api/todoList/"+t.id)}},{key:"updateTodo",value:function(t){var e;return t.selected=!1,t.id?e=this.http.put("/api/todoList/"+t.id,t):(t.id=1e6*Math.random(),e=this.http.post("/api/todoList/",t)),this.sub?(this.sub.unsubscribe(),this.sub=e.subscribe((function(t){}))):this.sub=e.subscribe((function(t){})),e}}]),t}()).\u0275fac=function(t){return new(t||a)(D.fc(G.c))},a.\u0275prov=D.Rb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),O=((i=function(){function t(e){_classCallCheck(this,t),this.todoService=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.updateSearchTerm("")}},{key:"updateSearchTerm",value:function(t){this.todoService.updateSearchTerm(t)}}]),t}()).\u0275fac=function(t){return new(t||i)(D.Vb(S))},i.\u0275cmp=D.Pb({type:i,selectors:[["app-todo"]],decls:1,vars:0,template:function(t,e){1&t&&D.Wb(0,"router-outlet")},directives:[C.l],styles:[""],changeDetection:0}),i),V=o("5+WD"),w=o("Kj3r"),I=o("lJxs"),F=o("XNiG"),j=o("xgIS"),W=o("/MnI"),A=o("gU78"),B=(o("AJX/"),o("YFeJ")),R=((n=function(){function t(e){_classCallCheck(this,t),this._httpClient=e,this.httpOptions={headers:new G.e({"Content-Type":"application/json",Authorization:"null"})},this.url=B.a.url}return _createClass(t,[{key:"add",value:function(t,e){var o=JSON.stringify(e);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.post(this.url+"tag/add",o,this.httpOptions)}},{key:"edit",value:function(t,e,o){var i=JSON.stringify(o);return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.put(this.url+"tag/update/"+e,i,this.httpOptions)}},{key:"delete",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.delete(this.url+"tag/delete/"+e,this.httpOptions)}},{key:"getList",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"tag/list",{headers:this.httpOptions.headers,params:e})}},{key:"getOne",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"tag/tag/"+e,this.httpOptions)}},{key:"getForName",value:function(t,e){return this.httpOptions.headers=this.httpOptions.headers.set("Authorization",t),this._httpClient.get(this.url+"tag/for-name/"+e,this.httpOptions)}}]),t}()).\u0275fac=function(t){return new(t||n)(D.fc(G.c))},n.\u0275prov=D.Rb({token:n,factory:n.\u0275fac}),n),N=o("wd/R"),Y=o("dNgK"),z=o("XiUz"),J=o("znSr"),$=((c=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"transform",value:function(t,e){return void 0!==t&&e?t.filter((function(t){return t.title.toLowerCase().match(e.toLowerCase())||t.note.toLowerCase().match(e.toLowerCase())})):t}}]),t}()).\u0275fac=function(t){return new(t||c)},c.\u0275pipe=D.Ub({name:"todoSearch",type:c,pure:!0}),c),P=["searcher"];function X(t,e){if(1&t){var o=D.cc();D.bc(0,"button",13),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().filterTodoListOnTag(i)})),D.Vc(1),D.ac()}if(2&t){var i=e.$implicit;D.Gb(1),D.Xc(" ",i.name," ")}}function q(t,e){1&t&&(D.bc(0,"div",22),D.Vc(1," No hay tareas para mostrar "),D.ac())}function E(t,e){1&t&&(D.bc(0,"mat-icon",36),D.Vc(1,"open_with"),D.ac())}function H(t,e){if(1&t&&(D.bc(0,"strong",37),D.Vc(1),D.ac()),2&t){var o=D.nc().$implicit;D.Gb(1),D.Xc("#",o.numTodo,"")}}function U(t,e){if(1&t&&(D.bc(0,"div"),D.bc(1,"mat-chip"),D.Vc(2),D.ac(),D.ac()),2&t){var o=e.$implicit;D.Gb(2),D.Xc(" ",o.name," ")}}var K=function(t,e){return{"todo-box":!0,readed:t,done:e}},Q=function(t){return{"fill-color-warn":t}},Z=function(t){return{"fill-color-accent":t}};function tt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",23),D.Tc(1,E,2,0,"mat-icon",24),D.Tc(2,H,2,1,"strong",25),D.bc(3,"div",26),D.bc(4,"div",27),D.bc(5,"span"),D.bc(6,"strong"),D.Vc(7),D.ac(),D.Vc(8),D.ac(),D.bc(9,"span"),D.Vc(10),D.ac(),D.bc(11,"mat-chip-list",null,28),D.Tc(13,U,3,1,"div",29),D.ac(),D.ac(),D.bc(14,"div",30),D.bc(15,"button",31),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().toggleImportant(i)})),D.bc(16,"mat-icon",32),D.Vc(17),D.ac(),D.ac(),D.bc(18,"button",31),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().toggleStar(i)})),D.bc(19,"mat-icon",32),D.Vc(20),D.ac(),D.ac(),D.bc(21,"div"),D.bc(22,"button",11),D.bc(23,"mat-icon"),D.Vc(24,"more_vert"),D.ac(),D.ac(),D.bc(25,"mat-menu",33,34),D.bc(27,"button",13),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().toggleRead(i)})),D.bc(28,"mat-icon"),D.Vc(29),D.ac(),D.bc(30,"span",35),D.Vc(31," Le\xeddo "),D.ac(),D.ac(),D.bc(32,"button",13),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().toggleDone(i)})),D.bc(33,"mat-icon"),D.Vc(34),D.ac(),D.bc(35,"span",35),D.Vc(36," Realizado "),D.ac(),D.ac(),D.ac(),D.ac(),D.ac(),D.ac(),D.ac()}if(2&t){var i=e.$implicit,a=D.Jc(26),n=D.nc();D.uc("ngClass",D.Bc(16,K,null==i.usersWhoRead?null:i.usersWhoRead.includes(n.identity._id),i.done)),D.Gb(1),D.uc("ngIf",!i.numTodo),D.Gb(1),D.uc("ngIf",i.numTodo),D.Gb(2),D.wc("routerLink","/todo/list/",null==i?null:i._id,""),D.Gb(3),D.Wc(null==i?null:i.title),D.Gb(1),D.Xc(" | ",n.changeDate(null==i?null:i.startDate),""),D.Gb(2),D.Wc(null==i?null:i.note),D.Gb(3),D.uc("ngForOf",null==i?null:i.tags),D.Gb(3),D.uc("ngClass",D.Ac(19,Q,null==i?null:i.important)),D.Gb(1),D.Wc(null!=i&&i.important?"error":"error_outline"),D.Gb(2),D.uc("ngClass",D.Ac(21,Z,null==i?null:i.starred)),D.Gb(1),D.Wc(null!=i&&i.starred?"star":"star_outline"),D.Gb(2),D.uc("matMenuTriggerFor",a),D.Gb(3),D.uc("xPosition","before"),D.Gb(4),D.Wc(null!=i.usersWhoRead&&i.usersWhoRead.includes(n.identity._id)?"check_box":"check_box_outline_blank"),D.Gb(5),D.Wc(i.done?"check_box":"check_box_outline_blank")}}var et,ot=((et=function(){function t(e,o,i,a,n,c){_classCallCheck(this,t),this.todoService=e,this._todoService=o,this._userService=i,this._tagService=a,this.cdr=n,this.snackBar=c,this.tagMap=new Map,this.isMasterToggled=!1,this.toggledItemNumber=0,this.filter="No Realizados",this.unsubscribeAll=new F.a,this.token=i.getToken(),this.identity=i.getIdentity()}return _createClass(t,[{key:"ngOnInit",value:function(){this.getTodo(),this.getTags()}},{key:"ngAfterViewInit",value:function(){var t=this;Object(j.a)(document.getElementById("searcher"),"keyup").pipe(Object(w.a)(250),Object(I.a)((function(t){return t.target.value}))).subscribe((function(e){var o=e[0];switch(t.todoList=t.searchTempList,o){case"#":var i=Number(e.split("#")[1]);t.todoList=t.searchTempList.filter((function(t){return t.numTodo==i}));break;case"@":var a=String(e.split("@")[1]);t.todoList=t.searchTempList.filter((function(t){var e="",o=t.users.map((function(t){return t.name.toLowerCase()+t.surname.toLowerCase()}));return console.log(o),o.forEach((function(t){e+=t})),e.includes(a.toLowerCase())}));break;case"*":var n=String(e.split("*")[1]).toLowerCase();t.todoList=t.searchTempList.filter((function(t){return t.note.toLowerCase().includes(n)}));break;default:var c=e.toLowerCase();t.todoList=t.searchTempList.filter((function(t){return t.title.toLowerCase().includes(c)}))}t.cdr.markForCheck()}))}},{key:"getTodo",value:function(){var t=this;this._todoService.getList(this.token,{company:this.identity.company._id}).subscribe((function(e){e.todos&&(t.tempList=e.todos,t.todoList=t.tempList.filter((function(e){var o;return-1!=(null===(o=e.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(t.identity._id))&&!e.done})),t.searchTempList=t.todoList,t.cdr.markForCheck())}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getTags",value:function(){var t=this;this._tagService.getList(this.token,{company:this.identity.company._id}).subscribe((function(e){e.tags&&(t.tags=e.tags)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"ngOnDestroy",value:function(){this.unsubscribeAll.next(),this.unsubscribeAll.complete()}},{key:"drop",value:function(t){Object(V.e)(this.todoList,t.previousIndex,t.currentIndex),this.cdr.markForCheck()}},{key:"filterTodoListOnTag",value:function(t){var e=new Array;this.tempList.forEach((function(o){if(o.tags)for(var i=0;i<o.tags.length;i++)if(o.tags[i].name==t.name){e.push(o);break}})),this.todoList=e}},{key:"onTodoOptionSelected",value:function(t){var e=this;switch(t.target.innerText){case"Todo":this.todoList=this.tempList,this.searchTempList=this.tempList,this.todoList.sort(this.compareDatesLow),this.filter="Todo";break;case"Todo - Pendientes":this.todoList=this.tempList.filter((function(t){return!t.done})),this.todoList.sort(this.compareDatesLow),this.searchTempList=this.todoList,this.filter="Todo - Pendientes";break;case"Todo - Realizados":this.todoList=this.tempList.filter((function(t){return t.done})),this.todoList.sort(this.compareDatesHigh),this.searchTempList=this.todoList,this.filter="Todo - Realizados";break;case"Todo - Mios":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))})),this.filter="Mios",this.searchTempList=this.todoList;break;case"Le\xeddo":this.todoList=this.tempList.filter((function(t){var o,i;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&(null===(i=t.usersWhoRead)||void 0===i?void 0:i.includes(e.identity._id))})),this.todoList.sort(this.compareDatesLow),this.filter="Le\xeddo",this.searchTempList=this.todoList;break;case"No Le\xeddo":this.todoList=this.tempList.filter((function(t){var o,i;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&!(null===(i=t.usersWhoRead)||void 0===i?void 0:i.includes(e.identity._id))})),this.todoList.sort(this.compareDatesLow),this.filter="No Le\xeddo",this.searchTempList=this.todoList;break;case"Importante":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&t.important})),this.todoList.sort(this.compareDatesLow),this.filter="Importante",this.searchTempList=this.todoList;break;case"No Importante":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&!t.important})),this.todoList.sort(this.compareDatesLow),this.filter="No Importante",this.searchTempList=this.todoList;break;case"Realizado":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&t.done})),this.todoList.sort(this.compareDatesHigh),this.filter="Realizado",this.searchTempList=this.todoList;break;case"No Realizado":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&!t.done})),this.todoList.sort(this.compareDatesLow),this.filter="No Realizado",this.searchTempList=this.todoList;break;case"Favorito":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&t.starred})),this.todoList.sort(this.compareDatesLow),this.filter="Favorito",this.searchTempList=this.todoList;break;case"No Favorito":this.todoList=this.tempList.filter((function(t){var o;return-1!=(null===(o=t.users)||void 0===o?void 0:o.map((function(t){return t._id})).indexOf(e.identity._id))&&!t.starred})),this.todoList.sort(this.compareDatesLow),this.filter="No favorito",this.searchTempList=this.todoList}this.cdr.detectChanges()}},{key:"compareDatesHigh",value:function(t,e){return t.startDate<e.startDate?1:-1}},{key:"compareDatesLow",value:function(t,e){return t.startDate<e.startDate?-1:1}},{key:"masterToggle",value:function(){var t=this;this.toggledItemNumber=0,this.isMasterToggled=!this.isMasterToggled,this.todoList.forEach(this.isMasterToggled?function(e){e.selected=!0,t.toggledItemNumber++}:function(e){e.selected=!1,t.toggledItemNumber--}),this.cdr.detectChanges()}},{key:"toggleCheckBox",value:function(t){t.selected=!t.selected,t.selected?this.toggledItemNumber++:this.toggledItemNumber--,this.toggledItemNumber==this.todoList.length?this.isMasterToggled=!0:0==this.toggledItemNumber&&(this.isMasterToggled=!1)}},{key:"toggleImportant",value:function(t){this.userInTodo(t)?(t.important=!t.important,this.updateTodo(t)):this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"toggleStar",value:function(t){this.userInTodo(t)?(t.starred=!t.starred,this.updateTodo(t)):this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"toggleRead",value:function(t){var e;(null===(e=t.usersWhoRead)||void 0===e?void 0:e.includes(this.identity._id))?t.usersWhoRead.splice(t.usersWhoRead.indexOf(this.identity._id),1):t.usersWhoRead.push(this.identity._id),this.updateTodo(t)}},{key:"toggleDone",value:function(t){this.userInTodo(t)?(t.done=!t.done,this.updateTodo(t)):this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"updateTodo",value:function(t){var e=this;this._todoService.edit(this.token,t._id,t).subscribe((function(t){}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"userInTodo",value:function(t){var e;return!!t.users&&-1!=(null===(e=t.users)||void 0===e?void 0:e.map((function(t){return t._id})).indexOf(this.identity._id))}},{key:"changeDate",value:function(t){return N(t).format("DD-MM-YYYY")}}]),t}()).\u0275fac=function(t){return new(t||et)(D.Vb(S),D.Vb(W.a),D.Vb(A.a),D.Vb(R),D.Vb(D.h),D.Vb(Y.a))},et.\u0275cmp=D.Pb({type:et,selectors:[["app-todo-list"]],viewQuery:function(t,e){var o;1&t&&D.bd(P,!0),2&t&&D.Ic(o=D.kc())&&(e.button=o.first)},decls:59,vars:9,consts:[[1,"page-layout","overflow-hidden","pb-8"],[1,"header-bg","dark-blue"],[1,"content"],["fxLayout","row wrap","fxLayoutAlign","center center",1,"content-header"],["fxFlex","1 1 0%",1,"search-box","mat-elevation-z2"],["mat-icon-button",""],["type","text","id","searcher","placeholder","Buscar una tarea por titulo (#: Por n\xfamero, @: Por nombre/apellido, *: Por descripci\xf3n)"],["serachTerm",""],[1,"content-body"],[1,"content-card","default-bg","height-100vh",3,"perfectScrollbar"],["fxLayoutGap","5px"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["tagMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["fxLayout","row","fxFlex","1 1 0%","fxLayoutAlign","start center"],["fxLayout","row","fxFlex","1 1 0%","fxLayoutAlign","end center"],["mat-raised-button","","color","primary","routerLink","/todo/add"],["cdkDropList","",1,"todo-list",3,"cdkDropListDropped"],["class","todo-box","fxLayout","row","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px","cdkDrag","","cdkDragHandle","",3,"ngClass",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","center center",1,"todo-box"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","20px","cdkDrag","","cdkDragHandle","",3,"ngClass"],["class","move-handler",4,"ngIf"],["style","font-size: 20px;",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center","fxFlex","1 1 0%"],["fxLayout","column","fxLayoutGap","8px","fxFlex","1 1 0%",2,"cursor","pointer",3,"routerLink"],["chipList",""],[4,"ngFor","ngForOf"],["fxFlexAlign","end center","fxLayout","row"],["mat-icon-button","",3,"click"],[3,"ngClass"],[3,"xPosition"],["menu2","matMenu"],[2,"vertical-align","middle"],[1,"move-handler"],[2,"font-size","20px"]],template:function(t,e){if(1&t&&(D.bc(0,"div",0),D.Wb(1,"div",1),D.bc(2,"div",2),D.bc(3,"div",3),D.bc(4,"div",4),D.bc(5,"button",5),D.bc(6,"mat-icon"),D.Vc(7,"search"),D.ac(),D.ac(),D.Wb(8,"input",6,7),D.ac(),D.ac(),D.bc(10,"div",8),D.bc(11,"div",9),D.bc(12,"mat-toolbar",10),D.bc(13,"button",11),D.bc(14,"mat-icon"),D.Vc(15,"arrow_drop_down"),D.ac(),D.ac(),D.bc(16,"mat-menu",null,12),D.bc(18,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(19,"Todo"),D.ac(),D.bc(20,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(21,"Todo - Pendientes"),D.ac(),D.bc(22,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(23,"Todo - Realizados"),D.ac(),D.bc(24,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(25,"Todo - Mios"),D.ac(),D.bc(26,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(27,"Realizado"),D.ac(),D.bc(28,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(29,"No realizado"),D.ac(),D.bc(30,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(31,"Le\xeddo"),D.ac(),D.bc(32,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(33,"No le\xeddo"),D.ac(),D.bc(34,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(35," Favorito "),D.ac(),D.bc(36,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(37," No favorito "),D.ac(),D.bc(38,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(39," Importante "),D.ac(),D.bc(40,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected(t)})),D.Vc(41," No importante "),D.ac(),D.ac(),D.bc(42,"button",11),D.bc(43,"mat-icon"),D.Vc(44,"label"),D.ac(),D.ac(),D.bc(45,"mat-menu",null,14),D.bc(47,"button",13),D.jc("click",(function(t){return e.onTodoOptionSelected({target:{innerText:"Todo"}})})),D.Vc(48," Todo "),D.ac(),D.Tc(49,X,2,1,"button",15),D.ac(),D.bc(50,"div",16),D.Vc(51),D.ac(),D.bc(52,"div",17),D.bc(53,"button",18),D.Vc(54," Crear tarea "),D.ac(),D.ac(),D.ac(),D.bc(55,"div",19),D.jc("cdkDropListDropped",(function(t){return e.drop(t)})),D.Tc(56,q,2,0,"div",20),D.Tc(57,tt,37,23,"div",21),D.oc(58,"todoSearch"),D.ac(),D.ac(),D.ac(),D.ac(),D.ac()),2&t){var o=D.Jc(17),i=D.Jc(46);D.Gb(13),D.uc("matMenuTriggerFor",o),D.Gb(29),D.uc("matMenuTriggerFor",i),D.Gb(7),D.uc("ngForOf",e.tags),D.Gb(2),D.Xc(" ",e.filter," "),D.Gb(5),D.uc("ngIf",(null==e.todoList?null:e.todoList.length)<1),D.Gb(1),D.uc("ngForOf",D.qc(58,6,e.todoList,e.searchTerm))}},directives:[z.d,z.c,z.b,u.b,g.a,r.b,y.a,z.e,k.c,k.d,k.a,L.l,C.h,V.c,L.m,V.a,V.b,L.k,J.a,l.b,z.a,l.a],pipes:[$],styles:[".readed[_ngcontent-%COMP%]{background-color:#d3d3d3}.done[_ngcontent-%COMP%]{background-color:#90ee90}"],changeDetection:0}),et),it=function t(e,o,i){_classCallCheck(this,t),this._id=e,this.name=o,this.company=i};function at(t,e){if(1&t){var o=D.cc();D.bc(0,"button",9),D.jc("click",(function(t){D.Mc(o);var e=D.nc().$implicit;return D.nc().deleteTag(e)})),D.Vc(1,"Eliminar"),D.ac()}}function nt(t,e){if(1&t&&(D.bc(0,"div",0),D.bc(1,"span"),D.Vc(2),D.ac(),D.Tc(3,at,2,0,"button",8),D.ac()),2&t){var o=e.$implicit,i=D.nc();D.Gb(2),D.Wc(o.name),D.Gb(1),D.uc("ngIf","ROLE_ADMIN"!=i.identity.role)}}var ct,rt=((ct=function(){function t(e,o,i,a,n){_classCallCheck(this,t),this.snackBar=e,this.dialogRef=o,this.data=i,this._tagService=a,this._userService=n,this.token=n.getToken(),this.identity=n.getIdentity()}return _createClass(t,[{key:"ngOnInit",value:function(){this.getTags()}},{key:"getTags",value:function(){var t=this;this._tagService.getList(this.token,{company:this.identity.company._id}).subscribe((function(e){e.tags&&(t.tags=e.tags)}))}},{key:"addTag",value:function(t){var e=this,o=new it("",t,this.identity.company._id);this._tagService.add(this.token,o).subscribe((function(t){t.tag&&e.getTags()}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"deleteTag",value:function(t){var e=this;this._tagService.delete(this.token,t._id).subscribe((function(t){t.tag&&e.getTags()}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}}]),t}()).\u0275fac=function(t){return new(t||ct)(D.Vb(Y.a),D.Vb(p.g),D.Vb(p.a),D.Vb(R),D.Vb(A.a))},ct.\u0275cmp=D.Pb({type:ct,selectors:[["app-tag-dialogue"]],decls:12,vars:1,consts:[["fxLayout","row","fxLayoutAlign","space-between center"],["matInput","","placeholder","Nueva etiqueta","required","",3,"keyup.enter"],["tagInput",""],["color","primary","mat-raised-button","",3,"click"],["fxLayout","column","fxLayoutGap","16px",2,"margin-top","20px"],["fxLayout","row","fxLayoutAlign","space-between center",4,"ngFor","ngForOf"],["align","end"],["mat-button","","mat-dialog-close",""],["color","warn","mat-raised-button","",3,"click",4,"ngIf"],["color","warn","mat-raised-button","",3,"click"]],template:function(t,e){if(1&t){var o=D.cc();D.bc(0,"mat-dialog-content"),D.bc(1,"div",0),D.bc(2,"mat-form-field"),D.bc(3,"input",1,2),D.jc("keyup.enter",(function(t){D.Mc(o);var i=D.Jc(4);return e.addTag(i.value),i.value=""})),D.ac(),D.ac(),D.bc(5,"button",3),D.jc("click",(function(t){D.Mc(o);var i=D.Jc(4);return e.addTag(i.value),i.value=""})),D.Vc(6,"A\xf1adir"),D.ac(),D.ac(),D.bc(7,"div",4),D.Tc(8,nt,4,2,"div",5),D.ac(),D.ac(),D.bc(9,"mat-dialog-actions",6),D.bc(10,"button",7),D.Vc(11,"Cerrar"),D.ac(),D.ac()}2&t&&(D.Gb(8),D.uc("ngForOf",e.tags))},directives:[p.e,z.d,z.c,m.a,v.b,u.b,z.e,L.l,p.c,p.d,L.m],styles:[""],changeDetection:0}),ct),st=o("3uMe"),ut=o("47Ty"),dt=o("AV9v"),lt=o("sd1j"),ft=o("Q2c7"),ht=o("d3UM");function pt(t,e){if(1&t&&(D.bc(0,"mat-option",10),D.Vc(1),D.ac()),2&t){var o=e.$implicit;D.uc("value",o),D.Gb(1),D.Xc(" ",o," ")}}function bt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",11),D.bc(1,"mat-form-field",4),D.bc(2,"input",12),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().firstDate=t})),D.ac(),D.Wb(3,"mat-datepicker-toggle",13),D.Wb(4,"mat-datepicker",null,14),D.ac(),D.ac()}if(2&t){var i=D.Jc(5),a=D.nc();D.Gb(2),D.uc("ngModel",a.firstDate)("matDatepicker",i),D.Gb(1),D.uc("for",i)}}function mt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",15),D.bc(1,"div",16),D.bc(2,"div",17),D.bc(3,"div",18),D.bc(4,"div",17),D.bc(5,"div",19),D.bc(6,"label",20),D.Vc(7,"Lun"),D.ac(),D.ac(),D.ac(),D.bc(8,"div",17),D.bc(9,"div",19),D.bc(10,"input",21,22),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().dayOfWeek.lun=t})),D.ac(),D.ac(),D.ac(),D.ac(),D.bc(12,"div",18),D.bc(13,"div",17),D.bc(14,"div",19),D.bc(15,"label",20),D.Vc(16,"Mar"),D.ac(),D.ac(),D.ac(),D.bc(17,"div",17),D.bc(18,"div",19),D.bc(19,"input",23,24),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().dayOfWeek.mar=t})),D.ac(),D.ac(),D.ac(),D.ac(),D.bc(21,"div",18),D.bc(22,"div",17),D.bc(23,"div",19),D.bc(24,"label",20),D.Vc(25,"Mie"),D.ac(),D.ac(),D.ac(),D.bc(26,"div",17),D.bc(27,"div",19),D.bc(28,"input",25,26),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().dayOfWeek.mie=t})),D.ac(),D.ac(),D.ac(),D.ac(),D.bc(30,"div",18),D.bc(31,"div",17),D.bc(32,"div",19),D.bc(33,"label",20),D.Vc(34,"Jue"),D.ac(),D.ac(),D.ac(),D.bc(35,"div",17),D.bc(36,"div",19),D.bc(37,"input",27,28),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().dayOfWeek.jue=t})),D.ac(),D.ac(),D.ac(),D.ac(),D.bc(39,"div",18),D.bc(40,"div",17),D.bc(41,"div",19),D.bc(42,"label",20),D.Vc(43,"Vie"),D.ac(),D.ac(),D.ac(),D.bc(44,"div",17),D.bc(45,"div",19),D.bc(46,"input",29,30),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().dayOfWeek.vie=t})),D.ac(),D.ac(),D.ac(),D.ac(),D.bc(48,"div",18),D.bc(49,"div",17),D.bc(50,"div",19),D.bc(51,"label",20),D.Vc(52,"Sab"),D.ac(),D.ac(),D.ac(),D.bc(53,"div",17),D.bc(54,"div",19),D.bc(55,"input",31,32),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().dayOfWeek.sab=t})),D.ac(),D.ac(),D.ac(),D.ac(),D.ac(),D.ac(),D.ac()}if(2&t){var i=D.nc();D.Gb(10),D.uc("ngModel",i.dayOfWeek.lun),D.Gb(9),D.uc("ngModel",i.dayOfWeek.mar),D.Gb(9),D.uc("ngModel",i.dayOfWeek.mie),D.Gb(9),D.uc("ngModel",i.dayOfWeek.jue),D.Gb(9),D.uc("ngModel",i.dayOfWeek.vie),D.Gb(9),D.uc("ngModel",i.dayOfWeek.sab)}}function gt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",11),D.bc(1,"mat-form-field",4),D.bc(2,"input",33),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().lastDate=t})),D.ac(),D.Wb(3,"mat-datepicker-toggle",13),D.Wb(4,"mat-datepicker",null,34),D.ac(),D.ac()}if(2&t){var i=D.Jc(5),a=D.nc();D.Gb(2),D.uc("ngModel",a.lastDate)("matDatepicker",i),D.Gb(1),D.uc("for",i)}}function vt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",11),D.bc(1,"mat-form-field",4),D.bc(2,"input",12),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().firstDate=t})),D.ac(),D.Wb(3,"mat-datepicker-toggle",13),D.Wb(4,"mat-datepicker",null,35),D.ac(),D.ac()}if(2&t){var i=D.Jc(5),a=D.nc();D.Gb(2),D.uc("ngModel",a.firstDate)("matDatepicker",i),D.Gb(1),D.uc("for",i)}}function kt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",15),D.bc(1,"mat-form-field",4),D.bc(2,"input",36),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().forDays=t})),D.ac(),D.ac(),D.ac()}if(2&t){var i=D.nc();D.Gb(2),D.uc("ngModel",i.forDays)}}function yt(t,e){if(1&t){var o=D.cc();D.bc(0,"div",11),D.bc(1,"mat-form-field",4),D.bc(2,"input",33),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().lastDate=t})),D.ac(),D.Wb(3,"mat-datepicker-toggle",13),D.Wb(4,"mat-datepicker",null,37),D.ac(),D.ac()}if(2&t){var i=D.Jc(5),a=D.nc();D.Gb(2),D.uc("ngModel",a.lastDate)("matDatepicker",i),D.Gb(1),D.uc("for",i)}}var Tt,Lt=((Tt=function(){function t(e,o,i){_classCallCheck(this,t),this.data=e,this.dialogRef=o,this.snackBar=i,this.types=["Cada semana","Cada X d\xedas"],this.dayOfWeek={lun:!1,mar:!1,mie:!1,jue:!1,vie:!1,sab:!1},this.forDays=1}return _createClass(t,[{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"submit",value:function(){if(!this.check())return this.openSnackBar("Faltan campos para completar","Cerrar");this.dialogRef.close({type:this.type,dayOfWeek:this.dayOfWeek,firstDate:this.firstDate,lastDate:this.lastDate,forDays:this.forDays})}},{key:"check",value:function(){return!!(""!=this.type&&this.firstDate&&this.lastDate&&this.forDays)}}]),t}()).\u0275fac=function(t){return new(t||Tt)(D.Vb(p.a),D.Vb(p.g),D.Vb(Y.a))},Tt.\u0275cmp=D.Pb({type:Tt,selectors:[["app-todo-repite-popop"]],decls:18,vars:8,consts:[["matDialogTitle",""],[1,"p-0"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","100",1,"pr-1"],[1,"full-width"],["placeholder","Tipo de repetici\xf3n",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","25","class","pr-1",4,"ngIf"],["fxFlex","50","class","pr-1",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[3,"value"],["fxFlex","25",1,"pr-1"],["name","firstDate","matInput","","placeholder","Fecha de inicio","required","",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["picker4",""],["fxFlex","50",1,"pr-1"],[1,"form-group"],[1,"form-row"],[1,"col-2","col-sm-2","col-md-2","col-lg-2","col-xl-2"],[1,"col","text-center"],[1,"col-form-label"],["type","checkbox","name","lun",3,"ngModel","ngModelChange"],["lun","ngModel"],["type","checkbox","name","mar",3,"ngModel","ngModelChange"],["mar","ngModel"],["type","checkbox","name","mie",3,"ngModel","ngModelChange"],["mie","ngModel"],["type","checkbox","name","jue",3,"ngModel","ngModelChange"],["jue","ngModel"],["type","checkbox","name","vie",3,"ngModel","ngModelChange"],["vie","ngModel"],["type","checkbox","name","sab",3,"ngModel","ngModelChange"],["sab","ngModel"],["name","lastDate","matInput","","placeholder","Fecha de fin","required","",3,"ngModel","matDatepicker","ngModelChange"],["picker2",""],["picker",""],["matInput","","type","number","min","1","placeholder","\xbfRepetir cada cuantos d\xedas?","name","forDays",3,"ngModel","ngModelChange"],["picker3",""]],template:function(t,e){1&t&&(D.bc(0,"h1",0),D.Vc(1),D.ac(),D.bc(2,"mat-card",1),D.bc(3,"mat-card-content"),D.bc(4,"form"),D.bc(5,"div",2),D.bc(6,"div",3),D.bc(7,"mat-form-field",4),D.bc(8,"mat-select",5),D.jc("selectionChange",(function(t){return e.type=t.value})),D.Tc(9,pt,2,2,"mat-option",6),D.ac(),D.ac(),D.ac(),D.Tc(10,bt,6,3,"div",7),D.Tc(11,mt,57,6,"div",8),D.Tc(12,gt,6,3,"div",7),D.Tc(13,vt,6,3,"div",7),D.Tc(14,kt,3,1,"div",8),D.Tc(15,yt,6,3,"div",7),D.ac(),D.bc(16,"button",9),D.jc("click",(function(t){return e.submit()})),D.Vc(17,"Guardar"),D.ac(),D.ac(),D.ac(),D.ac()),2&t&&(D.Gb(1),D.Wc(e.data.title),D.Gb(8),D.uc("ngForOf",e.types),D.Gb(1),D.uc("ngIf","Cada semana"==e.type),D.Gb(1),D.uc("ngIf","Cada semana"==e.type),D.Gb(1),D.uc("ngIf","Cada semana"==e.type),D.Gb(1),D.uc("ngIf","Cada X d\xedas"==e.type),D.Gb(1),D.uc("ngIf","Cada X d\xedas"==e.type),D.Gb(1),D.uc("ngIf","Cada X d\xedas"==e.type))},directives:[p.h,M.a,M.c,s.x,s.o,s.p,z.d,z.b,m.a,ht.a,L.l,L.m,u.b,f.p,v.b,s.c,h.b,s.u,s.n,s.q,h.d,m.e,h.a,s.a,s.s],encapsulation:2}),Tt);function xt(t,e){if(1&t){var o=D.cc();D.bc(0,"button",45),D.jc("click",(function(t){return D.Mc(o),D.nc().openRepiteTodos()})),D.bc(1,"mat-icon",46),D.Vc(2,"alarm_add"),D.ac(),D.ac()}if(2&t){var i=D.nc();D.Gb(1),D.uc("color",i.repite?"warn":"")}}function Mt(t,e){if(1&t&&(D.bc(0,"button",47),D.bc(1,"mat-icon"),D.Vc(2,"person_add"),D.ac(),D.ac()),2&t){D.nc();var o=D.Jc(11);D.uc("matMenuTriggerFor",o)}}function Ct(t,e){if(1&t){var o=D.cc();D.bc(0,"button",48),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().setAgent(i)})),D.Vc(1),D.ac()}if(2&t){var i=e.$implicit;D.Gb(1),D.Yc(" ",i.name," ",i.surname," ")}}function _t(t,e){if(1&t){var o=D.cc();D.bc(0,"button",48),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().updateTodoTag(i)})),D.Vc(1),D.ac()}if(2&t){var i=e.$implicit;D.Gb(1),D.Xc(" ",i.name," ")}}function Dt(t,e){if(1&t){var o=D.cc();D.bc(0,"div"),D.bc(1,"mat-chip",49),D.jc("removed",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().removeTagFromTodo(i)})),D.bc(2,"span"),D.bc(3,"mat-icon",50),D.Vc(4,"label"),D.ac(),D.Vc(5),D.ac(),D.bc(6,"mat-icon",51),D.Vc(7,"cancel"),D.ac(),D.ac(),D.ac()}if(2&t){var i=e.$implicit;D.Gb(1),D.uc("selectable",!0)("removable",!0),D.Gb(4),D.Wc(i.name)}}function Gt(t,e){if(1&t){var o=D.cc();D.bc(0,"div"),D.bc(1,"mat-chip",49),D.jc("removed",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().deleteAgent(i)})),D.bc(2,"span"),D.bc(3,"mat-icon",50),D.Vc(4,"person"),D.ac(),D.Vc(5),D.ac(),D.bc(6,"mat-icon",51),D.Vc(7,"cancel"),D.ac(),D.ac(),D.ac()}if(2&t){var i=e.$implicit;D.Gb(1),D.uc("selectable",!0)("removable",!0),D.Gb(4),D.Yc("",i.name," ",i.surname,"")}}function St(t,e){if(1&t&&D.Wb(0,"input",52),2&t){var o=D.nc();D.uc("value",(null==o.todo.userCreate?null:o.todo.userCreate.name)+" "+(null==o.todo.userCreate?null:o.todo.userCreate.surname))}}function Ot(t,e){1&t&&D.Wb(0,"input",53)}function Vt(t,e){if(1&t){var o=D.cc();D.bc(0,"mat-form-field"),D.bc(1,"textarea",54),D.jc("ngModelChange",(function(t){return D.Mc(o),D.nc().todo.response=t})),D.ac(),D.ac()}if(2&t){var i=D.nc();D.Gb(1),D.uc("ngModel",i.todo.response)}}function wt(t,e){if(1&t){var o=D.cc();D.bc(0,"mat-option",55),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().setTeam(i)})),D.Vc(1),D.ac()}if(2&t){var i=e.$implicit;D.uc("value",i.name),D.Gb(1),D.Wc(i.name)}}function It(t,e){if(1&t){var o=D.cc();D.bc(0,"button",56),D.jc("click",(function(t){return D.Mc(o),D.nc(),D.Jc(73).clear(t)})),D.bc(1,"mat-icon"),D.Vc(2,"clear"),D.ac(),D.ac()}}function Ft(t,e){if(1&t){var o=D.cc();D.bc(0,"div",32),D.bc(1,"mat-chip",57),D.jc("click",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().goToLink(i)}))("removed",(function(t){D.Mc(o);var i=e.$implicit;return D.nc().removeFileFromTodo(i)})),D.bc(2,"span"),D.bc(3,"mat-icon",50),D.Vc(4,"attach_file"),D.ac(),D.Vc(5),D.ac(),D.bc(6,"mat-icon",51),D.Vc(7,"cancel"),D.ac(),D.ac(),D.ac()}if(2&t){var i=e.index;D.Gb(1),D.uc("selectable",!0)("removable",!0),D.Gb(4),D.Xc("Archivo ",i+1,"")}}function jt(t,e){if(1&t){var o=D.cc();D.bc(0,"button",58),D.jc("click",(function(t){return D.Mc(o),D.nc().saveTodo(!0)})),D.Vc(1,"Guardar y finalizar"),D.ac()}}var Wt,At,Bt=function(t){return{"fill-color-warn":t}},Rt=function(t){return{"fill-color-accent":t}},Nt=((Wt=function(){function t(e,o,i,a,n,c,r,s,u,d,l,f){_classCallCheck(this,t),this.todoService=e,this.tagDialogue=o,this._userService=i,this._todoService=a,this._tagService=n,this._teamService=c,this._notificationService=r,this.router=s,this.snackBar=u,this.route=d,this._uploadService=l,this.cdr=f,this.todo={title:"",note:"",response:"",startDate:"",dueDate:"",done:!1,important:!1,starred:!1,read:!1,selected:!1,tags:[],users:[],usersWhoRead:[],files:[],company:""},this.url=B.a.url,this.teamName="",this.token=i.getToken(),this.identity=i.getIdentity(),this.agentsIn=new Array}return _createClass(t,[{key:"ngOnInit",value:function(){this.getTodo(),this.getTags(),this.getTeams()}},{key:"getTodo",value:function(){var t=this,e=this.route.snapshot.params.id;e&&this._todoService.getOne(this.token,e).subscribe((function(e){e.todo&&(t.todo=e.todo,t.cdr.markForCheck(),t.todo.users&&(t.agentsIn=t.todo.users),t.todo.team&&(t.teamName=t.todo.team.name,t.getAgents(t.todo.team.users)))}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"getAgents",value:function(t){this.agents=t}},{key:"setAgent",value:function(t){this.agentsIn.push(t)}},{key:"deleteAgent",value:function(t){this.agentsIn.splice(this.agentsIn.indexOf(t),1)}},{key:"getTeams",value:function(){var t=this;this._teamService.getList(this.token,this.identity.company._id).subscribe((function(e){e.teams&&(t.teams=e.teams)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"setTeam",value:function(t){this.todo.team=t._id,this.agentsIn=new Array,this.getAgents(t.users)}},{key:"saveTodo",value:function(t){var e=this;if(0==this.agentsIn.length)return this.openSnackBar("Se debe asignar alg\xfan agente responsable de esta tarea","Cerrar");if(t&&(this.todo.done=!0),this.agentsIn){var o=new Array;this.agentsIn.forEach((function(t){o.push(t._id)})),this.todo.users=o}this.todo.company=this.identity.company._id,this.todo._id?this._todoService.edit(this.token,this.todo._id,this.todo).subscribe((function(t){if(t.todo){e.uploadFile(t.todo._id);var o={todo:e.todo._id};0==e.todo.done&&e._notificationService.getList(e.token,o).subscribe((function(t){t.notifications&&(t.notifications.forEach((function(t){if(-1!=e.todo.users.indexOf(t.user)){e.todo.users.splice(e.todo.users.indexOf(t.user),1),t.message=e.todo.title;var o=N(e.todo.startDate).format("YYYY-MM-DD HH:mm");t.date=o,t.dateInit=o,e._notificationService.edit(e.token,t._id,t).subscribe((function(t){}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}else e._notificationService.delete(e.token,t._id).subscribe((function(t){}),(function(t){e.openSnackBar(t.message,"Cerrar")}))})),e.todo.users.length>0&&e.todo.users.forEach((function(t){var o=N(e.todo.startDate).format("YYYY-MM-DD HH:mm"),i=new dt.a("",e.todo.title,"list_alt",o,o,"todo/list/"+e.todo._id,"accent",t,null,e.todo._id);e._notificationService.add(e.token,i).subscribe((function(t){}),(function(t){}))})))}),(function(t){e.openSnackBar(t.message,"Cerrar")})),e.router.navigateByUrl("/todo/list")}}),(function(t){e.openSnackBar(t.message,"Cerrar")})):(this.todo.userCreate=this.identity._id,this.repite?this.getRepiteDates().forEach((function(t){e.todo.startDate=N(t).format("YYYY-MM-DD"),e.todo.dueDate=N(t).format("YYYY-MM-DD"),e.addTodo()})):this.addTodo())}},{key:"getRepiteDates",value:function(){var t=new Array,e=N(this.repite.firstDate),o=this.repite.lastDate;if("Cada semana"==this.repite.type){var i=this.repite.dayOfWeek,a=[];if(i.lun&&a.push(1),i.mar&&a.push(2),i.mie&&a.push(3),i.jue&&a.push(4),i.vie&&a.push(5),i.sab&&a.push(6),!a.includes(e.weekday()))for(e.add(1,"day");!a.includes(e.weekday());)e.add(1,"day");for(;e.isBefore(o);)a.includes(e.weekday())&&t.push(e.format("YYYY-MM-DD")),e.add(1,"day")}else{var n=this.repite.forDays;for(t.push(e.format("YYYY-MM-DD"));e.isBefore(o);)e.add(n,"day"),0==e.weekday()&&e.add(1,"day"),t.push(e.format("YYYY-MM-DD"))}return t}},{key:"addTodo",value:function(){var t=this;this._todoService.add(this.token,this.todo).subscribe((function(e){e.todo&&(t.uploadFile(e.todo._id),t.todo.users.forEach((function(o){var i=N(t.todo.startDate).format("YYYY-MM-DD HH:mm"),a=new dt.a("",t.todo.title,"list_alt",i,i,"todo/list/"+e.todo._id,"accent",o,null,e.todo._id);t._notificationService.add(t.token,a).subscribe((function(t){}),(function(t){}))})),t.router.navigateByUrl("/todo/list"))}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"uploadFile",value:function(t){var e=this;null!=this.files&&null!=this.files&&this._uploadService.makeFileRequest(this.url+"todo/file/"+t,[],this.files.files,this.token,"file").then((function(t){}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"deleteTodo",value:function(){var t=this;""!=this.todo._id?this._todoService.delete(this.token,this.todo._id).subscribe((function(e){e.todo&&t.router.navigateByUrl("/todo/list")}),(function(e){t.openSnackBar(e.message,"Cerrar")})):this.router.navigateByUrl("/todo/list")}},{key:"getTags",value:function(){var t=this;this._tagService.getList(this.token,{company:this.identity.company._id}).subscribe((function(e){e.tags&&(t.tagList=e.tags)}),(function(e){t.openSnackBar(e.message,"Cerrar")}))}},{key:"updateTodoTag",value:function(t){var e=this;this._todoService.addTag(this.token,this.todo._id,t._id).subscribe((function(o){o.todo&&e.todo.tags.push(t)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"removeTagFromTodo",value:function(t){var e=this;this._todoService.removeTag(this.token,this.todo._id,t._id).subscribe((function(o){o.todo&&e.todo.tags.splice(e.todo.tags.indexOf(t),1)}),(function(t){e.openSnackBar(t.message,"Cerrar")}))}},{key:"openTagManaginDialogue",value:function(){var t=this;this.tagDialogue.open(rt,{}).afterClosed().subscribe((function(e){t.getTags()}))}},{key:"openRepiteTodos",value:function(){var t=this;this.tagDialogue.open(Lt,{width:"80%",data:{title:"Repetici\xf3n"}}).afterClosed().subscribe((function(e){e&&(t.repite=e,t.todo.startDate=t.repite.fistDate,t.todo.dueDate=t.repite.lastDate)}))}},{key:"toggleImportant",value:function(){this.userInTodo()?this.todo.important=!this.todo.important:this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"toggleStar",value:function(){this.userInTodo()?this.todo.starred=!this.todo.starred:this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"toggleRead",value:function(){this.userInTodo()?(1==this.todo.read?this.todo.usersWhoRead.splice(this.todo.usersWhoRead.indexOf(this.identity._id),1):this.todo.usersWhoRead.push(this.identity._id),this.todo.read=!this.todo.read):this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"toggleDone",value:function(){this.userInTodo()?this.todo.done=!this.todo.done:this.openSnackBar("No tienes permisos para modificar esta tarea","Cerrar")}},{key:"userInTodo",value:function(){var t;return!!this.todo.users&&-1!=(null===(t=this.todo.users)||void 0===t?void 0:t.map((function(t){return t._id})).indexOf(this.identity._id))}},{key:"openSnackBar",value:function(t,e){this.snackBar.open(t,e,{duration:1e4})}},{key:"checkExt",value:function(t){var e=t.split(".")[1];return("pdf"==e||"xlsx"==e||"xls"==e||"msg"==e||"docx"==e||"odt"==e||"rar"==e||"zip"==e||"png"==e||"jpge"==e||"jpeg"==e||"jpg"==e||"tif"==e||"tiff"==e)&&e}},{key:"goToLink",value:function(t){window.open(this.url+"todo/file/"+t,"_blank")}},{key:"removeFileFromTodo",value:function(t){this.todo.files.splice(this.todo.files.indexOf(t),1)}}]),t}()).\u0275fac=function(t){return new(t||Wt)(D.Vb(S),D.Vb(p.b),D.Vb(A.a),D.Vb(W.a),D.Vb(R),D.Vb(st.a),D.Vb(ut.a),D.Vb(C.g),D.Vb(Y.a),D.Vb(C.a),D.Vb(ft.a),D.Vb(D.h))},Wt.\u0275cmp=D.Pb({type:Wt,selectors:[["app-todo-details"]],features:[D.Fb([{provide:f.c,useClass:lt.b},{provide:f.f,useValue:lt.a},ut.a,ft.a])],decls:85,vars:41,consts:[["mat-icon-button","","routerLink","/todo/list"],[2,"margin-left","16px","font-size","14px",3,"checked","change"],["fxLayout","row","fxFlex","1 1 0%","fxLayoutAlign","end center"],["mat-icon-button","","matTooltip","A\xf1adir repetici\xf3n",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","A\xf1adir responsable",3,"matMenuTriggerFor",4,"ngIf"],[3,"xPosition"],["users","matMenu"],["style","text-transform: capitalize;","mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-icon-button","",3,"matTooltip","click"],[3,"ngClass"],["mat-icon-button","","matTooltip","Etiquetas",3,"click"],["mat-icon-button","","matTooltip","A\xf1adir etiqueta",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-icon-button","","matTooltip","Eliminar",3,"click"],[2,"margin","20px 0px 0px 16px"],["chipListTag",""],[4,"ngFor","ngForOf"],["chipListAgent",""],["fxLayout","column","fxLayoutGap","8px",2,"padding","0px 16px","margin-top","20px"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","50px"],[1,"full-width"],["type","text","name","title","matInput","","placeholder","T\xedtulo","required","",3,"ngModel","ngModelChange"],["readonly","","type","text","name","userCreate","matInput","","placeholder","Creado por",3,"value",4,"ngIf"],["readonly","","value","Sin descripci\xf3n","type","text","name","userCreate","matInput","","placeholder","Creado por",4,"ngIf"],["name","note","matInput","","placeholder","Nota","matTextareaAutosize","",3,"ngModel","ngModelChange"],[4,"ngIf"],["name","startDate","matInput","","placeholder","Fecha de inicio","required","",3,"ngModel","matDatepicker","ngModelChange"],["matSuffix","",3,"for"],["picker",""],["name","dueDate","matInput","","placeholder","Fecha de vencimiento","required","",3,"ngModel","matDatepicker","ngModelChange"],["picker2",""],["fxLayout","row","fxLayoutAlign","start center"],["fxFlex",""],["name","teamName",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],["fxFlex","","name","files","placeholder","Adjuntar archivos","multiple","",3,"ngModel","ngModelChange"],["removableInput",""],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["fxFlex","6px"],["chipListFile",""],["fxFlex","",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","16px"],["type","button","mat-button","","routerLink","/todo/list"],["color","primary","mat-raised-button","",3,"click"],["type","primary","color","accent","mat-raised-button","",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","A\xf1adir repetici\xf3n",3,"click"],[3,"color"],["mat-icon-button","","matTooltip","A\xf1adir responsable",3,"matMenuTriggerFor"],["mat-menu-item","",2,"text-transform","capitalize",3,"click"],["fxLayout","row","fxLayoutAlign","center center",3,"selectable","removable","removed"],[2,"font-size","18px"],["matChipRemove",""],["readonly","","type","text","name","userCreate","matInput","","placeholder","Creado por",3,"value"],["readonly","","value","Sin descripci\xf3n","type","text","name","userCreate","matInput","","placeholder","Creado por"],["name","response","matInput","","placeholder","Respuesta","matTextareaAutosize","",3,"ngModel","ngModelChange"],[3,"value","click"],["mat-icon-button","","matSuffix","",3,"click"],["fxLayout","row","fxLayoutAlign","center center",3,"selectable","removable","click","removed"],["type","primary","color","accent","mat-raised-button","",3,"click"]],template:function(t,e){if(1&t&&(D.bc(0,"mat-toolbar"),D.bc(1,"button",0),D.bc(2,"mat-icon"),D.Vc(3,"arrow_back"),D.ac(),D.ac(),D.bc(4,"mat-checkbox",1),D.jc("change",(function(t){return e.toggleDone()})),D.bc(5,"span"),D.Vc(6),D.ac(),D.ac(),D.bc(7,"div",2),D.Tc(8,xt,3,1,"button",3),D.Tc(9,Mt,3,1,"button",4),D.bc(10,"mat-menu",5,6),D.Tc(12,Ct,2,2,"button",7),D.ac(),D.bc(13,"button",8),D.jc("click",(function(t){return e.toggleRead()})),D.bc(14,"mat-icon"),D.Vc(15),D.ac(),D.ac(),D.bc(16,"button",8),D.jc("click",(function(t){return e.toggleImportant()})),D.bc(17,"mat-icon",9),D.Vc(18),D.ac(),D.ac(),D.bc(19,"button",8),D.jc("click",(function(t){return e.toggleStar()})),D.bc(20,"mat-icon",9),D.Vc(21),D.ac(),D.ac(),D.bc(22,"button",10),D.jc("click",(function(t){return e.openTagManaginDialogue()})),D.bc(23,"mat-icon"),D.Vc(24,"library_add"),D.ac(),D.ac(),D.bc(25,"button",11),D.bc(26,"mat-icon"),D.Vc(27,"label"),D.ac(),D.ac(),D.bc(28,"mat-menu",5,12),D.Tc(30,_t,2,1,"button",7),D.ac(),D.bc(31,"button",13),D.jc("click",(function(t){return e.deleteTodo()})),D.bc(32,"mat-icon"),D.Vc(33,"delete_outline"),D.ac(),D.ac(),D.ac(),D.ac(),D.bc(34,"div",14),D.bc(35,"mat-chip-list",null,15),D.Tc(37,Dt,8,3,"div",16),D.ac(),D.bc(38,"mat-chip-list",null,17),D.Tc(40,Gt,8,4,"div",16),D.ac(),D.ac(),D.bc(41,"form",18),D.bc(42,"div",19),D.bc(43,"mat-form-field",20),D.bc(44,"input",21),D.jc("ngModelChange",(function(t){return e.todo.title=t})),D.ac(),D.ac(),D.bc(45,"mat-form-field",20),D.Tc(46,St,1,1,"input",22),D.Tc(47,Ot,1,0,"input",23),D.ac(),D.ac(),D.bc(48,"mat-form-field"),D.bc(49,"textarea",24),D.jc("ngModelChange",(function(t){return e.todo.note=t})),D.ac(),D.ac(),D.Tc(50,Vt,2,1,"mat-form-field",25),D.bc(51,"div",19),D.bc(52,"mat-form-field"),D.bc(53,"input",26),D.jc("ngModelChange",(function(t){return e.todo.startDate=t})),D.ac(),D.Wb(54,"mat-datepicker-toggle",27),D.Wb(55,"mat-datepicker",null,28),D.ac(),D.bc(57,"mat-form-field"),D.bc(58,"input",29),D.jc("ngModelChange",(function(t){return e.todo.dueDate=t})),D.ac(),D.Wb(59,"mat-datepicker-toggle",27),D.Wb(60,"mat-datepicker",null,30),D.ac(),D.ac(),D.bc(62,"div",31),D.bc(63,"mat-form-field",32),D.bc(64,"mat-label"),D.Vc(65,"Equipo"),D.ac(),D.bc(66,"mat-select",33),D.jc("ngModelChange",(function(t){return e.teamName=t})),D.bc(67,"mat-option"),D.Vc(68),D.ac(),D.Tc(69,wt,2,2,"mat-option",34),D.ac(),D.ac(),D.ac(),D.bc(70,"div",31),D.bc(71,"mat-form-field"),D.bc(72,"ngx-mat-file-input",35,36),D.jc("ngModelChange",(function(t){return e.files=t})),D.ac(),D.Tc(74,It,3,0,"button",37),D.ac(),D.Wb(75,"span",38),D.bc(76,"mat-chip-list",null,39),D.Tc(78,Ft,8,3,"div",40),D.ac(),D.ac(),D.bc(79,"div",41),D.bc(80,"button",42),D.Vc(81,"Cancelar"),D.ac(),D.bc(82,"button",43),D.jc("click",(function(t){return e.saveTodo(!1)})),D.Vc(83,"Guardar"),D.ac(),D.Tc(84,jt,2,0,"button",44),D.ac(),D.ac()),2&t){var o=D.Jc(29),i=D.Jc(56),a=D.Jc(61),n=D.Jc(73);D.Gb(4),D.uc("checked",e.todo.done),D.Gb(2),D.Xc(" ",e.todo.done?"Marcar como no realizado":"Marcar como realizado"," "),D.Gb(2),D.uc("ngIf",!e.todo._id),D.Gb(1),D.uc("ngIf",e.todo.team),D.Gb(1),D.uc("xPosition","before"),D.Gb(2),D.uc("ngForOf",e.agents),D.Gb(1),D.vc("matTooltip",null!=e.todo.usersWhoRead&&e.todo.usersWhoRead.includes(e.identity._id)?"Marcar como no le\xeddo":"Marcar como le\xeddo"),D.Gb(2),D.Wc(null!=e.todo.usersWhoRead&&e.todo.usersWhoRead.includes(e.identity._id)?"drafts":"markunread"),D.Gb(1),D.vc("matTooltip",e.todo.important?"Marcar como no importante":"Marcar como importante"),D.Gb(1),D.uc("ngClass",D.Ac(37,Bt,null==e.todo?null:e.todo.important)),D.Gb(1),D.Wc(e.todo.important?"error":"error_outline"),D.Gb(1),D.vc("matTooltip",e.todo.starred?"Remover de favoritos":"Marcar como favorito"),D.Gb(1),D.uc("ngClass",D.Ac(39,Rt,null==e.todo?null:e.todo.starred)),D.Gb(1),D.Wc(e.todo.starred?"star":"star_outline"),D.Gb(4),D.uc("matMenuTriggerFor",o),D.Gb(3),D.uc("xPosition","before"),D.Gb(2),D.uc("ngForOf",e.tagList),D.Gb(7),D.uc("ngForOf",null==e.todo?null:e.todo.tags),D.Gb(3),D.uc("ngForOf",e.agentsIn),D.Gb(4),D.uc("ngModel",e.todo.title),D.Gb(2),D.uc("ngIf",e.todo.userCreate),D.Gb(1),D.uc("ngIf",!e.todo.userCreate),D.Gb(2),D.uc("ngModel",e.todo.note),D.Gb(1),D.uc("ngIf",e.todo._id&&""!=e.todo._id),D.Gb(3),D.uc("ngModel",e.todo.startDate)("matDatepicker",i),D.Gb(1),D.uc("for",i),D.Gb(4),D.uc("ngModel",e.todo.dueDate)("matDatepicker",a),D.Gb(1),D.uc("for",a),D.Gb(7),D.uc("ngModel",e.teamName),D.Gb(2),D.Wc(e.teamName),D.Gb(1),D.uc("ngForOf",e.teams),D.Gb(3),D.uc("ngModel",e.files),D.Gb(2),D.uc("ngIf",!n.empty),D.Gb(4),D.uc("ngForOf",null==e.todo?null:e.todo.files),D.Gb(6),D.uc("ngIf",e.todo._id)}},directives:[y.a,u.b,C.h,g.a,d.a,z.d,z.b,z.c,L.m,k.d,L.l,T.a,L.k,J.a,k.c,l.b,s.x,s.o,s.p,z.e,m.a,v.b,s.c,s.u,s.n,s.q,v.d,h.b,h.d,m.e,h.a,m.d,ht.a,f.p,x.a,k.a,l.a,l.c],styles:[""],changeDetection:0}),Wt),Yt=[{path:"",component:O,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:ot},{path:"add",component:Nt},{path:"list/:id",component:Nt}]}],zt=((At=function t(){_classCallCheck(this,t)}).\u0275mod=D.Tb({type:At}),At.\u0275inj=D.Sb({factory:function(t){return new(t||At)},imports:[[C.k.forChild(Yt)],C.k]}),At),Jt=o("YUcS");o.d(e,"TodoModule",(function(){return Pt}));var $t,Pt=(($t=function t(){_classCallCheck(this,t)}).\u0275mod=D.Tb({type:$t}),$t.\u0275inj=D.Sb({factory:function(t){return new(t||$t)},providers:[A.a,W.a,R,st.a,Lt],imports:[[L.c,zt,g.b,d.b,s.j,M.e,k.b,u.c,x.b,m.c,b.b,V.d,Jt.a,f.v,y.b,v.c,h.c,f.n,v.c,s.t,T.b,p.f,ht.b,l.d,r.c]]}),$t)}}]);