(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{Poif:function(e,t,a){"use strict";a.r(t);var n=a("ofXK"),o=a("tyNb"),i=a("bSwM"),r=a("QibW"),s=a("qFsG"),c=a("lDzL"),l=a("NFeN"),p=a("bTqV"),u=a("Wp6s"),d=a("f0Cb"),h=a("wZkO"),b=a("MutI"),m=a("YUcS"),f=a("aYsj"),g=a("kmnG"),w=a("d3UM"),k=a("3Pt+"),y=a("1jcm"),v=a("Qu3c"),C=a("PCNd"),S=a("gU78"),M=a("3sEA"),V=a("ebDA"),x=a("0IaG");class I{constructor(e,t,a,n){this._id=e,this.name=t,this.type=a,this.company=n}}var j=a("fXoL"),N=a("dNgK"),B=a("XiUz"),G=a("FKr1");let T=(()=>{class e{constructor(e,t,a){this.data=e,this.dialogRef=t,this.snackBar=a,this.reason=new I("","","Ingreso","")}ngOnInit(){this.build(this.data.payload)}build(e){e&&(this.reason=e)}openSnackBar(e,t){this.snackBar.open(e,t,{duration:1e4})}submit(){if(!this.check())return this.openSnackBar("Faltan campos para completar","Cerrar");this.dialogRef.close({reason:this.reason})}check(){return""!=this.reason.name}}return e.\u0275fac=function(t){return new(t||e)(j.Vb(x.a),j.Vb(x.g),j.Vb(N.a))},e.\u0275cmp=j.Pb({type:e,selectors:[["app-reason-popop"]],decls:23,vars:3,consts:[["matDialogTitle",""],[1,"p-0"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["fxFlex","100",1,"pr-1"],[1,"full-width"],["type","text","placeholder","Nombre","aria-label","Text","matInput","","name","name",3,"ngModel","ngModelChange"],["appearance","fill"],["name","type",3,"ngModel","ngModelChange"],["value","Ingreso"],["value","Egreso"],["value","Transferencia"],["value","Ajuste"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(j.bc(0,"h1",0),j.Vc(1),j.ac(),j.bc(2,"mat-card",1),j.bc(3,"mat-card-content"),j.bc(4,"form"),j.bc(5,"div",2),j.bc(6,"div",3),j.bc(7,"mat-form-field",4),j.bc(8,"input",5),j.jc("ngModelChange",(function(e){return t.reason.name=e})),j.ac(),j.ac(),j.bc(9,"mat-form-field",6),j.bc(10,"mat-label"),j.Vc(11,"Tipo"),j.ac(),j.bc(12,"mat-select",7),j.jc("ngModelChange",(function(e){return t.reason.type=e})),j.bc(13,"mat-option",8),j.Vc(14," Ingreso "),j.ac(),j.bc(15,"mat-option",9),j.Vc(16," Egreso "),j.ac(),j.bc(17,"mat-option",10),j.Vc(18," Transferencia "),j.ac(),j.bc(19,"mat-option",11),j.Vc(20," Ajuste "),j.ac(),j.ac(),j.ac(),j.ac(),j.ac(),j.bc(21,"button",12),j.jc("click",(function(e){return t.submit()})),j.Vc(22,"Guardar"),j.ac(),j.ac(),j.ac(),j.ac()),2&e&&(j.Gb(1),j.Wc(t.data.title),j.Gb(7),j.uc("ngModel",t.reason.name),j.Gb(4),j.uc("ngModel",t.reason.type))},directives:[u.a,u.c,k.x,k.o,k.p,B.d,B.b,g.a,s.b,k.c,k.n,k.q,g.d,w.a,G.p,p.b],encapsulation:2}),e})();function L(e,t){if(1&e){const e=j.cc();j.bc(0,"div",5),j.bc(1,"button",6),j.jc("click",(function(t){return j.Mc(e),j.nc().toNew()})),j.Vc(2,"Nuevo"),j.ac(),j.ac()}}const P=[{path:"",children:[{path:"list",component:(()=>{class e{constructor(e,t,a,n,o){this._userService=e,this._reasonService=t,this.loader=a,this.snackBar=n,this.dialog=o,this.rows=[],this.columns=[],this.temp=[],this.canCreate=!1,this.token=e.getToken(),this.identity=e.getIdentity()}ngOnInit(){this.getColumns(),this.getReasons(),"ROLE_ADMIN"==this.identity.role&&(this.canCreate=!0)}getReasons(){this._reasonService.getList(this.token,{company:this.identity.company._id}).subscribe(e=>{e.reasons&&(this.rows=e.reasons,this.temp=e.reasons)},e=>{this.openSnackBar(e.message,"Cerrar")})}openSnackBar(e,t){this.snackBar.open(e,t,{duration:1e4})}getColumns(){this.columns=[{prop:"name",name:"Nombre",flexGrow:2},{prop:"type",name:"Tipo",flexGrow:1}]}updateFilter(e){const t=e.target.value.toLowerCase();var a=Object.keys(this.temp[0]);if(a.splice(a.length-1),!a.length)return;const n=this.temp.filter((function(e){for(let n=0;n<=a.length;n++){let o=a[n];if(e[o]&&e[o].toString().toLowerCase().indexOf(t)>-1)return!0}}));this.rows=n}toNew(){this.openPopUp(!0)}openPopUp(e,t){this.dialog.open(T,{width:"720px",disableClose:!1,data:{payload:t,title:e?"Nuevo motivo":"Editar motivo"}}).afterClosed().subscribe(t=>{if(t){if(this.loader.open(),e){let e=new I("",t.reason.name,t.reason.type,this.identity.company._id);this._reasonService.add(this.token,e).subscribe(e=>{e.reason&&(this.openSnackBar("Motivo creado","Cerrar"),this.getReasons())},e=>{this.openSnackBar(e.message,"Cerrar")})}else this._reasonService.edit(this.token,t.reason._id,t.reason).subscribe(e=>{e.reason&&(this.openSnackBar("Motivo actualizado","Cerrar"),this.getReasons())},e=>{this.openSnackBar(e.message,"Cerrar")});this.loader.close()}})}toProfile(e,t){"click"==e.type&&this.canCreate&&this.openPopUp(!1,e.row)}}return e.\u0275fac=function(t){return new(t||e)(j.Vb(S.a),j.Vb(V.a),j.Vb(M.a),j.Vb(N.a),j.Vb(x.b))},e.\u0275cmp=j.Pb({type:e,selectors:[["app-reason-list"]],features:[j.Fb([S.a,V.a])],decls:5,vars:8,consts:[[1,"margin-333",2,"width","100%"],["matInput","","placeholder","Filtrar por todas las columnas","value","",3,"keyup"],["class","profile-actions mb-1","style","margin-left: 5px;",4,"ngIf"],[1,"mat-box-shadow","margin-333"],[1,"material","bg-white",3,"columnMode","headerHeight","footerHeight","rowHeight","limit","rows","columns","activate"],[1,"profile-actions","mb-1",2,"margin-left","5px"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(j.bc(0,"mat-form-field",0),j.bc(1,"input",1),j.jc("keyup",(function(e){return t.updateFilter(e)})),j.ac(),j.ac(),j.Tc(2,L,3,0,"div",2),j.bc(3,"div",3),j.bc(4,"ngx-datatable",4),j.jc("activate",(function(e){return t.toProfile(e)})),j.ac(),j.ac()),2&e&&(j.Gb(2),j.uc("ngIf",t.canCreate),j.Gb(2),j.uc("columnMode","flex")("headerHeight",40)("footerHeight",50)("rowHeight",50)("limit",7)("rows",t.rows)("columns",t.columns))},directives:[g.a,s.b,n.m,c.d,p.b],encapsulation:2}),e})(),data:{title:"Lista de razones",breadcrumb:"LISTA DE RAZONES"}}]}];a.d(t,"AppReasonModule",(function(){return _}));let _=(()=>{class e{}return e.\u0275mod=j.Tb({type:e}),e.\u0275inj=j.Sb({factory:function(t){return new(t||e)},imports:[[n.c,k.t,g.c,k.j,d.b,w.b,C.a,b.d,v.b,l.b,p.c,u.e,y.a,i.b,r.c,h.c,s.c,m.a,c.e,f.a,o.k.forChild(P)]]}),e})()}}]);